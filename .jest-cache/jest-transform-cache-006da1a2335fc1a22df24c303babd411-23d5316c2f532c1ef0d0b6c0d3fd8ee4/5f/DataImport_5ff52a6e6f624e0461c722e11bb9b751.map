{"version":3,"sources":["/Users/stefanbekker/projects/fancy-planties/src/components/import/DataImport.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { Upload, FileText, Database, History } from 'lucide-react';\nimport { CSVImportModal } from './CSVImportModal';\nimport { ImportHistory } from './ImportHistory';\n\ninterface DataImportProps {\n  className?: string;\n}\n\nexport function DataImport({ className = '' }: DataImportProps) {\n  const [showImportModal, setShowImportModal] = useState(false);\n  const [activeTab, setActiveTab] = useState<'import' | 'history'>('import');\n\n  const handleImportComplete = (summary: any) => {\n    // Refresh the history when import completes\n    if (activeTab === 'history') {\n      // The ImportHistory component will automatically refresh\n    }\n  };\n\n  const downloadTemplate = (type: 'plant_taxonomy' | 'plant_instances' | 'propagations') => {\n    const templates = {\n      plant_taxonomy: {\n        filename: 'plant_taxonomy_template.csv',\n        headers: ['Family', 'Genus', 'Species', 'Cultivar', 'Common Name'],\n        example: ['Araceae', 'Monstera', 'deliciosa', 'Thai Constellation', 'Monstera Deliciosa']\n      },\n      plant_instances: {\n        filename: 'plant_collection_template.csv',\n        headers: ['Family', 'Genus', 'Species', 'Cultivar', 'Common Name', 'Location', 'Last Fertilized', 'Fertilizer Schedule', 'Fertilizer Due', 'Last Repot'],\n        example: ['Araceae', 'Monstera', 'deliciosa', 'Thai Constellation', 'Monstera Deliciosa', 'Living Room', '2024-01-01', 'every 4 weeks', '2024-01-29', '2023-06-15']\n      },\n      propagations: {\n        filename: 'propagations_template.csv',\n        headers: ['Family', 'Genus', 'Species', 'Cultivar', 'Common Name', 'Location', 'Date Started', 'Source', 'Source Details', 'Parent Plant'],\n        example: ['Araceae', 'Monstera', 'deliciosa', 'Thai Constellation', 'Monstera Deliciosa', 'Propagation Station', '2024-01-15', 'gift', 'Gift from Sarah', '']\n      }\n    };\n\n    const template = templates[type];\n    const csvContent = [\n      template.headers.join(','),\n      template.example.join(',')\n    ].join('\\n');\n\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n    const link = document.createElement('a');\n    const url = URL.createObjectURL(blob);\n    link.setAttribute('href', url);\n    link.setAttribute('download', template.filename);\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  return (\n    <div className={`space-y-6 ${className}`}>\n      {/* Header */}\n      <div>\n        <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">\n          Data Import\n        </h2>\n        <p className=\"text-gray-600\">\n          Import your plant data from CSV files to quickly populate your collection.\n        </p>\n      </div>\n\n      {/* Tab Navigation */}\n      <div className=\"border-b border-gray-200\">\n        <nav className=\"-mb-px flex space-x-8\">\n          <button\n            onClick={() => setActiveTab('import')}\n            className={`\n              py-2 px-1 border-b-2 font-medium text-sm transition-colors\n              ${activeTab === 'import'\n                ? 'border-primary-500 text-primary-600'\n                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n              }\n            `}\n          >\n            <Upload className=\"w-4 h-4 inline mr-2\" />\n            Import Data\n          </button>\n          <button\n            onClick={() => setActiveTab('history')}\n            className={`\n              py-2 px-1 border-b-2 font-medium text-sm transition-colors\n              ${activeTab === 'history'\n                ? 'border-primary-500 text-primary-600'\n                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n              }\n            `}\n          >\n            <History className=\"w-4 h-4 inline mr-2\" />\n            Import History\n          </button>\n        </nav>\n      </div>\n\n      {/* Tab Content */}\n      {activeTab === 'import' && (\n        <div className=\"space-y-6\">\n          {/* Quick Start Section */}\n          <div className=\"bg-primary-50 border border-primary-200 rounded-lg p-6\">\n            <div className=\"flex items-start space-x-4\">\n              <div className=\"p-3 bg-primary-200 rounded-lg\">\n                <Database className=\"w-6 h-6 text-primary-600\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"font-semibold text-primary-900 mb-2\">\n                  Quick Start Guide\n                </h3>\n                <p className=\"text-primary-700 mb-4\">\n                  Import your existing plant data to get started quickly. We support three types of CSV imports:\n                </p>\n                <ul className=\"space-y-2 text-sm text-primary-700\">\n                  <li className=\"flex items-center\">\n                    <span className=\"w-2 h-2 bg-primary-400 rounded-full mr-3\"></span>\n                    <strong>Plant Taxonomy:</strong> Species information with separate cultivar field support\n                  </li>\n                  <li className=\"flex items-center\">\n                    <span className=\"w-2 h-2 bg-primary-400 rounded-full mr-3\"></span>\n                    <strong>Plant Collection:</strong> Your plant instances with enhanced taxonomy and care schedules\n                  </li>\n                  <li className=\"flex items-center\">\n                    <span className=\"w-2 h-2 bg-primary-400 rounded-full mr-3\"></span>\n                    <strong>Propagations:</strong> Propagation records with external source tracking (gifts, trades, purchases)\n                  </li>\n                </ul>\n              </div>\n            </div>\n          </div>\n\n          {/* Import Actions */}\n          <div className=\"grid gap-4 md:grid-cols-2\">\n            <div className=\"border border-gray-200 rounded-lg p-6 hover:shadow-sm transition-shadow\">\n              <div className=\"flex items-center space-x-3 mb-4\">\n                <div className=\"p-2 bg-blue-100 rounded-lg\">\n                  <FileText className=\"w-5 h-5 text-blue-600\" />\n                </div>\n                <h3 className=\"font-semibold text-gray-900\">\n                  Import from CSV\n                </h3>\n              </div>\n              <p className=\"text-gray-600 mb-4\">\n                Upload a CSV file with your plant data. We'll guide you through the process and validate your data.\n              </p>\n              <button\n                onClick={() => setShowImportModal(true)}\n                className=\"btn btn--primary btn--full\"\n              >\n                Start CSV Import\n              </button>\n            </div>\n\n            <div className=\"border border-gray-200 rounded-lg p-6 hover:shadow-sm transition-shadow\">\n              <div className=\"flex items-center space-x-3 mb-4\">\n                <div className=\"p-2 bg-green-100 rounded-lg\">\n                  <FileText className=\"w-5 h-5 text-green-600\" />\n                </div>\n                <h3 className=\"font-semibold text-gray-900\">\n                  Download Templates\n                </h3>\n              </div>\n              <p className=\"text-gray-600 mb-4\">\n                Download CSV templates with the correct column headers and example data to get started quickly.\n              </p>\n              <div className=\"space-y-2\">\n                <button\n                  onClick={() => downloadTemplate('plant_taxonomy')}\n                  className=\"btn btn--sm btn--outline btn--full\"\n                >\n                  Plant Taxonomy Template\n                </button>\n                <button\n                  onClick={() => downloadTemplate('plant_instances')}\n                  className=\"btn btn--sm btn--outline btn--full\"\n                >\n                  Plant Collection Template\n                </button>\n                <button\n                  onClick={() => downloadTemplate('propagations')}\n                  className=\"btn btn--sm btn--outline btn--full\"\n                >\n                  Propagations Template\n                </button>\n              </div>\n            </div>\n          </div>\n\n          {/* CSV Format Help */}\n          <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-6\">\n            <h3 className=\"font-semibold text-gray-900 mb-4\">\n              CSV Format Requirements\n            </h3>\n            <div className=\"grid gap-6 md:grid-cols-3\">\n              <div>\n                <h4 className=\"font-medium text-gray-900 mb-2\">Plant Taxonomy</h4>\n                <div className=\"text-sm text-gray-600 space-y-1\">\n                  <p><strong>Required columns:</strong></p>\n                  <ul className=\"list-disc list-inside space-y-1 text-xs\">\n                    <li>Family</li>\n                    <li>Genus</li>\n                    <li>Species</li>\n                    <li>Common Name</li>\n                  </ul>\n                  <p><strong>Optional:</strong> Cultivar</p>\n                  <p className=\"text-xs italic\">Legacy \"Common Name/Variety\" column still supported</p>\n                </div>\n              </div>\n              \n              <div>\n                <h4 className=\"font-medium text-gray-900 mb-2\">Plant Collection</h4>\n                <div className=\"text-sm text-gray-600 space-y-1\">\n                  <p><strong>Required columns:</strong></p>\n                  <ul className=\"list-disc list-inside space-y-1 text-xs\">\n                    <li>Common Name</li>\n                    <li>Location</li>\n                    <li>Fertilizer Schedule</li>\n                  </ul>\n                  <p><strong>Optional:</strong> Cultivar, Last Fertilized, Last Repot</p>\n                  <p className=\"text-xs italic\">Legacy \"Common Name/Variety\" column still supported</p>\n                </div>\n              </div>\n              \n              <div>\n                <h4 className=\"font-medium text-gray-900 mb-2\">Propagations</h4>\n                <div className=\"text-sm text-gray-600 space-y-1\">\n                  <p><strong>Required columns:</strong></p>\n                  <ul className=\"list-disc list-inside space-y-1 text-xs\">\n                    <li>Common Name</li>\n                    <li>Location</li>\n                    <li>Date Started</li>\n                  </ul>\n                  <p><strong>Optional:</strong> Cultivar, Source, Source Details, Parent Plant</p>\n                  <p className=\"text-xs italic\">Source auto-detects external propagations (gifts, trades, purchases)</p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {activeTab === 'history' && (\n        <ImportHistory />\n      )}\n\n      {/* CSV Import Modal */}\n      <CSVImportModal\n        isOpen={showImportModal}\n        onClose={() => setShowImportModal(false)}\n        onImportComplete={handleImportComplete}\n      />\n    </div>\n  );\n}\n\nexport default DataImport;"],"names":["DataImport","className","showImportModal","setShowImportModal","useState","activeTab","setActiveTab","handleImportComplete","summary","downloadTemplate","type","templates","plant_taxonomy","filename","headers","example","plant_instances","propagations","template","csvContent","join","blob","Blob","link","document","createElement","url","URL","createObjectURL","setAttribute","style","visibility","body","appendChild","click","removeChild","div","h2","p","nav","button","onClick","Upload","History","Database","h3","ul","li","span","strong","FileText","h4","ImportHistory","CSVImportModal","isOpen","onClose","onImportComplete"],"mappings":"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"}