73709a544c736d433cd05a326ab26bd9
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get EmailServiceMonitor () {
        return EmailServiceMonitor;
    },
    get emailServiceMonitor () {
        return emailServiceMonitor;
    }
});
require("server-only");
class EmailServiceMonitor {
    constructor(){
        this.recentEvents = [];
        this.maxEvents = 1000; // Keep last 1000 events
        this.resetInterval = 24 * 60 * 60 * 1000; // 24 hours
        const quotaLimit = this.getQuotaLimit();
        this.stats = {
            totalSent: 0,
            totalFailed: 0,
            quotaUsed: 0,
            quotaLimit,
            errorsByType: {},
            successRate: 100,
            averageResponseTime: 0,
            lastResetTime: Date.now()
        };
    }
    /**
   * Record a successful email send
   */ recordSuccess(responseTime) {
        this.stats.totalSent++;
        if (this.stats.quotaLimit > 0) {
            this.stats.quotaUsed++;
        }
        const event = {
            type: 'success',
            timestamp: Date.now(),
            responseTime
        };
        this.addEvent(event);
        this.updateStats();
        // Log success in development
        if (process.env.NODE_ENV === 'development') {
            console.log(`[EMAIL_MONITOR] Email sent successfully (${responseTime}ms)`);
        }
    }
    /**
   * Record a failed email send
   */ recordFailure(error, responseTime) {
        this.stats.totalFailed++;
        // Update error counts by type
        this.stats.errorsByType[error.code] = (this.stats.errorsByType[error.code] || 0) + 1;
        // Update last error
        this.stats.lastError = {
            message: error.message,
            code: error.code,
            timestamp: Date.now()
        };
        const event = {
            type: 'error',
            timestamp: Date.now(),
            responseTime,
            error
        };
        this.addEvent(event);
        this.updateStats();
        // Log error
        console.error(`[EMAIL_MONITOR] Email send failed: ${error.code} - ${error.message} (${responseTime}ms)`);
        // Check for quota issues
        if (error.code === 'QUOTA_EXCEEDED') {
            this.handleQuotaExceeded();
        }
    }
    /**
   * Get current statistics
   */ getStats() {
        this.checkForReset();
        return {
            ...this.stats
        };
    }
    /**
   * Get recent events (last N events)
   */ getRecentEvents(limit = 100) {
        return this.recentEvents.slice(-limit);
    }
    /**
   * Get error summary
   */ getErrorSummary() {
        const recentErrors = this.recentEvents.filter((event)=>event.type === 'error').slice(-50);
        const criticalErrors = this.recentEvents.filter((event)=>event.type === 'error' && event.error?.code === 'QUOTA_EXCEEDED').slice(-10);
        return {
            totalErrors: this.stats.totalFailed,
            errorsByType: {
                ...this.stats.errorsByType
            },
            recentErrors,
            criticalErrors
        };
    }
    /**
   * Check if quota is approaching limit
   */ isQuotaNearLimit(threshold = 0.8) {
        if (this.stats.quotaLimit === 0) return false;
        return this.stats.quotaUsed / this.stats.quotaLimit >= threshold;
    }
    /**
   * Get quota usage percentage
   */ getQuotaUsagePercentage() {
        if (this.stats.quotaLimit === 0) return 0;
        return Math.round(this.stats.quotaUsed / this.stats.quotaLimit * 100);
    }
    /**
   * Reset daily statistics (called automatically)
   */ resetDailyStats() {
        console.log('[EMAIL_MONITOR] Resetting daily statistics');
        this.stats.totalSent = 0;
        this.stats.totalFailed = 0;
        this.stats.quotaUsed = 0;
        this.stats.errorsByType = {};
        this.stats.lastResetTime = Date.now();
        // Keep only recent events (last 100)
        this.recentEvents = this.recentEvents.slice(-100);
        this.updateStats();
    }
    /**
   * Force reset statistics (for testing or manual reset)
   */ forceReset() {
        console.log('[EMAIL_MONITOR] Force resetting statistics');
        this.resetDailyStats();
    }
    /**
   * Get health status
   */ getHealthStatus() {
        const issues = [];
        const recommendations = [];
        let status = 'healthy';
        // Check success rate
        if (this.stats.successRate < 95) {
            status = 'warning';
            issues.push(`Low success rate: ${this.stats.successRate.toFixed(1)}%`);
            recommendations.push('Check email service configuration and network connectivity');
        }
        if (this.stats.successRate < 80) {
            status = 'critical';
        }
        // Check quota usage
        if (this.isQuotaNearLimit(0.9)) {
            status = status === 'critical' ? 'critical' : 'warning';
            issues.push(`High quota usage: ${this.getQuotaUsagePercentage()}%`);
            recommendations.push('Consider upgrading email service plan or implementing email throttling');
        }
        if (this.isQuotaNearLimit(0.95)) {
            status = 'critical';
        }
        // Check for recent critical errors
        const recentCriticalErrors = this.recentEvents.filter((event)=>event.type === 'error' && event.error?.code === 'QUOTA_EXCEEDED' && Date.now() - event.timestamp < 60 * 60 * 1000 // Last hour
        );
        if (recentCriticalErrors.length > 0) {
            status = 'critical';
            issues.push('Quota exceeded errors in the last hour');
            recommendations.push('Immediate attention required - email service quota exceeded');
        }
        // Check average response time
        if (this.stats.averageResponseTime > 5000) {
            status = status === 'critical' ? 'critical' : 'warning';
            issues.push(`High response time: ${this.stats.averageResponseTime}ms`);
            recommendations.push('Check email service performance and network latency');
        }
        return {
            status,
            issues,
            recommendations
        };
    }
    addEvent(event) {
        this.recentEvents.push(event);
        // Keep only the most recent events
        if (this.recentEvents.length > this.maxEvents) {
            this.recentEvents = this.recentEvents.slice(-this.maxEvents);
        }
    }
    updateStats() {
        const total = this.stats.totalSent + this.stats.totalFailed;
        this.stats.successRate = total > 0 ? this.stats.totalSent / total * 100 : 100;
        // Calculate average response time from recent events
        const recentEvents = this.recentEvents.slice(-100);
        if (recentEvents.length > 0) {
            const totalTime = recentEvents.reduce((sum, event)=>sum + event.responseTime, 0);
            this.stats.averageResponseTime = Math.round(totalTime / recentEvents.length);
        }
    }
    checkForReset() {
        const now = Date.now();
        if (now - this.stats.lastResetTime >= this.resetInterval) {
            this.resetDailyStats();
        }
    }
    getQuotaLimit() {
        // Default Resend free tier limits
        // This could be made configurable via environment variables
        const dailyLimit = parseInt(process.env.EMAIL_DAILY_QUOTA || '100', 10);
        return dailyLimit;
    }
    handleQuotaExceeded() {
        console.error('[EMAIL_MONITOR] CRITICAL: Email quota exceeded!');
        // In a production system, you might want to:
        // - Send alerts to administrators
        // - Temporarily disable email sending
        // - Switch to a backup email service
        // - Log to external monitoring system
        if (process.env.NODE_ENV === 'production') {
            // Log critical error for external monitoring
            console.error('[EMAIL_MONITOR] ALERT: Email service quota exceeded - immediate attention required');
        }
    }
}
const emailServiceMonitor = new EmailServiceMonitor();
// Schedule daily reset (but not during tests)
if (process.env.NODE_ENV === 'production') {
    // Reset at midnight UTC
    const now = new Date();
    const tomorrow = new Date(now);
    tomorrow.setUTCDate(tomorrow.getUTCDate() + 1);
    tomorrow.setUTCHours(0, 0, 0, 0);
    const msUntilMidnight = tomorrow.getTime() - now.getTime();
    setTimeout(()=>{
        emailServiceMonitor.resetDailyStats();
        // Then reset every 24 hours
        setInterval(()=>{
            emailServiceMonitor.resetDailyStats();
        }, 24 * 60 * 60 * 1000);
    }, msUntilMidnight);
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdGVmYW5iZWtrZXIvcHJvamVjdHMvZmFuY3ktcGxhbnRpZXMvc3JjL2xpYi9zZXJ2aWNlcy9lbWFpbC1zZXJ2aWNlLW1vbml0b3IudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICdzZXJ2ZXItb25seSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1haWxTZXJ2aWNlU3RhdHMge1xuICB0b3RhbFNlbnQ6IG51bWJlcjtcbiAgdG90YWxGYWlsZWQ6IG51bWJlcjtcbiAgcXVvdGFVc2VkOiBudW1iZXI7XG4gIHF1b3RhTGltaXQ6IG51bWJlcjtcbiAgbGFzdEVycm9yPzoge1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICBjb2RlOiBzdHJpbmc7XG4gICAgdGltZXN0YW1wOiBudW1iZXI7XG4gIH07XG4gIGVycm9yc0J5VHlwZTogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgc3VjY2Vzc1JhdGU6IG51bWJlcjtcbiAgYXZlcmFnZVJlc3BvbnNlVGltZTogbnVtYmVyO1xuICBsYXN0UmVzZXRUaW1lOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1haWxTZXJ2aWNlRXZlbnQge1xuICB0eXBlOiAnc3VjY2VzcycgfCAnZXJyb3InO1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbiAgcmVzcG9uc2VUaW1lOiBudW1iZXI7XG4gIGVycm9yPzoge1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICBjb2RlOiBzdHJpbmc7XG4gIH07XG59XG5cbmV4cG9ydCBjbGFzcyBFbWFpbFNlcnZpY2VNb25pdG9yIHtcbiAgcHJpdmF0ZSBzdGF0czogRW1haWxTZXJ2aWNlU3RhdHM7XG4gIHByaXZhdGUgcmVjZW50RXZlbnRzOiBFbWFpbFNlcnZpY2VFdmVudFtdID0gW107XG4gIHByaXZhdGUgcmVhZG9ubHkgbWF4RXZlbnRzID0gMTAwMDsgLy8gS2VlcCBsYXN0IDEwMDAgZXZlbnRzXG4gIHByaXZhdGUgcmVhZG9ubHkgcmVzZXRJbnRlcnZhbCA9IDI0ICogNjAgKiA2MCAqIDEwMDA7IC8vIDI0IGhvdXJzXG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgY29uc3QgcXVvdGFMaW1pdCA9IHRoaXMuZ2V0UXVvdGFMaW1pdCgpO1xuICAgIHRoaXMuc3RhdHMgPSB7XG4gICAgICB0b3RhbFNlbnQ6IDAsXG4gICAgICB0b3RhbEZhaWxlZDogMCxcbiAgICAgIHF1b3RhVXNlZDogMCxcbiAgICAgIHF1b3RhTGltaXQsXG4gICAgICBlcnJvcnNCeVR5cGU6IHt9LFxuICAgICAgc3VjY2Vzc1JhdGU6IDEwMCxcbiAgICAgIGF2ZXJhZ2VSZXNwb25zZVRpbWU6IDAsXG4gICAgICBsYXN0UmVzZXRUaW1lOiBEYXRlLm5vdygpLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUmVjb3JkIGEgc3VjY2Vzc2Z1bCBlbWFpbCBzZW5kXG4gICAqL1xuICByZWNvcmRTdWNjZXNzKHJlc3BvbnNlVGltZTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5zdGF0cy50b3RhbFNlbnQrKztcbiAgICBpZiAodGhpcy5zdGF0cy5xdW90YUxpbWl0ID4gMCkge1xuICAgICAgdGhpcy5zdGF0cy5xdW90YVVzZWQrKztcbiAgICB9XG4gICAgXG4gICAgY29uc3QgZXZlbnQ6IEVtYWlsU2VydmljZUV2ZW50ID0ge1xuICAgICAgdHlwZTogJ3N1Y2Nlc3MnLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgcmVzcG9uc2VUaW1lLFxuICAgIH07XG4gICAgXG4gICAgdGhpcy5hZGRFdmVudChldmVudCk7XG4gICAgdGhpcy51cGRhdGVTdGF0cygpO1xuICAgIFxuICAgIC8vIExvZyBzdWNjZXNzIGluIGRldmVsb3BtZW50XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnKSB7XG4gICAgICBjb25zb2xlLmxvZyhgW0VNQUlMX01PTklUT1JdIEVtYWlsIHNlbnQgc3VjY2Vzc2Z1bGx5ICgke3Jlc3BvbnNlVGltZX1tcylgKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVjb3JkIGEgZmFpbGVkIGVtYWlsIHNlbmRcbiAgICovXG4gIHJlY29yZEZhaWx1cmUoZXJyb3I6IHsgbWVzc2FnZTogc3RyaW5nOyBjb2RlOiBzdHJpbmcgfSwgcmVzcG9uc2VUaW1lOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnN0YXRzLnRvdGFsRmFpbGVkKys7XG4gICAgXG4gICAgLy8gVXBkYXRlIGVycm9yIGNvdW50cyBieSB0eXBlXG4gICAgdGhpcy5zdGF0cy5lcnJvcnNCeVR5cGVbZXJyb3IuY29kZV0gPSAodGhpcy5zdGF0cy5lcnJvcnNCeVR5cGVbZXJyb3IuY29kZV0gfHwgMCkgKyAxO1xuICAgIFxuICAgIC8vIFVwZGF0ZSBsYXN0IGVycm9yXG4gICAgdGhpcy5zdGF0cy5sYXN0RXJyb3IgPSB7XG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgY29kZTogZXJyb3IuY29kZSxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICB9O1xuICAgIFxuICAgIGNvbnN0IGV2ZW50OiBFbWFpbFNlcnZpY2VFdmVudCA9IHtcbiAgICAgIHR5cGU6ICdlcnJvcicsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICByZXNwb25zZVRpbWUsXG4gICAgICBlcnJvcixcbiAgICB9O1xuICAgIFxuICAgIHRoaXMuYWRkRXZlbnQoZXZlbnQpO1xuICAgIHRoaXMudXBkYXRlU3RhdHMoKTtcbiAgICBcbiAgICAvLyBMb2cgZXJyb3JcbiAgICBjb25zb2xlLmVycm9yKGBbRU1BSUxfTU9OSVRPUl0gRW1haWwgc2VuZCBmYWlsZWQ6ICR7ZXJyb3IuY29kZX0gLSAke2Vycm9yLm1lc3NhZ2V9ICgke3Jlc3BvbnNlVGltZX1tcylgKTtcbiAgICBcbiAgICAvLyBDaGVjayBmb3IgcXVvdGEgaXNzdWVzXG4gICAgaWYgKGVycm9yLmNvZGUgPT09ICdRVU9UQV9FWENFRURFRCcpIHtcbiAgICAgIHRoaXMuaGFuZGxlUXVvdGFFeGNlZWRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY3VycmVudCBzdGF0aXN0aWNzXG4gICAqL1xuICBnZXRTdGF0cygpOiBFbWFpbFNlcnZpY2VTdGF0cyB7XG4gICAgdGhpcy5jaGVja0ZvclJlc2V0KCk7XG4gICAgcmV0dXJuIHsgLi4udGhpcy5zdGF0cyB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCByZWNlbnQgZXZlbnRzIChsYXN0IE4gZXZlbnRzKVxuICAgKi9cbiAgZ2V0UmVjZW50RXZlbnRzKGxpbWl0OiBudW1iZXIgPSAxMDApOiBFbWFpbFNlcnZpY2VFdmVudFtdIHtcbiAgICByZXR1cm4gdGhpcy5yZWNlbnRFdmVudHMuc2xpY2UoLWxpbWl0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZXJyb3Igc3VtbWFyeVxuICAgKi9cbiAgZ2V0RXJyb3JTdW1tYXJ5KCk6IHtcbiAgICB0b3RhbEVycm9yczogbnVtYmVyO1xuICAgIGVycm9yc0J5VHlwZTogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgICByZWNlbnRFcnJvcnM6IEVtYWlsU2VydmljZUV2ZW50W107XG4gICAgY3JpdGljYWxFcnJvcnM6IEVtYWlsU2VydmljZUV2ZW50W107XG4gIH0ge1xuICAgIGNvbnN0IHJlY2VudEVycm9ycyA9IHRoaXMucmVjZW50RXZlbnRzXG4gICAgICAuZmlsdGVyKGV2ZW50ID0+IGV2ZW50LnR5cGUgPT09ICdlcnJvcicpXG4gICAgICAuc2xpY2UoLTUwKTtcbiAgICBcbiAgICBjb25zdCBjcml0aWNhbEVycm9ycyA9IHRoaXMucmVjZW50RXZlbnRzXG4gICAgICAuZmlsdGVyKGV2ZW50ID0+IFxuICAgICAgICBldmVudC50eXBlID09PSAnZXJyb3InICYmIFxuICAgICAgICBldmVudC5lcnJvcj8uY29kZSA9PT0gJ1FVT1RBX0VYQ0VFREVEJ1xuICAgICAgKVxuICAgICAgLnNsaWNlKC0xMCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxFcnJvcnM6IHRoaXMuc3RhdHMudG90YWxGYWlsZWQsXG4gICAgICBlcnJvcnNCeVR5cGU6IHsgLi4udGhpcy5zdGF0cy5lcnJvcnNCeVR5cGUgfSxcbiAgICAgIHJlY2VudEVycm9ycyxcbiAgICAgIGNyaXRpY2FsRXJyb3JzLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgcXVvdGEgaXMgYXBwcm9hY2hpbmcgbGltaXRcbiAgICovXG4gIGlzUXVvdGFOZWFyTGltaXQodGhyZXNob2xkOiBudW1iZXIgPSAwLjgpOiBib29sZWFuIHtcbiAgICBpZiAodGhpcy5zdGF0cy5xdW90YUxpbWl0ID09PSAwKSByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuICh0aGlzLnN0YXRzLnF1b3RhVXNlZCAvIHRoaXMuc3RhdHMucXVvdGFMaW1pdCkgPj0gdGhyZXNob2xkO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBxdW90YSB1c2FnZSBwZXJjZW50YWdlXG4gICAqL1xuICBnZXRRdW90YVVzYWdlUGVyY2VudGFnZSgpOiBudW1iZXIge1xuICAgIGlmICh0aGlzLnN0YXRzLnF1b3RhTGltaXQgPT09IDApIHJldHVybiAwO1xuICAgIHJldHVybiBNYXRoLnJvdW5kKCh0aGlzLnN0YXRzLnF1b3RhVXNlZCAvIHRoaXMuc3RhdHMucXVvdGFMaW1pdCkgKiAxMDApO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc2V0IGRhaWx5IHN0YXRpc3RpY3MgKGNhbGxlZCBhdXRvbWF0aWNhbGx5KVxuICAgKi9cbiAgcmVzZXREYWlseVN0YXRzKCk6IHZvaWQge1xuICAgIGNvbnNvbGUubG9nKCdbRU1BSUxfTU9OSVRPUl0gUmVzZXR0aW5nIGRhaWx5IHN0YXRpc3RpY3MnKTtcbiAgICBcbiAgICB0aGlzLnN0YXRzLnRvdGFsU2VudCA9IDA7XG4gICAgdGhpcy5zdGF0cy50b3RhbEZhaWxlZCA9IDA7XG4gICAgdGhpcy5zdGF0cy5xdW90YVVzZWQgPSAwO1xuICAgIHRoaXMuc3RhdHMuZXJyb3JzQnlUeXBlID0ge307XG4gICAgdGhpcy5zdGF0cy5sYXN0UmVzZXRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICBcbiAgICAvLyBLZWVwIG9ubHkgcmVjZW50IGV2ZW50cyAobGFzdCAxMDApXG4gICAgdGhpcy5yZWNlbnRFdmVudHMgPSB0aGlzLnJlY2VudEV2ZW50cy5zbGljZSgtMTAwKTtcbiAgICBcbiAgICB0aGlzLnVwZGF0ZVN0YXRzKCk7XG4gIH1cblxuICAvKipcbiAgICogRm9yY2UgcmVzZXQgc3RhdGlzdGljcyAoZm9yIHRlc3Rpbmcgb3IgbWFudWFsIHJlc2V0KVxuICAgKi9cbiAgZm9yY2VSZXNldCgpOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZygnW0VNQUlMX01PTklUT1JdIEZvcmNlIHJlc2V0dGluZyBzdGF0aXN0aWNzJyk7XG4gICAgdGhpcy5yZXNldERhaWx5U3RhdHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgaGVhbHRoIHN0YXR1c1xuICAgKi9cbiAgZ2V0SGVhbHRoU3RhdHVzKCk6IHtcbiAgICBzdGF0dXM6ICdoZWFsdGh5JyB8ICd3YXJuaW5nJyB8ICdjcml0aWNhbCc7XG4gICAgaXNzdWVzOiBzdHJpbmdbXTtcbiAgICByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdO1xuICB9IHtcbiAgICBjb25zdCBpc3N1ZXM6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgIGxldCBzdGF0dXM6ICdoZWFsdGh5JyB8ICd3YXJuaW5nJyB8ICdjcml0aWNhbCcgPSAnaGVhbHRoeSc7XG5cbiAgICAvLyBDaGVjayBzdWNjZXNzIHJhdGVcbiAgICBpZiAodGhpcy5zdGF0cy5zdWNjZXNzUmF0ZSA8IDk1KSB7XG4gICAgICBzdGF0dXMgPSAnd2FybmluZyc7XG4gICAgICBpc3N1ZXMucHVzaChgTG93IHN1Y2Nlc3MgcmF0ZTogJHt0aGlzLnN0YXRzLnN1Y2Nlc3NSYXRlLnRvRml4ZWQoMSl9JWApO1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0NoZWNrIGVtYWlsIHNlcnZpY2UgY29uZmlndXJhdGlvbiBhbmQgbmV0d29yayBjb25uZWN0aXZpdHknKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zdGF0cy5zdWNjZXNzUmF0ZSA8IDgwKSB7XG4gICAgICBzdGF0dXMgPSAnY3JpdGljYWwnO1xuICAgIH1cblxuICAgIC8vIENoZWNrIHF1b3RhIHVzYWdlXG4gICAgaWYgKHRoaXMuaXNRdW90YU5lYXJMaW1pdCgwLjkpKSB7XG4gICAgICBzdGF0dXMgPSBzdGF0dXMgPT09ICdjcml0aWNhbCcgPyAnY3JpdGljYWwnIDogJ3dhcm5pbmcnO1xuICAgICAgaXNzdWVzLnB1c2goYEhpZ2ggcXVvdGEgdXNhZ2U6ICR7dGhpcy5nZXRRdW90YVVzYWdlUGVyY2VudGFnZSgpfSVgKTtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdDb25zaWRlciB1cGdyYWRpbmcgZW1haWwgc2VydmljZSBwbGFuIG9yIGltcGxlbWVudGluZyBlbWFpbCB0aHJvdHRsaW5nJyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNRdW90YU5lYXJMaW1pdCgwLjk1KSkge1xuICAgICAgc3RhdHVzID0gJ2NyaXRpY2FsJztcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3IgcmVjZW50IGNyaXRpY2FsIGVycm9yc1xuICAgIGNvbnN0IHJlY2VudENyaXRpY2FsRXJyb3JzID0gdGhpcy5yZWNlbnRFdmVudHNcbiAgICAgIC5maWx0ZXIoZXZlbnQgPT4gXG4gICAgICAgIGV2ZW50LnR5cGUgPT09ICdlcnJvcicgJiYgXG4gICAgICAgIGV2ZW50LmVycm9yPy5jb2RlID09PSAnUVVPVEFfRVhDRUVERUQnICYmXG4gICAgICAgIERhdGUubm93KCkgLSBldmVudC50aW1lc3RhbXAgPCA2MCAqIDYwICogMTAwMCAvLyBMYXN0IGhvdXJcbiAgICAgICk7XG5cbiAgICBpZiAocmVjZW50Q3JpdGljYWxFcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgc3RhdHVzID0gJ2NyaXRpY2FsJztcbiAgICAgIGlzc3Vlcy5wdXNoKCdRdW90YSBleGNlZWRlZCBlcnJvcnMgaW4gdGhlIGxhc3QgaG91cicpO1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0ltbWVkaWF0ZSBhdHRlbnRpb24gcmVxdWlyZWQgLSBlbWFpbCBzZXJ2aWNlIHF1b3RhIGV4Y2VlZGVkJyk7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgYXZlcmFnZSByZXNwb25zZSB0aW1lXG4gICAgaWYgKHRoaXMuc3RhdHMuYXZlcmFnZVJlc3BvbnNlVGltZSA+IDUwMDApIHtcbiAgICAgIHN0YXR1cyA9IHN0YXR1cyA9PT0gJ2NyaXRpY2FsJyA/ICdjcml0aWNhbCcgOiAnd2FybmluZyc7XG4gICAgICBpc3N1ZXMucHVzaChgSGlnaCByZXNwb25zZSB0aW1lOiAke3RoaXMuc3RhdHMuYXZlcmFnZVJlc3BvbnNlVGltZX1tc2ApO1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0NoZWNrIGVtYWlsIHNlcnZpY2UgcGVyZm9ybWFuY2UgYW5kIG5ldHdvcmsgbGF0ZW5jeScpO1xuICAgIH1cblxuICAgIHJldHVybiB7IHN0YXR1cywgaXNzdWVzLCByZWNvbW1lbmRhdGlvbnMgfTtcbiAgfVxuXG4gIHByaXZhdGUgYWRkRXZlbnQoZXZlbnQ6IEVtYWlsU2VydmljZUV2ZW50KTogdm9pZCB7XG4gICAgdGhpcy5yZWNlbnRFdmVudHMucHVzaChldmVudCk7XG4gICAgXG4gICAgLy8gS2VlcCBvbmx5IHRoZSBtb3N0IHJlY2VudCBldmVudHNcbiAgICBpZiAodGhpcy5yZWNlbnRFdmVudHMubGVuZ3RoID4gdGhpcy5tYXhFdmVudHMpIHtcbiAgICAgIHRoaXMucmVjZW50RXZlbnRzID0gdGhpcy5yZWNlbnRFdmVudHMuc2xpY2UoLXRoaXMubWF4RXZlbnRzKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZVN0YXRzKCk6IHZvaWQge1xuICAgIGNvbnN0IHRvdGFsID0gdGhpcy5zdGF0cy50b3RhbFNlbnQgKyB0aGlzLnN0YXRzLnRvdGFsRmFpbGVkO1xuICAgIHRoaXMuc3RhdHMuc3VjY2Vzc1JhdGUgPSB0b3RhbCA+IDAgPyAodGhpcy5zdGF0cy50b3RhbFNlbnQgLyB0b3RhbCkgKiAxMDAgOiAxMDA7XG4gICAgXG4gICAgLy8gQ2FsY3VsYXRlIGF2ZXJhZ2UgcmVzcG9uc2UgdGltZSBmcm9tIHJlY2VudCBldmVudHNcbiAgICBjb25zdCByZWNlbnRFdmVudHMgPSB0aGlzLnJlY2VudEV2ZW50cy5zbGljZSgtMTAwKTtcbiAgICBpZiAocmVjZW50RXZlbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IHRvdGFsVGltZSA9IHJlY2VudEV2ZW50cy5yZWR1Y2UoKHN1bSwgZXZlbnQpID0+IHN1bSArIGV2ZW50LnJlc3BvbnNlVGltZSwgMCk7XG4gICAgICB0aGlzLnN0YXRzLmF2ZXJhZ2VSZXNwb25zZVRpbWUgPSBNYXRoLnJvdW5kKHRvdGFsVGltZSAvIHJlY2VudEV2ZW50cy5sZW5ndGgpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY2hlY2tGb3JSZXNldCgpOiB2b2lkIHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGlmIChub3cgLSB0aGlzLnN0YXRzLmxhc3RSZXNldFRpbWUgPj0gdGhpcy5yZXNldEludGVydmFsKSB7XG4gICAgICB0aGlzLnJlc2V0RGFpbHlTdGF0cygpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0UXVvdGFMaW1pdCgpOiBudW1iZXIge1xuICAgIC8vIERlZmF1bHQgUmVzZW5kIGZyZWUgdGllciBsaW1pdHNcbiAgICAvLyBUaGlzIGNvdWxkIGJlIG1hZGUgY29uZmlndXJhYmxlIHZpYSBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbiAgICBjb25zdCBkYWlseUxpbWl0ID0gcGFyc2VJbnQocHJvY2Vzcy5lbnYuRU1BSUxfREFJTFlfUVVPVEEgfHwgJzEwMCcsIDEwKTtcbiAgICByZXR1cm4gZGFpbHlMaW1pdDtcbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlUXVvdGFFeGNlZWRlZCgpOiB2b2lkIHtcbiAgICBjb25zb2xlLmVycm9yKCdbRU1BSUxfTU9OSVRPUl0gQ1JJVElDQUw6IEVtYWlsIHF1b3RhIGV4Y2VlZGVkIScpO1xuICAgIFxuICAgIC8vIEluIGEgcHJvZHVjdGlvbiBzeXN0ZW0sIHlvdSBtaWdodCB3YW50IHRvOlxuICAgIC8vIC0gU2VuZCBhbGVydHMgdG8gYWRtaW5pc3RyYXRvcnNcbiAgICAvLyAtIFRlbXBvcmFyaWx5IGRpc2FibGUgZW1haWwgc2VuZGluZ1xuICAgIC8vIC0gU3dpdGNoIHRvIGEgYmFja3VwIGVtYWlsIHNlcnZpY2VcbiAgICAvLyAtIExvZyB0byBleHRlcm5hbCBtb25pdG9yaW5nIHN5c3RlbVxuICAgIFxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAvLyBMb2cgY3JpdGljYWwgZXJyb3IgZm9yIGV4dGVybmFsIG1vbml0b3JpbmdcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tFTUFJTF9NT05JVE9SXSBBTEVSVDogRW1haWwgc2VydmljZSBxdW90YSBleGNlZWRlZCAtIGltbWVkaWF0ZSBhdHRlbnRpb24gcmVxdWlyZWQnKTtcbiAgICB9XG4gIH1cbn1cblxuLy8gRXhwb3J0IHNpbmdsZXRvbiBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IGVtYWlsU2VydmljZU1vbml0b3IgPSBuZXcgRW1haWxTZXJ2aWNlTW9uaXRvcigpO1xuXG4vLyBTY2hlZHVsZSBkYWlseSByZXNldCAoYnV0IG5vdCBkdXJpbmcgdGVzdHMpXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJykge1xuICAvLyBSZXNldCBhdCBtaWRuaWdodCBVVENcbiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgY29uc3QgdG9tb3Jyb3cgPSBuZXcgRGF0ZShub3cpO1xuICB0b21vcnJvdy5zZXRVVENEYXRlKHRvbW9ycm93LmdldFVUQ0RhdGUoKSArIDEpO1xuICB0b21vcnJvdy5zZXRVVENIb3VycygwLCAwLCAwLCAwKTtcbiAgXG4gIGNvbnN0IG1zVW50aWxNaWRuaWdodCA9IHRvbW9ycm93LmdldFRpbWUoKSAtIG5vdy5nZXRUaW1lKCk7XG4gIFxuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICBlbWFpbFNlcnZpY2VNb25pdG9yLnJlc2V0RGFpbHlTdGF0cygpO1xuICAgIFxuICAgIC8vIFRoZW4gcmVzZXQgZXZlcnkgMjQgaG91cnNcbiAgICBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBlbWFpbFNlcnZpY2VNb25pdG9yLnJlc2V0RGFpbHlTdGF0cygpO1xuICAgIH0sIDI0ICogNjAgKiA2MCAqIDEwMDApO1xuICB9LCBtc1VudGlsTWlkbmlnaHQpO1xufSJdLCJuYW1lcyI6WyJFbWFpbFNlcnZpY2VNb25pdG9yIiwiZW1haWxTZXJ2aWNlTW9uaXRvciIsInJlY2VudEV2ZW50cyIsIm1heEV2ZW50cyIsInJlc2V0SW50ZXJ2YWwiLCJxdW90YUxpbWl0IiwiZ2V0UXVvdGFMaW1pdCIsInN0YXRzIiwidG90YWxTZW50IiwidG90YWxGYWlsZWQiLCJxdW90YVVzZWQiLCJlcnJvcnNCeVR5cGUiLCJzdWNjZXNzUmF0ZSIsImF2ZXJhZ2VSZXNwb25zZVRpbWUiLCJsYXN0UmVzZXRUaW1lIiwiRGF0ZSIsIm5vdyIsInJlY29yZFN1Y2Nlc3MiLCJyZXNwb25zZVRpbWUiLCJldmVudCIsInR5cGUiLCJ0aW1lc3RhbXAiLCJhZGRFdmVudCIsInVwZGF0ZVN0YXRzIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwiY29uc29sZSIsImxvZyIsInJlY29yZEZhaWx1cmUiLCJlcnJvciIsImNvZGUiLCJsYXN0RXJyb3IiLCJtZXNzYWdlIiwiaGFuZGxlUXVvdGFFeGNlZWRlZCIsImdldFN0YXRzIiwiY2hlY2tGb3JSZXNldCIsImdldFJlY2VudEV2ZW50cyIsImxpbWl0Iiwic2xpY2UiLCJnZXRFcnJvclN1bW1hcnkiLCJyZWNlbnRFcnJvcnMiLCJmaWx0ZXIiLCJjcml0aWNhbEVycm9ycyIsInRvdGFsRXJyb3JzIiwiaXNRdW90YU5lYXJMaW1pdCIsInRocmVzaG9sZCIsImdldFF1b3RhVXNhZ2VQZXJjZW50YWdlIiwiTWF0aCIsInJvdW5kIiwicmVzZXREYWlseVN0YXRzIiwiZm9yY2VSZXNldCIsImdldEhlYWx0aFN0YXR1cyIsImlzc3VlcyIsInJlY29tbWVuZGF0aW9ucyIsInN0YXR1cyIsInB1c2giLCJ0b0ZpeGVkIiwicmVjZW50Q3JpdGljYWxFcnJvcnMiLCJsZW5ndGgiLCJ0b3RhbCIsInRvdGFsVGltZSIsInJlZHVjZSIsInN1bSIsImRhaWx5TGltaXQiLCJwYXJzZUludCIsIkVNQUlMX0RBSUxZX1FVT1RBIiwidG9tb3Jyb3ciLCJzZXRVVENEYXRlIiwiZ2V0VVRDRGF0ZSIsInNldFVUQ0hvdXJzIiwibXNVbnRpbE1pZG5pZ2h0IiwiZ2V0VGltZSIsInNldFRpbWVvdXQiLCJzZXRJbnRlcnZhbCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7UUE0QmFBO2VBQUFBOztRQWtSQUM7ZUFBQUE7OztRQTlTTjtBQTRCQSxNQUFNRDtJQU1YLGFBQWM7YUFKTkUsZUFBb0MsRUFBRTthQUM3QkMsWUFBWSxNQUFNLHdCQUF3QjthQUMxQ0MsZ0JBQWdCLEtBQUssS0FBSyxLQUFLLE1BQU0sV0FBVztRQUcvRCxNQUFNQyxhQUFhLElBQUksQ0FBQ0MsYUFBYTtRQUNyQyxJQUFJLENBQUNDLEtBQUssR0FBRztZQUNYQyxXQUFXO1lBQ1hDLGFBQWE7WUFDYkMsV0FBVztZQUNYTDtZQUNBTSxjQUFjLENBQUM7WUFDZkMsYUFBYTtZQUNiQyxxQkFBcUI7WUFDckJDLGVBQWVDLEtBQUtDLEdBQUc7UUFDekI7SUFDRjtJQUVBOztHQUVDLEdBQ0RDLGNBQWNDLFlBQW9CLEVBQVE7UUFDeEMsSUFBSSxDQUFDWCxLQUFLLENBQUNDLFNBQVM7UUFDcEIsSUFBSSxJQUFJLENBQUNELEtBQUssQ0FBQ0YsVUFBVSxHQUFHLEdBQUc7WUFDN0IsSUFBSSxDQUFDRSxLQUFLLENBQUNHLFNBQVM7UUFDdEI7UUFFQSxNQUFN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