2769ca743df6ac7160cae8c3dc5200bf
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get EmailServiceMonitor () {
        return EmailServiceMonitor;
    },
    get emailServiceMonitor () {
        return emailServiceMonitor;
    }
});
require("server-only");
class EmailServiceMonitor {
    constructor(){
        this.recentEvents = [];
        this.maxEvents = 1000; // Keep last 1000 events
        this.resetInterval = 24 * 60 * 60 * 1000; // 24 hours
        const quotaLimit = this.getQuotaLimit();
        this.stats = {
            totalSent: 0,
            totalFailed: 0,
            quotaUsed: 0,
            quotaLimit,
            errorsByType: {},
            successRate: 100,
            averageResponseTime: 0,
            lastResetTime: Date.now()
        };
    }
    /**
   * Record a successful email send
   */ recordSuccess(responseTime) {
        this.stats.totalSent++;
        if (this.stats.quotaLimit > 0) {
            this.stats.quotaUsed++;
        }
        const event = {
            type: 'success',
            timestamp: Date.now(),
            responseTime
        };
        this.addEvent(event);
        this.updateStats();
        // Log success in development
        if (process.env.NODE_ENV === 'development') {
            console.log(`[EMAIL_MONITOR] Email sent successfully (${responseTime}ms)`);
        }
    }
    /**
   * Record a failed email send
   */ recordFailure(error, responseTime) {
        this.stats.totalFailed++;
        // Update error counts by type
        this.stats.errorsByType[error.code] = (this.stats.errorsByType[error.code] || 0) + 1;
        // Update last error
        this.stats.lastError = {
            message: error.message,
            code: error.code,
            timestamp: Date.now()
        };
        const event = {
            type: 'error',
            timestamp: Date.now(),
            responseTime,
            error
        };
        this.addEvent(event);
        this.updateStats();
        // Log error
        console.error(`[EMAIL_MONITOR] Email send failed: ${error.code} - ${error.message} (${responseTime}ms)`);
        // Check for quota issues
        if (error.code === 'QUOTA_EXCEEDED') {
            this.handleQuotaExceeded();
        }
    }
    /**
   * Get current statistics
   */ getStats() {
        this.checkForReset();
        return {
            ...this.stats
        };
    }
    /**
   * Get recent events (last N events)
   */ getRecentEvents(limit = 100) {
        return this.recentEvents.slice(-limit);
    }
    /**
   * Get error summary
   */ getErrorSummary() {
        const recentErrors = this.recentEvents.filter((event)=>event.type === 'error').slice(-50);
        const criticalErrors = this.recentEvents.filter((event)=>event.type === 'error' && event.error?.code === 'QUOTA_EXCEEDED').slice(-10);
        return {
            totalErrors: this.stats.totalFailed,
            errorsByType: {
                ...this.stats.errorsByType
            },
            recentErrors,
            criticalErrors
        };
    }
    /**
   * Check if quota is approaching limit
   */ isQuotaNearLimit(threshold = 0.8) {
        if (this.stats.quotaLimit === 0) return false;
        return this.stats.quotaUsed / this.stats.quotaLimit >= threshold;
    }
    /**
   * Get quota usage percentage
   */ getQuotaUsagePercentage() {
        if (this.stats.quotaLimit === 0) return 0;
        return Math.round(this.stats.quotaUsed / this.stats.quotaLimit * 100);
    }
    /**
   * Reset daily statistics (called automatically)
   */ resetDailyStats() {
        console.log('[EMAIL_MONITOR] Resetting daily statistics');
        this.stats.totalSent = 0;
        this.stats.totalFailed = 0;
        this.stats.quotaUsed = 0;
        this.stats.errorsByType = {};
        this.stats.lastResetTime = Date.now();
        // Keep only recent events (last 100)
        this.recentEvents = this.recentEvents.slice(-100);
        this.updateStats();
    }
    /**
   * Force reset statistics (for testing or manual reset)
   */ forceReset() {
        console.log('[EMAIL_MONITOR] Force resetting statistics');
        this.resetDailyStats();
    }
    /**
   * Get health status
   */ getHealthStatus() {
        const issues = [];
        const recommendations = [];
        let status = 'healthy';
        // Check success rate
        if (this.stats.successRate < 95) {
            status = 'warning';
            issues.push(`Low success rate: ${this.stats.successRate.toFixed(1)}%`);
            recommendations.push('Check email service configuration and network connectivity');
        }
        if (this.stats.successRate < 80) {
            status = 'critical';
        }
        // Check quota usage
        if (this.isQuotaNearLimit(0.9)) {
            status = status === 'critical' ? 'critical' : 'warning';
            issues.push(`High quota usage: ${this.getQuotaUsagePercentage()}%`);
            recommendations.push('Consider upgrading email service plan or implementing email throttling');
        }
        if (this.isQuotaNearLimit(0.95)) {
            status = 'critical';
        }
        // Check for recent critical errors
        const recentCriticalErrors = this.recentEvents.filter((event)=>event.type === 'error' && event.error?.code === 'QUOTA_EXCEEDED' && Date.now() - event.timestamp < 60 * 60 * 1000 // Last hour
        );
        if (recentCriticalErrors.length > 0) {
            status = 'critical';
            issues.push('Quota exceeded errors in the last hour');
            recommendations.push('Immediate attention required - email service quota exceeded');
        }
        // Check average response time
        if (this.stats.averageResponseTime > 5000) {
            status = status === 'critical' ? 'critical' : 'warning';
            issues.push(`High response time: ${this.stats.averageResponseTime}ms`);
            recommendations.push('Check email service performance and network latency');
        }
        return {
            status,
            issues,
            recommendations
        };
    }
    addEvent(event) {
        this.recentEvents.push(event);
        // Keep only the most recent events
        if (this.recentEvents.length > this.maxEvents) {
            this.recentEvents = this.recentEvents.slice(-this.maxEvents);
        }
    }
    updateStats() {
        const total = this.stats.totalSent + this.stats.totalFailed;
        this.stats.successRate = total > 0 ? this.stats.totalSent / total * 100 : 100;
        // Calculate average response time from recent events
        const recentEvents = this.recentEvents.slice(-100);
        if (recentEvents.length > 0) {
            const totalTime = recentEvents.reduce((sum, event)=>sum + event.responseTime, 0);
            this.stats.averageResponseTime = Math.round(totalTime / recentEvents.length);
        }
    }
    checkForReset() {
        const now = Date.now();
        if (now - this.stats.lastResetTime >= this.resetInterval) {
            this.resetDailyStats();
        }
    }
    getQuotaLimit() {
        // Default Resend free tier limits
        // This could be made configurable via environment variables
        const dailyLimit = parseInt(process.env.EMAIL_DAILY_QUOTA || '100', 10);
        return dailyLimit;
    }
    handleQuotaExceeded() {
        console.error('[EMAIL_MONITOR] CRITICAL: Email quota exceeded!');
        // In a production system, you might want to:
        // - Send alerts to administrators
        // - Temporarily disable email sending
        // - Switch to a backup email service
        // - Log to external monitoring system
        if (process.env.NODE_ENV === 'production') {
            // Log critical error for external monitoring
            console.error('[EMAIL_MONITOR] ALERT: Email service quota exceeded - immediate attention required');
        }
    }
}
const emailServiceMonitor = new EmailServiceMonitor();
// Schedule daily reset
if (process.env.NODE_ENV === 'production') {
    // Reset at midnight UTC
    const now = new Date();
    const tomorrow = new Date(now);
    tomorrow.setUTCDate(tomorrow.getUTCDate() + 1);
    tomorrow.setUTCHours(0, 0, 0, 0);
    const msUntilMidnight = tomorrow.getTime() - now.getTime();
    setTimeout(()=>{
        emailServiceMonitor.resetDailyStats();
        // Then reset every 24 hours
        setInterval(()=>{
            emailServiceMonitor.resetDailyStats();
        }, 24 * 60 * 60 * 1000);
    }, msUntilMidnight);
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdGVmYW5iZWtrZXIvcHJvamVjdHMvZmFuY3ktcGxhbnRpZXMvc3JjL2xpYi9zZXJ2aWNlcy9lbWFpbC1zZXJ2aWNlLW1vbml0b3IudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICdzZXJ2ZXItb25seSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1haWxTZXJ2aWNlU3RhdHMge1xuICB0b3RhbFNlbnQ6IG51bWJlcjtcbiAgdG90YWxGYWlsZWQ6IG51bWJlcjtcbiAgcXVvdGFVc2VkOiBudW1iZXI7XG4gIHF1b3RhTGltaXQ6IG51bWJlcjtcbiAgbGFzdEVycm9yPzoge1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICBjb2RlOiBzdHJpbmc7XG4gICAgdGltZXN0YW1wOiBudW1iZXI7XG4gIH07XG4gIGVycm9yc0J5VHlwZTogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgc3VjY2Vzc1JhdGU6IG51bWJlcjtcbiAgYXZlcmFnZVJlc3BvbnNlVGltZTogbnVtYmVyO1xuICBsYXN0UmVzZXRUaW1lOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1haWxTZXJ2aWNlRXZlbnQge1xuICB0eXBlOiAnc3VjY2VzcycgfCAnZXJyb3InO1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbiAgcmVzcG9uc2VUaW1lOiBudW1iZXI7XG4gIGVycm9yPzoge1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICBjb2RlOiBzdHJpbmc7XG4gIH07XG59XG5cbmV4cG9ydCBjbGFzcyBFbWFpbFNlcnZpY2VNb25pdG9yIHtcbiAgcHJpdmF0ZSBzdGF0czogRW1haWxTZXJ2aWNlU3RhdHM7XG4gIHByaXZhdGUgcmVjZW50RXZlbnRzOiBFbWFpbFNlcnZpY2VFdmVudFtdID0gW107XG4gIHByaXZhdGUgcmVhZG9ubHkgbWF4RXZlbnRzID0gMTAwMDsgLy8gS2VlcCBsYXN0IDEwMDAgZXZlbnRzXG4gIHByaXZhdGUgcmVhZG9ubHkgcmVzZXRJbnRlcnZhbCA9IDI0ICogNjAgKiA2MCAqIDEwMDA7IC8vIDI0IGhvdXJzXG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgY29uc3QgcXVvdGFMaW1pdCA9IHRoaXMuZ2V0UXVvdGFMaW1pdCgpO1xuICAgIHRoaXMuc3RhdHMgPSB7XG4gICAgICB0b3RhbFNlbnQ6IDAsXG4gICAgICB0b3RhbEZhaWxlZDogMCxcbiAgICAgIHF1b3RhVXNlZDogMCxcbiAgICAgIHF1b3RhTGltaXQsXG4gICAgICBlcnJvcnNCeVR5cGU6IHt9LFxuICAgICAgc3VjY2Vzc1JhdGU6IDEwMCxcbiAgICAgIGF2ZXJhZ2VSZXNwb25zZVRpbWU6IDAsXG4gICAgICBsYXN0UmVzZXRUaW1lOiBEYXRlLm5vdygpLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUmVjb3JkIGEgc3VjY2Vzc2Z1bCBlbWFpbCBzZW5kXG4gICAqL1xuICByZWNvcmRTdWNjZXNzKHJlc3BvbnNlVGltZTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5zdGF0cy50b3RhbFNlbnQrKztcbiAgICBpZiAodGhpcy5zdGF0cy5xdW90YUxpbWl0ID4gMCkge1xuICAgICAgdGhpcy5zdGF0cy5xdW90YVVzZWQrKztcbiAgICB9XG4gICAgXG4gICAgY29uc3QgZXZlbnQ6IEVtYWlsU2VydmljZUV2ZW50ID0ge1xuICAgICAgdHlwZTogJ3N1Y2Nlc3MnLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgcmVzcG9uc2VUaW1lLFxuICAgIH07XG4gICAgXG4gICAgdGhpcy5hZGRFdmVudChldmVudCk7XG4gICAgdGhpcy51cGRhdGVTdGF0cygpO1xuICAgIFxuICAgIC8vIExvZyBzdWNjZXNzIGluIGRldmVsb3BtZW50XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnKSB7XG4gICAgICBjb25zb2xlLmxvZyhgW0VNQUlMX01PTklUT1JdIEVtYWlsIHNlbnQgc3VjY2Vzc2Z1bGx5ICgke3Jlc3BvbnNlVGltZX1tcylgKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVjb3JkIGEgZmFpbGVkIGVtYWlsIHNlbmRcbiAgICovXG4gIHJlY29yZEZhaWx1cmUoZXJyb3I6IHsgbWVzc2FnZTogc3RyaW5nOyBjb2RlOiBzdHJpbmcgfSwgcmVzcG9uc2VUaW1lOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnN0YXRzLnRvdGFsRmFpbGVkKys7XG4gICAgXG4gICAgLy8gVXBkYXRlIGVycm9yIGNvdW50cyBieSB0eXBlXG4gICAgdGhpcy5zdGF0cy5lcnJvcnNCeVR5cGVbZXJyb3IuY29kZV0gPSAodGhpcy5zdGF0cy5lcnJvcnNCeVR5cGVbZXJyb3IuY29kZV0gfHwgMCkgKyAxO1xuICAgIFxuICAgIC8vIFVwZGF0ZSBsYXN0IGVycm9yXG4gICAgdGhpcy5zdGF0cy5sYXN0RXJyb3IgPSB7XG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgY29kZTogZXJyb3IuY29kZSxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICB9O1xuICAgIFxuICAgIGNvbnN0IGV2ZW50OiBFbWFpbFNlcnZpY2VFdmVudCA9IHtcbiAgICAgIHR5cGU6ICdlcnJvcicsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICByZXNwb25zZVRpbWUsXG4gICAgICBlcnJvcixcbiAgICB9O1xuICAgIFxuICAgIHRoaXMuYWRkRXZlbnQoZXZlbnQpO1xuICAgIHRoaXMudXBkYXRlU3RhdHMoKTtcbiAgICBcbiAgICAvLyBMb2cgZXJyb3JcbiAgICBjb25zb2xlLmVycm9yKGBbRU1BSUxfTU9OSVRPUl0gRW1haWwgc2VuZCBmYWlsZWQ6ICR7ZXJyb3IuY29kZX0gLSAke2Vycm9yLm1lc3NhZ2V9ICgke3Jlc3BvbnNlVGltZX1tcylgKTtcbiAgICBcbiAgICAvLyBDaGVjayBmb3IgcXVvdGEgaXNzdWVzXG4gICAgaWYgKGVycm9yLmNvZGUgPT09ICdRVU9UQV9FWENFRURFRCcpIHtcbiAgICAgIHRoaXMuaGFuZGxlUXVvdGFFeGNlZWRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY3VycmVudCBzdGF0aXN0aWNzXG4gICAqL1xuICBnZXRTdGF0cygpOiBFbWFpbFNlcnZpY2VTdGF0cyB7XG4gICAgdGhpcy5jaGVja0ZvclJlc2V0KCk7XG4gICAgcmV0dXJuIHsgLi4udGhpcy5zdGF0cyB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCByZWNlbnQgZXZlbnRzIChsYXN0IE4gZXZlbnRzKVxuICAgKi9cbiAgZ2V0UmVjZW50RXZlbnRzKGxpbWl0OiBudW1iZXIgPSAxMDApOiBFbWFpbFNlcnZpY2VFdmVudFtdIHtcbiAgICByZXR1cm4gdGhpcy5yZWNlbnRFdmVudHMuc2xpY2UoLWxpbWl0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZXJyb3Igc3VtbWFyeVxuICAgKi9cbiAgZ2V0RXJyb3JTdW1tYXJ5KCk6IHtcbiAgICB0b3RhbEVycm9yczogbnVtYmVyO1xuICAgIGVycm9yc0J5VHlwZTogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgICByZWNlbnRFcnJvcnM6IEVtYWlsU2VydmljZUV2ZW50W107XG4gICAgY3JpdGljYWxFcnJvcnM6IEVtYWlsU2VydmljZUV2ZW50W107XG4gIH0ge1xuICAgIGNvbnN0IHJlY2VudEVycm9ycyA9IHRoaXMucmVjZW50RXZlbnRzXG4gICAgICAuZmlsdGVyKGV2ZW50ID0+IGV2ZW50LnR5cGUgPT09ICdlcnJvcicpXG4gICAgICAuc2xpY2UoLTUwKTtcbiAgICBcbiAgICBjb25zdCBjcml0aWNhbEVycm9ycyA9IHRoaXMucmVjZW50RXZlbnRzXG4gICAgICAuZmlsdGVyKGV2ZW50ID0+IFxuICAgICAgICBldmVudC50eXBlID09PSAnZXJyb3InICYmIFxuICAgICAgICBldmVudC5lcnJvcj8uY29kZSA9PT0gJ1FVT1RBX0VYQ0VFREVEJ1xuICAgICAgKVxuICAgICAgLnNsaWNlKC0xMCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxFcnJvcnM6IHRoaXMuc3RhdHMudG90YWxGYWlsZWQsXG4gICAgICBlcnJvcnNCeVR5cGU6IHsgLi4udGhpcy5zdGF0cy5lcnJvcnNCeVR5cGUgfSxcbiAgICAgIHJlY2VudEVycm9ycyxcbiAgICAgIGNyaXRpY2FsRXJyb3JzLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgcXVvdGEgaXMgYXBwcm9hY2hpbmcgbGltaXRcbiAgICovXG4gIGlzUXVvdGFOZWFyTGltaXQodGhyZXNob2xkOiBudW1iZXIgPSAwLjgpOiBib29sZWFuIHtcbiAgICBpZiAodGhpcy5zdGF0cy5xdW90YUxpbWl0ID09PSAwKSByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuICh0aGlzLnN0YXRzLnF1b3RhVXNlZCAvIHRoaXMuc3RhdHMucXVvdGFMaW1pdCkgPj0gdGhyZXNob2xkO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBxdW90YSB1c2FnZSBwZXJjZW50YWdlXG4gICAqL1xuICBnZXRRdW90YVVzYWdlUGVyY2VudGFnZSgpOiBudW1iZXIge1xuICAgIGlmICh0aGlzLnN0YXRzLnF1b3RhTGltaXQgPT09IDApIHJldHVybiAwO1xuICAgIHJldHVybiBNYXRoLnJvdW5kKCh0aGlzLnN0YXRzLnF1b3RhVXNlZCAvIHRoaXMuc3RhdHMucXVvdGFMaW1pdCkgKiAxMDApO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc2V0IGRhaWx5IHN0YXRpc3RpY3MgKGNhbGxlZCBhdXRvbWF0aWNhbGx5KVxuICAgKi9cbiAgcmVzZXREYWlseVN0YXRzKCk6IHZvaWQge1xuICAgIGNvbnNvbGUubG9nKCdbRU1BSUxfTU9OSVRPUl0gUmVzZXR0aW5nIGRhaWx5IHN0YXRpc3RpY3MnKTtcbiAgICBcbiAgICB0aGlzLnN0YXRzLnRvdGFsU2VudCA9IDA7XG4gICAgdGhpcy5zdGF0cy50b3RhbEZhaWxlZCA9IDA7XG4gICAgdGhpcy5zdGF0cy5xdW90YVVzZWQgPSAwO1xuICAgIHRoaXMuc3RhdHMuZXJyb3JzQnlUeXBlID0ge307XG4gICAgdGhpcy5zdGF0cy5sYXN0UmVzZXRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICBcbiAgICAvLyBLZWVwIG9ubHkgcmVjZW50IGV2ZW50cyAobGFzdCAxMDApXG4gICAgdGhpcy5yZWNlbnRFdmVudHMgPSB0aGlzLnJlY2VudEV2ZW50cy5zbGljZSgtMTAwKTtcbiAgICBcbiAgICB0aGlzLnVwZGF0ZVN0YXRzKCk7XG4gIH1cblxuICAvKipcbiAgICogRm9yY2UgcmVzZXQgc3RhdGlzdGljcyAoZm9yIHRlc3Rpbmcgb3IgbWFudWFsIHJlc2V0KVxuICAgKi9cbiAgZm9yY2VSZXNldCgpOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZygnW0VNQUlMX01PTklUT1JdIEZvcmNlIHJlc2V0dGluZyBzdGF0aXN0aWNzJyk7XG4gICAgdGhpcy5yZXNldERhaWx5U3RhdHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgaGVhbHRoIHN0YXR1c1xuICAgKi9cbiAgZ2V0SGVhbHRoU3RhdHVzKCk6IHtcbiAgICBzdGF0dXM6ICdoZWFsdGh5JyB8ICd3YXJuaW5nJyB8ICdjcml0aWNhbCc7XG4gICAgaXNzdWVzOiBzdHJpbmdbXTtcbiAgICByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdO1xuICB9IHtcbiAgICBjb25zdCBpc3N1ZXM6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgIGxldCBzdGF0dXM6ICdoZWFsdGh5JyB8ICd3YXJuaW5nJyB8ICdjcml0aWNhbCcgPSAnaGVhbHRoeSc7XG5cbiAgICAvLyBDaGVjayBzdWNjZXNzIHJhdGVcbiAgICBpZiAodGhpcy5zdGF0cy5zdWNjZXNzUmF0ZSA8IDk1KSB7XG4gICAgICBzdGF0dXMgPSAnd2FybmluZyc7XG4gICAgICBpc3N1ZXMucHVzaChgTG93IHN1Y2Nlc3MgcmF0ZTogJHt0aGlzLnN0YXRzLnN1Y2Nlc3NSYXRlLnRvRml4ZWQoMSl9JWApO1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0NoZWNrIGVtYWlsIHNlcnZpY2UgY29uZmlndXJhdGlvbiBhbmQgbmV0d29yayBjb25uZWN0aXZpdHknKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zdGF0cy5zdWNjZXNzUmF0ZSA8IDgwKSB7XG4gICAgICBzdGF0dXMgPSAnY3JpdGljYWwnO1xuICAgIH1cblxuICAgIC8vIENoZWNrIHF1b3RhIHVzYWdlXG4gICAgaWYgKHRoaXMuaXNRdW90YU5lYXJMaW1pdCgwLjkpKSB7XG4gICAgICBzdGF0dXMgPSBzdGF0dXMgPT09ICdjcml0aWNhbCcgPyAnY3JpdGljYWwnIDogJ3dhcm5pbmcnO1xuICAgICAgaXNzdWVzLnB1c2goYEhpZ2ggcXVvdGEgdXNhZ2U6ICR7dGhpcy5nZXRRdW90YVVzYWdlUGVyY2VudGFnZSgpfSVgKTtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdDb25zaWRlciB1cGdyYWRpbmcgZW1haWwgc2VydmljZSBwbGFuIG9yIGltcGxlbWVudGluZyBlbWFpbCB0aHJvdHRsaW5nJyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNRdW90YU5lYXJMaW1pdCgwLjk1KSkge1xuICAgICAgc3RhdHVzID0gJ2NyaXRpY2FsJztcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3IgcmVjZW50IGNyaXRpY2FsIGVycm9yc1xuICAgIGNvbnN0IHJlY2VudENyaXRpY2FsRXJyb3JzID0gdGhpcy5yZWNlbnRFdmVudHNcbiAgICAgIC5maWx0ZXIoZXZlbnQgPT4gXG4gICAgICAgIGV2ZW50LnR5cGUgPT09ICdlcnJvcicgJiYgXG4gICAgICAgIGV2ZW50LmVycm9yPy5jb2RlID09PSAnUVVPVEFfRVhDRUVERUQnICYmXG4gICAgICAgIERhdGUubm93KCkgLSBldmVudC50aW1lc3RhbXAgPCA2MCAqIDYwICogMTAwMCAvLyBMYXN0IGhvdXJcbiAgICAgICk7XG5cbiAgICBpZiAocmVjZW50Q3JpdGljYWxFcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgc3RhdHVzID0gJ2NyaXRpY2FsJztcbiAgICAgIGlzc3Vlcy5wdXNoKCdRdW90YSBleGNlZWRlZCBlcnJvcnMgaW4gdGhlIGxhc3QgaG91cicpO1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0ltbWVkaWF0ZSBhdHRlbnRpb24gcmVxdWlyZWQgLSBlbWFpbCBzZXJ2aWNlIHF1b3RhIGV4Y2VlZGVkJyk7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgYXZlcmFnZSByZXNwb25zZSB0aW1lXG4gICAgaWYgKHRoaXMuc3RhdHMuYXZlcmFnZVJlc3BvbnNlVGltZSA+IDUwMDApIHtcbiAgICAgIHN0YXR1cyA9IHN0YXR1cyA9PT0gJ2NyaXRpY2FsJyA/ICdjcml0aWNhbCcgOiAnd2FybmluZyc7XG4gICAgICBpc3N1ZXMucHVzaChgSGlnaCByZXNwb25zZSB0aW1lOiAke3RoaXMuc3RhdHMuYXZlcmFnZVJlc3BvbnNlVGltZX1tc2ApO1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0NoZWNrIGVtYWlsIHNlcnZpY2UgcGVyZm9ybWFuY2UgYW5kIG5ldHdvcmsgbGF0ZW5jeScpO1xuICAgIH1cblxuICAgIHJldHVybiB7IHN0YXR1cywgaXNzdWVzLCByZWNvbW1lbmRhdGlvbnMgfTtcbiAgfVxuXG4gIHByaXZhdGUgYWRkRXZlbnQoZXZlbnQ6IEVtYWlsU2VydmljZUV2ZW50KTogdm9pZCB7XG4gICAgdGhpcy5yZWNlbnRFdmVudHMucHVzaChldmVudCk7XG4gICAgXG4gICAgLy8gS2VlcCBvbmx5IHRoZSBtb3N0IHJlY2VudCBldmVudHNcbiAgICBpZiAodGhpcy5yZWNlbnRFdmVudHMubGVuZ3RoID4gdGhpcy5tYXhFdmVudHMpIHtcbiAgICAgIHRoaXMucmVjZW50RXZlbnRzID0gdGhpcy5yZWNlbnRFdmVudHMuc2xpY2UoLXRoaXMubWF4RXZlbnRzKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZVN0YXRzKCk6IHZvaWQge1xuICAgIGNvbnN0IHRvdGFsID0gdGhpcy5zdGF0cy50b3RhbFNlbnQgKyB0aGlzLnN0YXRzLnRvdGFsRmFpbGVkO1xuICAgIHRoaXMuc3RhdHMuc3VjY2Vzc1JhdGUgPSB0b3RhbCA+IDAgPyAodGhpcy5zdGF0cy50b3RhbFNlbnQgLyB0b3RhbCkgKiAxMDAgOiAxMDA7XG4gICAgXG4gICAgLy8gQ2FsY3VsYXRlIGF2ZXJhZ2UgcmVzcG9uc2UgdGltZSBmcm9tIHJlY2VudCBldmVudHNcbiAgICBjb25zdCByZWNlbnRFdmVudHMgPSB0aGlzLnJlY2VudEV2ZW50cy5zbGljZSgtMTAwKTtcbiAgICBpZiAocmVjZW50RXZlbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IHRvdGFsVGltZSA9IHJlY2VudEV2ZW50cy5yZWR1Y2UoKHN1bSwgZXZlbnQpID0+IHN1bSArIGV2ZW50LnJlc3BvbnNlVGltZSwgMCk7XG4gICAgICB0aGlzLnN0YXRzLmF2ZXJhZ2VSZXNwb25zZVRpbWUgPSBNYXRoLnJvdW5kKHRvdGFsVGltZSAvIHJlY2VudEV2ZW50cy5sZW5ndGgpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY2hlY2tGb3JSZXNldCgpOiB2b2lkIHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGlmIChub3cgLSB0aGlzLnN0YXRzLmxhc3RSZXNldFRpbWUgPj0gdGhpcy5yZXNldEludGVydmFsKSB7XG4gICAgICB0aGlzLnJlc2V0RGFpbHlTdGF0cygpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0UXVvdGFMaW1pdCgpOiBudW1iZXIge1xuICAgIC8vIERlZmF1bHQgUmVzZW5kIGZyZWUgdGllciBsaW1pdHNcbiAgICAvLyBUaGlzIGNvdWxkIGJlIG1hZGUgY29uZmlndXJhYmxlIHZpYSBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbiAgICBjb25zdCBkYWlseUxpbWl0ID0gcGFyc2VJbnQocHJvY2Vzcy5lbnYuRU1BSUxfREFJTFlfUVVPVEEgfHwgJzEwMCcsIDEwKTtcbiAgICByZXR1cm4gZGFpbHlMaW1pdDtcbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlUXVvdGFFeGNlZWRlZCgpOiB2b2lkIHtcbiAgICBjb25zb2xlLmVycm9yKCdbRU1BSUxfTU9OSVRPUl0gQ1JJVElDQUw6IEVtYWlsIHF1b3RhIGV4Y2VlZGVkIScpO1xuICAgIFxuICAgIC8vIEluIGEgcHJvZHVjdGlvbiBzeXN0ZW0sIHlvdSBtaWdodCB3YW50IHRvOlxuICAgIC8vIC0gU2VuZCBhbGVydHMgdG8gYWRtaW5pc3RyYXRvcnNcbiAgICAvLyAtIFRlbXBvcmFyaWx5IGRpc2FibGUgZW1haWwgc2VuZGluZ1xuICAgIC8vIC0gU3dpdGNoIHRvIGEgYmFja3VwIGVtYWlsIHNlcnZpY2VcbiAgICAvLyAtIExvZyB0byBleHRlcm5hbCBtb25pdG9yaW5nIHN5c3RlbVxuICAgIFxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAvLyBMb2cgY3JpdGljYWwgZXJyb3IgZm9yIGV4dGVybmFsIG1vbml0b3JpbmdcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tFTUFJTF9NT05JVE9SXSBBTEVSVDogRW1haWwgc2VydmljZSBxdW90YSBleGNlZWRlZCAtIGltbWVkaWF0ZSBhdHRlbnRpb24gcmVxdWlyZWQnKTtcbiAgICB9XG4gIH1cbn1cblxuLy8gRXhwb3J0IHNpbmdsZXRvbiBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IGVtYWlsU2VydmljZU1vbml0b3IgPSBuZXcgRW1haWxTZXJ2aWNlTW9uaXRvcigpO1xuXG4vLyBTY2hlZHVsZSBkYWlseSByZXNldFxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicpIHtcbiAgLy8gUmVzZXQgYXQgbWlkbmlnaHQgVVRDXG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gIGNvbnN0IHRvbW9ycm93ID0gbmV3IERhdGUobm93KTtcbiAgdG9tb3Jyb3cuc2V0VVRDRGF0ZSh0b21vcnJvdy5nZXRVVENEYXRlKCkgKyAxKTtcbiAgdG9tb3Jyb3cuc2V0VVRDSG91cnMoMCwgMCwgMCwgMCk7XG4gIFxuICBjb25zdCBtc1VudGlsTWlkbmlnaHQgPSB0b21vcnJvdy5nZXRUaW1lKCkgLSBub3cuZ2V0VGltZSgpO1xuICBcbiAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgZW1haWxTZXJ2aWNlTW9uaXRvci5yZXNldERhaWx5U3RhdHMoKTtcbiAgICBcbiAgICAvLyBUaGVuIHJlc2V0IGV2ZXJ5IDI0IGhvdXJzXG4gICAgc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgZW1haWxTZXJ2aWNlTW9uaXRvci5yZXNldERhaWx5U3RhdHMoKTtcbiAgICB9LCAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgfSwgbXNVbnRpbE1pZG5pZ2h0KTtcbn0iXSwibmFtZXMiOlsiRW1haWxTZXJ2aWNlTW9uaXRvciIsImVtYWlsU2VydmljZU1vbml0b3IiLCJyZWNlbnRFdmVudHMiLCJtYXhFdmVudHMiLCJyZXNldEludGVydmFsIiwicXVvdGFMaW1pdCIsImdldFF1b3RhTGltaXQiLCJzdGF0cyIsInRvdGFsU2VudCIsInRvdGFsRmFpbGVkIiwicXVvdGFVc2VkIiwiZXJyb3JzQnlUeXBlIiwic3VjY2Vzc1JhdGUiLCJhdmVyYWdlUmVzcG9uc2VUaW1lIiwibGFzdFJlc2V0VGltZSIsIkRhdGUiLCJub3ciLCJyZWNvcmRTdWNjZXNzIiwicmVzcG9uc2VUaW1lIiwiZXZlbnQiLCJ0eXBlIiwidGltZXN0YW1wIiwiYWRkRXZlbnQiLCJ1cGRhdGVTdGF0cyIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsImNvbnNvbGUiLCJsb2ciLCJyZWNvcmRGYWlsdXJlIiwiZXJyb3IiLCJjb2RlIiwibGFzdEVycm9yIiwibWVzc2FnZSIsImhhbmRsZVF1b3RhRXhjZWVkZWQiLCJnZXRTdGF0cyIsImNoZWNrRm9yUmVzZXQiLCJnZXRSZWNlbnRFdmVudHMiLCJsaW1pdCIsInNsaWNlIiwiZ2V0RXJyb3JTdW1tYXJ5IiwicmVjZW50RXJyb3JzIiwiZmlsdGVyIiwiY3JpdGljYWxFcnJvcnMiLCJ0b3RhbEVycm9ycyIsImlzUXVvdGFOZWFyTGltaXQiLCJ0aHJlc2hvbGQiLCJnZXRRdW90YVVzYWdlUGVyY2VudGFnZSIsIk1hdGgiLCJyb3VuZCIsInJlc2V0RGFpbHlTdGF0cyIsImZvcmNlUmVzZXQiLCJnZXRIZWFsdGhTdGF0dXMiLCJpc3N1ZXMiLCJyZWNvbW1lbmRhdGlvbnMiLCJzdGF0dXMiLCJwdXNoIiwidG9GaXhlZCIsInJlY2VudENyaXRpY2FsRXJyb3JzIiwibGVuZ3RoIiwidG90YWwiLCJ0b3RhbFRpbWUiLCJyZWR1Y2UiLCJzdW0iLCJkYWlseUxpbWl0IiwicGFyc2VJbnQiLCJFTUFJTF9EQUlMWV9RVU9UQSIsInRvbW9ycm93Iiwic2V0VVRDRGF0ZSIsImdldFVUQ0RhdGUiLCJzZXRVVENIb3VycyIsIm1zVW50aWxNaWRuaWdodCIsImdldFRpbWUiLCJzZXRUaW1lb3V0Iiwic2V0SW50ZXJ2YWwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O1FBNEJhQTtlQUFBQTs7UUFrUkFDO2VBQUFBOzs7UUE5U047QUE0QkEsTUFBTUQ7SUFNWCxhQUFjO2FBSk5FLGVBQW9DLEVBQUU7YUFDN0JDLFlBQVksTUFBTSx3QkFBd0I7YUFDMUNDLGdCQUFnQixLQUFLLEtBQUssS0FBSyxNQUFNLFdBQVc7UUFHL0QsTUFBTUMsYUFBYSxJQUFJLENBQUNDLGFBQWE7UUFDckMsSUFBSSxDQUFDQyxLQUFLLEdBQUc7WUFDWEMsV0FBVztZQUNYQyxhQUFhO1lBQ2JDLFdBQVc7WUFDWEw7WUFDQU0sY0FBYyxDQUFDO1lBQ2ZDLGFBQWE7WUFDYkMscUJBQXFCO1lBQ3JCQyxlQUFlQyxLQUFLQyxHQUFHO1FBQ3pCO0lBQ0Y7SUFFQTs7R0FFQyxHQUNEQyxjQUFjQyxZQUFvQixFQUFRO1FBQ3hDLElBQUksQ0FBQ1gsS0FBSyxDQUFDQyxTQUFTO1FBQ3BCLElBQUksSUFBSSxDQUFDRCxLQUFLLENBQUNGLFVBQVUsR0FBRyxHQUFHO1lBQzdCLElBQUksQ0FBQ0UsS0FBSyxDQUFDRyxTQUFTO1FBQ3RCO1FBRUEsTUFBTVMsUUFBMkI7WUFDL0JDLE1BQU07WUFD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