{"version":3,"sources":["/Users/stefanbekker/projects/fancy-planties/src/app/api/care/log/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { requireAuthSession } from '@/lib/auth/server';\nimport { CareService } from '@/lib/services/care-service';\nimport { careValidation } from '@/lib/validation/care-schemas';\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { user } = await requireAuthSession();\n    const body = await request.json();\n    \n    // Validate the care form data\n    const validation = careValidation.validateCareForm({\n      ...body,\n      careDate: new Date(body.careDate),\n    });\n    \n    if (!validation.success) {\n      return NextResponse.json(\n        { error: validation.error.issues[0]?.message || 'Invalid care data' },\n        { status: 400 }\n      );\n    }\n    \n    const result = await CareService.logCareEvent(user.id, validation.data);\n    \n    if (!result.success) {\n      return NextResponse.json(\n        { error: result.error },\n        { status: 400 }\n      );\n    }\n    \n    return NextResponse.json(result.careHistory);\n  } catch (error) {\n    console.error('Error logging care:', error);\n    return NextResponse.json(\n      { error: 'Failed to log care event' },\n      { status: 500 }\n    );\n  }\n}"],"names":["POST","request","user","requireAuthSession","body","json","validation","careValidation","validateCareForm","careDate","Date","success","NextResponse","error","issues","message","status","result","CareService","logCareEvent","id","data","careHistory","console"],"mappings":";;;;+BAKsBA;;;eAAAA;;;wBALoB;yBACP;6BACP;6BACG;AAExB,eAAeA,KAAKC,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAEC,IAAI,EAAE,GAAG,MAAMC,IAAAA,2BAAkB;QACzC,MAAMC,OAAO,MAAMH,QAAQI,IAAI;QAE/B,8BAA8B;QAC9B,MAAMC,aAAaC,2BAAc,CAACC,gBAAgB,CAAC;YACjD,GAAGJ,IAAI;YACPK,UAAU,IAAIC,KAAKN,KAAKK,QAAQ;QAClC;QAEA,IAAI,CAACH,WAAWK,OAAO,EAAE;YACvB,OAAOC,oBAAY,CAACP,IAAI,CACtB;gBAAEQ,OAAOP,WAAWO,KAAK,CAACC,MAAM,CAAC,EAAE,EAAEC,WAAW;YAAoB,GACpE;gBAAEC,QAAQ;YAAI;QAElB;QAEA,MAAMC,SAAS,MAAMC,wBAAW,CAACC,YAAY,CAACjB,KAAKkB,EAAE,EAAEd,WAAWe,IAAI;QAEtE,IAAI,CAACJ,OAAON,OAAO,EAAE;YACnB,OAAOC,oBAAY,CAACP,IAAI,CACtB;gBAAEQ,OAAOI,OAAOJ,KAAK;YAAC,GACtB;gBAAEG,QAAQ;YAAI;QAElB;QAEA,OAAOJ,oBAAY,CAACP,IAAI,CAACY,OAAOK,WAAW;IAC7C,EAAE,OAAOT,OAAO;QACdU,QAAQV,KAAK,CAAC,uBAAuBA;QACrC,OAAOD,oBAAY,CAACP,IAAI,CACtB;YAAEQ,OAAO;QAA2B,GACpC;YAAEG,QAAQ;QAAI;IAElB;AACF"}