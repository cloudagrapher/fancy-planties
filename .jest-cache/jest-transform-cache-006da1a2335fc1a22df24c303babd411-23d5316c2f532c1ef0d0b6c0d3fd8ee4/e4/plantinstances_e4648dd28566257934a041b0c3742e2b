f53320f386f301da7518bd4ba970dcd9
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "PlantInstanceQueries", {
    enumerable: true,
    get: function() {
        return PlantInstanceQueries;
    }
});
const _drizzleorm = require("drizzle-orm");
const _index = require("../index");
const _schema = require("../schema");
const _plantinstancetypes = require("../../types/plant-instance-types");
class PlantInstanceQueries {
    // Create a new plant instance
    static async create(instanceData) {
        try {
            const [instance] = await _index.db.insert(_schema.plantInstances).values(instanceData).returning();
            return instance;
        } catch (error) {
            console.error('Failed to create plant instance:', error);
            throw new Error('Failed to create plant instance');
        }
    }
    // Get plant instance by ID with plant taxonomy data
    static async getById(id) {
        try {
            const [instance] = await _index.db.select().from(_schema.plantInstances).leftJoin(_schema.plants, (0, _drizzleorm.eq)(_schema.plantInstances.plantId, _schema.plants.id)).where((0, _drizzleorm.eq)(_schema.plantInstances.id, id));
            if (!instance) return null;
            return {
                ...instance.plant_instances,
                plant: instance.plants
            };
        } catch (error) {
            console.error('Failed to get plant instance by ID:', error);
            throw new Error('Failed to get plant instance');
        }
    }
    // Get all plant instances for a user
    static async getByUserId(userId, activeOnly = true) {
        try {
            const conditions = [
                (0, _drizzleorm.eq)(_schema.plantInstances.userId, userId)
            ];
            if (activeOnly) {
                conditions.push((0, _drizzleorm.eq)(_schema.plantInstances.isActive, true));
            }
            const instances = await _index.db.select().from(_schema.plantInstances).leftJoin(_schema.plants, (0, _drizzleorm.eq)(_schema.plantInstances.plantId, _schema.plants.id)).where((0, _drizzleorm.and)(...conditions)).orderBy((0, _drizzleorm.desc)(_schema.plantInstances.createdAt));
            return instances.map((instance)=>({
                    ...instance.plant_instances,
                    plant: instance.plants
                }));
        } catch (error) {
            console.error('Failed to get plant instances by user ID:', error);
            throw new Error('Failed to get plant instances');
        }
    }
    // Get plant instances with overdue fertilizer
    static async getOverdueFertilizer(userId) {
        try {
            const now = new Date();
            const instances = await _index.db.select().from(_schema.plantInstances).leftJoin(_schema.plants, (0, _drizzleorm.eq)(_schema.plantInstances.plantId, _schema.plants.id)).where((0, _drizzleorm.and)((0, _drizzleorm.eq)(_schema.plantInstances.userId, userId), (0, _drizzleorm.eq)(_schema.plantInstances.isActive, true), (0, _drizzleorm.isNotNull)(_schema.plantInstances.fertilizerDue), (0, _drizzleorm.lte)(_schema.plantInstances.fertilizerDue, now))).orderBy((0, _drizzleorm.asc)(_schema.plantInstances.fertilizerDue));
            return instances.map((instance)=>({
                    ...instance.plant_instances,
                    plant: instance.plants
                }));
        } catch (error) {
            console.error('Failed to get overdue fertilizer instances:', error);
            throw new Error('Failed to get overdue fertilizer instances');
        }
    }
    // Get plant instances with fertilizer due soon
    static async getFertilizerDueSoon(userId, daysAhead = 7) {
        try {
            const now = new Date();
            const futureDate = new Date();
            futureDate.setDate(now.getDate() + daysAhead);
            const instances = await _index.db.select().from(_schema.plantInstances).leftJoin(_schema.plants, (0, _drizzleorm.eq)(_schema.plantInstances.plantId, _schema.plants.id)).where((0, _drizzleorm.and)((0, _drizzleorm.eq)(_schema.plantInstances.userId, userId), (0, _drizzleorm.eq)(_schema.plantInstances.isActive, true), (0, _drizzleorm.isNotNull)(_schema.plantInstances.fertilizerDue), (0, _drizzleorm.gte)(_schema.plantInstances.fertilizerDue, now), (0, _drizzleorm.lte)(_schema.plantInstances.fertilizerDue, futureDate))).orderBy((0, _drizzleorm.asc)(_schema.plantInstances.fertilizerDue));
            return instances.map((instance)=>({
                    ...instance.plant_instances,
                    plant: instance.plants
                }));
        } catch (error) {
            console.error('Failed to get fertilizer due soon instances:', error);
            throw new Error('Failed to get fertilizer due soon instances');
        }
    }
    // Search plant instances by nickname, location, or notes
    static async search(userId, query) {
        try {
            const searchTerm = `%${query.toLowerCase()}%`;
            const instances = await _index.db.select().from(_schema.plantInstances).leftJoin(_schema.plants, (0, _drizzleorm.eq)(_schema.plantInstances.plantId, _schema.plants.id)).where((0, _drizzleorm.and)((0, _drizzleorm.eq)(_schema.plantInstances.userId, userId), (0, _drizzleorm.eq)(_schema.plantInstances.isActive, true), (0, _drizzleorm.or)((0, _drizzleorm.ilike)(_schema.plantInstances.nickname, searchTerm), (0, _drizzleorm.ilike)(_schema.plantInstances.location, searchTerm), (0, _drizzleorm.ilike)(_schema.plantInstances.notes, searchTerm), (0, _drizzleorm.ilike)(_schema.plants.commonName, searchTerm), (0, _drizzleorm.ilike)(_schema.plants.genus, searchTerm), (0, _drizzleorm.ilike)(_schema.plants.species, searchTerm)))).orderBy((0, _drizzleorm.desc)(_schema.plantInstances.createdAt));
            return instances.map((instance)=>({
                    ...instance.plant_instances,
                    plant: instance.plants
                }));
        } catch (error) {
            console.error('Failed to search plant instances:', error);
            throw new Error('Failed to search plant instances');
        }
    }
    // Update plant instance
    static async update(id, instanceData) {
        try {
            const [instance] = await _index.db.update(_schema.plantInstances).set({
                ...instanceData,
                updatedAt: new Date()
            }).where((0, _drizzleorm.eq)(_schema.plantInstances.id, id)).returning();
            if (!instance) {
                throw new Error('Plant instance not found');
            }
            return instance;
        } catch (error) {
            console.error('Failed to update plant instance:', error);
            throw new Error('Failed to update plant instance');
        }
    }
    // Log fertilizer application and calculate next due date
    static async logFertilizer(id, fertilizerDate) {
        try {
            const now = fertilizerDate || new Date();
            // Get current instance to calculate next due date
            const [currentInstance] = await _index.db.select().from(_schema.plantInstances).where((0, _drizzleorm.eq)(_schema.plantInstances.id, id));
            if (!currentInstance) {
                throw new Error('Plant instance not found');
            }
            // Calculate next fertilizer due date based on schedule
            let nextDue = null;
            if (currentInstance.fertilizerSchedule) {
                const scheduleMatch = currentInstance.fertilizerSchedule.match(/(\d+)\s*(day|week|month)s?/i);
                if (scheduleMatch) {
                    const [, amount, unit] = scheduleMatch;
                    nextDue = new Date(now);
                    switch(unit.toLowerCase()){
                        case 'day':
                            nextDue.setDate(nextDue.getDate() + parseInt(amount, 10));
                            break;
                        case 'week':
                            nextDue.setDate(nextDue.getDate() + parseInt(amount, 10) * 7);
                            break;
                        case 'month':
                            nextDue.setMonth(nextDue.getMonth() + parseInt(amount, 10));
                            break;
                    }
                }
            }
            const [instance] = await _index.db.update(_schema.plantInstances).set({
                lastFertilized: now,
                fertilizerDue: nextDue,
                updatedAt: new Date()
            }).where((0, _drizzleorm.eq)(_schema.plantInstances.id, id)).returning();
            return instance;
        } catch (error) {
            console.error('Failed to log fertilizer:', error);
            throw new Error('Failed to log fertilizer');
        }
    }
    // Log repotting
    static async logRepot(id, repotDate, notes) {
        try {
            const now = repotDate || new Date();
            const updateData = {
                lastRepot: now,
                updatedAt: new Date()
            };
            if (notes) {
                // Get current instance to append notes
                const [currentInstance] = await _index.db.select().from(_schema.plantInstances).where((0, _drizzleorm.eq)(_schema.plantInstances.id, id));
                if (currentInstance) {
                    const existingNotes = currentInstance.notes || '';
                    const repotNote = `Repotted on ${now.toDateString()}: ${notes}`;
                    updateData.notes = existingNotes ? `${existingNotes}\n${repotNote}` : repotNote;
                }
            }
            const [instance] = await _index.db.update(_schema.plantInstances).set(updateData).where((0, _drizzleorm.eq)(_schema.plantInstances.id, id)).returning();
            if (!instance) {
                throw new Error('Plant instance not found');
            }
            return instance;
        } catch (error) {
            console.error('Failed to log repot:', error);
            throw new Error('Failed to log repot');
        }
    }
    // Deactivate plant instance (soft delete)
    static async deactivate(id) {
        try {
            const [instance] = await _index.db.update(_schema.plantInstances).set({
                isActive: false,
                updatedAt: new Date()
            }).where((0, _drizzleorm.eq)(_schema.plantInstances.id, id)).returning();
            if (!instance) {
                throw new Error('Plant instance not found');
            }
            return instance;
        } catch (error) {
            console.error('Failed to deactivate plant instance:', error);
            throw new Error('Failed to deactivate plant instance');
        }
    }
    // Reactivate plant instance
    static async reactivate(id) {
        try {
            const [instance] = await _index.db.update(_schema.plantInstances).set({
                isActive: true,
                updatedAt: new Date()
            }).where((0, _drizzleorm.eq)(_schema.plantInstances.id, id)).returning();
            if (!instance) {
                throw new Error('Plant instance not found');
            }
            return instance;
        } catch (error) {
            console.error('Failed to reactivate plant instance:', error);
            throw new Error('Failed to reactivate plant instance');
        }
    }
    // Delete plant instance permanently
    static async delete(id) {
        try {
            const result = await _index.db.delete(_schema.plantInstances).where((0, _drizzleorm.eq)(_schema.plantInstances.id, id));
            return result.length > 0;
        } catch (error) {
            console.error('Failed to delete plant instance:', error);
            throw new Error('Failed to delete plant instance');
        }
    }
    // Get care statistics for a user
    static async getCareStats(userId) {
        try {
            const now = new Date();
            const weekFromNow = new Date();
            weekFromNow.setDate(now.getDate() + 7);
            const [stats] = await _index.db.select({
                totalPlants: (0, _drizzleorm.sql)`count(*)`,
                activePlants: (0, _drizzleorm.sql)`count(*) filter (where ${_schema.plantInstances.isActive} = true)`,
                overdueFertilizer: (0, _drizzleorm.sql)`count(*) filter (where ${_schema.plantInstances.isActive} = true and ${_schema.plantInstances.fertilizerDue} <= ${now})`,
                dueSoon: (0, _drizzleorm.sql)`count(*) filter (where ${_schema.plantInstances.isActive} = true and ${_schema.plantInstances.fertilizerDue} > ${now} and ${_schema.plantInstances.fertilizerDue} <= ${weekFromNow})`
            }).from(_schema.plantInstances).where((0, _drizzleorm.eq)(_schema.plantInstances.userId, userId));
            return stats;
        } catch (error) {
            console.error('Failed to get care stats:', error);
            throw new Error('Failed to get care stats');
        }
    }
    // Enhanced search with filters
    static async searchWithFilters(searchParams) {
        try {
            const startTime = Date.now();
            const { query, userId, activeOnly, limit, offset } = searchParams;
            const searchTerm = `%${query.toLowerCase()}%`;
            const conditions = [
                (0, _drizzleorm.eq)(_schema.plantInstances.userId, userId)
            ];
            if (activeOnly) {
                conditions.push((0, _drizzleorm.eq)(_schema.plantInstances.isActive, true));
            }
            // Add search conditions
            conditions.push((0, _drizzleorm.or)((0, _drizzleorm.ilike)(_schema.plantInstances.nickname, searchTerm), (0, _drizzleorm.ilike)(_schema.plantInstances.location, searchTerm), (0, _drizzleorm.ilike)(_schema.plantInstances.notes, searchTerm), (0, _drizzleorm.ilike)(_schema.plants.commonName, searchTerm), (0, _drizzleorm.ilike)(_schema.plants.genus, searchTerm), (0, _drizzleorm.ilike)(_schema.plants.species, searchTerm), (0, _drizzleorm.ilike)(_schema.plants.family, searchTerm)));
            // Get total count
            const [countResult] = await _index.db.select({
                count: (0, _drizzleorm.sql)`count(*)`
            }).from(_schema.plantInstances).leftJoin(_schema.plants, (0, _drizzleorm.eq)(_schema.plantInstances.plantId, _schema.plants.id)).where((0, _drizzleorm.and)(...conditions));
            const totalCount = countResult.count;
            // Get instances with plant data
            const instances = await _index.db.select().from(_schema.plantInstances).leftJoin(_schema.plants, (0, _drizzleorm.eq)(_schema.plantInstances.plantId, _schema.plants.id)).where((0, _drizzleorm.and)(...conditions)).orderBy((0, _drizzleorm.desc)(_schema.plantInstances.createdAt)).limit(limit).offset(offset);
            const enhancedInstances = instances.map((instance)=>_plantinstancetypes.plantInstanceHelpers.enhancePlantInstance(instance.plant_instances, instance.plants));
            const searchTime = Date.now() - startTime;
            return {
                instances: enhancedInstances,
                totalCount,
                hasMore: offset + limit < totalCount,
                searchTime,
                filters: {
                    ...searchParams,
                    overdueOnly: false
                }
            };
        } catch (error) {
            console.error('Failed to search plant instances with filters:', error);
            throw new Error('Failed to search plant instances');
        }
    }
    // Advanced filtering
    static async getWithFilters(filterParams) {
        try {
            const startTime = Date.now();
            const { userId, location, plantId, isActive, overdueOnly, dueSoonDays, createdAfter, createdBefore, lastFertilizedAfter, lastFertilizedBefore, limit, offset } = filterParams;
            const conditions = [
                (0, _drizzleorm.eq)(_schema.plantInstances.userId, userId)
            ];
            // Apply filters
            if (location) {
                conditions.push((0, _drizzleorm.ilike)(_schema.plantInstances.location, `%${location}%`));
            }
            if (plantId) {
                conditions.push((0, _drizzleorm.eq)(_schema.plantInstances.plantId, plantId));
            }
            if (isActive !== undefined) {
                conditions.push((0, _drizzleorm.eq)(_schema.plantInstances.isActive, isActive));
            }
            if (overdueOnly) {
                const now = new Date();
                conditions.push((0, _drizzleorm.and)((0, _drizzleorm.isNotNull)(_schema.plantInstances.fertilizerDue), (0, _drizzleorm.lte)(_schema.plantInstances.fertilizerDue, now)));
            }
            if (dueSoonDays) {
                const now = new Date();
                const futureDate = new Date();
                futureDate.setDate(now.getDate() + dueSoonDays);
                conditions.push((0, _drizzleorm.and)((0, _drizzleorm.isNotNull)(_schema.plantInstances.fertilizerDue), (0, _drizzleorm.gte)(_schema.plantInstances.fertilizerDue, now), (0, _drizzleorm.lte)(_schema.plantInstances.fertilizerDue, futureDate)));
            }
            if (createdAfter) {
                conditions.push((0, _drizzleorm.gte)(_schema.plantInstances.createdAt, createdAfter));
            }
            if (createdBefore) {
                conditions.push((0, _drizzleorm.lte)(_schema.plantInstances.createdAt, createdBefore));
            }
            if (lastFertilizedAfter) {
                conditions.push((0, _drizzleorm.and)((0, _drizzleorm.isNotNull)(_schema.plantInstances.lastFertilized), (0, _drizzleorm.gte)(_schema.plantInstances.lastFertilized, lastFertilizedAfter)));
            }
            if (lastFertilizedBefore) {
                conditions.push((0, _drizzleorm.and)((0, _drizzleorm.isNotNull)(_schema.plantInstances.lastFertilized), (0, _drizzleorm.lte)(_schema.plantInstances.lastFertilized, lastFertilizedBefore)));
            }
            // Get total count
            const [countResult] = await _index.db.select({
                count: (0, _drizzleorm.sql)`count(*)`
            }).from(_schema.plantInstances).leftJoin(_schema.plants, (0, _drizzleorm.eq)(_schema.plantInstances.plantId, _schema.plants.id)).where((0, _drizzleorm.and)(...conditions));
            const totalCount = countResult.count;
            // Get instances with plant data
            const instances = await _index.db.select().from(_schema.plantInstances).leftJoin(_schema.plants, (0, _drizzleorm.eq)(_schema.plantInstances.plantId, _schema.plants.id)).where((0, _drizzleorm.and)(...conditions)).orderBy(overdueOnly || dueSoonDays ? (0, _drizzleorm.asc)(_schema.plantInstances.fertilizerDue) : (0, _drizzleorm.desc)(_schema.plantInstances.createdAt)).limit(limit).offset(offset);
            const enhancedInstances = instances.map((instance)=>_plantinstancetypes.plantInstanceHelpers.enhancePlantInstance(instance.plant_instances, instance.plants));
            const searchTime = Date.now() - startTime;
            return {
                instances: enhancedInstances,
                totalCount,
                hasMore: offset + limit < totalCount,
                searchTime,
                filters: filterParams
            };
        } catch (error) {
            console.error('Failed to get plant instances with filters:', error);
            throw new Error('Failed to get plant instances with filters');
        }
    }
    // Get enhanced plant instances for a user
    static async getEnhancedByUserId(userId, activeOnly = true) {
        try {
            const conditions = [
                (0, _drizzleorm.eq)(_schema.plantInstances.userId, userId)
            ];
            if (activeOnly) {
                conditions.push((0, _drizzleorm.eq)(_schema.plantInstances.isActive, true));
            }
            const instances = await _index.db.select().from(_schema.plantInstances).leftJoin(_schema.plants, (0, _drizzleorm.eq)(_schema.plantInstances.plantId, _schema.plants.id)).where((0, _drizzleorm.and)(...conditions)).orderBy((0, _drizzleorm.desc)(_schema.plantInstances.createdAt));
            return instances.map((instance)=>_plantinstancetypes.plantInstanceHelpers.enhancePlantInstance(instance.plant_instances, instance.plants));
        } catch (error) {
            console.error('Failed to get enhanced plant instances:', error);
            throw new Error('Failed to get enhanced plant instances');
        }
    }
    // Get care dashboard data
    static async getCareDashboardData(userId) {
        try {
            const now = new Date();
            const tomorrow = new Date();
            tomorrow.setDate(now.getDate() + 1);
            const weekFromNow = new Date();
            weekFromNow.setDate(now.getDate() + 7);
            // Get all active instances with plant data
            const instances = await this.getEnhancedByUserId(userId, true);
            // Categorize by care status
            const overdue = instances.filter((instance)=>instance.careStatus === 'overdue');
            const dueToday = instances.filter((instance)=>instance.careStatus === 'due_today');
            const dueSoon = instances.filter((instance)=>instance.careStatus === 'due_soon');
            // Get recently cared for plants (fertilized in last 7 days)
            const recentlyCared = instances.filter((instance)=>{
                if (!instance.lastFertilized) return false;
                const daysSince = _plantinstancetypes.plantInstanceHelpers.calculateDaysSinceLastFertilized(instance.lastFertilized);
                return daysSince !== null && daysSince <= 7;
            });
            // Calculate care streak (consecutive days with care activity)
            const careStreakDays = await this.calculateCareStreak(userId);
            return {
                overdue: _plantinstancetypes.plantInstanceHelpers.sortByCareUrgency(overdue),
                dueToday: _plantinstancetypes.plantInstanceHelpers.sortByCareUrgency(dueToday),
                dueSoon: _plantinstancetypes.plantInstanceHelpers.sortByCareUrgency(dueSoon),
                recentlyCared,
                statistics: {
                    totalActivePlants: instances.length,
                    overdueCount: overdue.length,
                    dueTodayCount: dueToday.length,
                    dueSoonCount: dueSoon.length,
                    careStreakDays
                }
            };
        } catch (error) {
            console.error('Failed to get care dashboard data:', error);
            throw new Error('Failed to get care dashboard data');
        }
    }
    // Calculate care streak
    static async calculateCareStreak(userId) {
        try {
            // This is a simplified implementation
            // In a real app, you might want to track care events in a separate table
            const instances = await _index.db.select({
                lastFertilized: _schema.plantInstances.lastFertilized
            }).from(_schema.plantInstances).where((0, _drizzleorm.and)((0, _drizzleorm.eq)(_schema.plantInstances.userId, userId), (0, _drizzleorm.eq)(_schema.plantInstances.isActive, true), (0, _drizzleorm.isNotNull)(_schema.plantInstances.lastFertilized))).orderBy((0, _drizzleorm.desc)(_schema.plantInstances.lastFertilized));
            if (instances.length === 0) return 0;
            // Simple streak calculation based on recent fertilizer applications
            let streak = 0;
            const now = new Date();
            for (const instance of instances){
                if (!instance.lastFertilized) break;
                const daysSince = Math.floor((now.getTime() - instance.lastFertilized.getTime()) / (1000 * 60 * 60 * 24));
                if (daysSince <= 1) {
                    streak = Math.max(streak, 1);
                }
            }
            return streak;
        } catch (error) {
            console.error('Failed to calculate care streak:', error);
            return 0;
        }
    }
    // Bulk operations
    static async bulkOperation(operation) {
        try {
            const { plantInstanceIds, operation: op, fertilizerDate, notes } = operation;
            const results = [];
            let successCount = 0;
            let failureCount = 0;
            for (const id of plantInstanceIds){
                try {
                    let result;
                    switch(op){
                        case 'activate':
                            result = await this.reactivate(id);
                            break;
                        case 'deactivate':
                            result = await this.deactivate(id);
                            break;
                        case 'delete':
                            await this.delete(id);
                            result = {
                                id
                            }; // Placeholder for deleted item
                            break;
                        case 'fertilize':
                            result = await this.logFertilizer(id, fertilizerDate);
                            break;
                        default:
                            throw new Error(`Unknown operation: ${op}`);
                    }
                    results.push({
                        plantInstanceId: id,
                        success: true
                    });
                    successCount++;
                } catch (error) {
                    results.push({
                        plantInstanceId: id,
                        success: false,
                        error: error instanceof Error ? error.message : 'Unknown error'
                    });
                    failureCount++;
                }
            }
            return {
                success: successCount > 0,
                successCount,
                failureCount,
                results
            };
        } catch (error) {
            console.error('Failed to perform bulk operation:', error);
            throw new Error('Failed to perform bulk operation');
        }
    }
    // Get plant instances by location
    static async getByLocation(userId, location) {
        try {
            const instances = await _index.db.select().from(_schema.plantInstances).leftJoin(_schema.plants, (0, _drizzleorm.eq)(_schema.plantInstances.plantId, _schema.plants.id)).where((0, _drizzleorm.and)((0, _drizzleorm.eq)(_schema.plantInstances.userId, userId), (0, _drizzleorm.eq)(_schema.plantInstances.isActive, true), (0, _drizzleorm.ilike)(_schema.plantInstances.location, `%${location}%`))).orderBy(_schema.plantInstances.nickname);
            return instances.map((instance)=>_plantinstancetypes.plantInstanceHelpers.enhancePlantInstance(instance.plant_instances, instance.plants));
        } catch (error) {
            console.error('Failed to get plant instances by location:', error);
            throw new Error('Failed to get plant instances by location');
        }
    }
    // Get unique locations for a user
    static async getUserLocations(userId) {
        try {
            const locations = await _index.db.selectDistinct({
                location: _schema.plantInstances.location
            }).from(_schema.plantInstances).where((0, _drizzleorm.and)((0, _drizzleorm.eq)(_schema.plantInstances.userId, userId), (0, _drizzleorm.eq)(_schema.plantInstances.isActive, true))).orderBy(_schema.plantInstances.location);
            return locations.map((l)=>l.location).filter(Boolean);
        } catch (error) {
            console.error('Failed to get user locations:', error);
            throw new Error('Failed to get user locations');
        }
    }
    // Get enhanced plant instance by ID
    static async getEnhancedById(id) {
        try {
            const [instance] = await _index.db.select().from(_schema.plantInstances).leftJoin(_schema.plants, (0, _drizzleorm.eq)(_schema.plantInstances.plantId, _schema.plants.id)).where((0, _drizzleorm.eq)(_schema.plantInstances.id, id));
            if (!instance || !instance.plants) return null;
            return _plantinstancetypes.plantInstanceHelpers.enhancePlantInstance(instance.plant_instances, instance.plants);
        } catch (error) {
            console.error('Failed to get enhanced plant instance by ID:', error);
            throw new Error('Failed to get enhanced plant instance');
        }
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdGVmYW5iZWtrZXIvcHJvamVjdHMvZmFuY3ktcGxhbnRpZXMvc3JjL2xpYi9kYi9xdWVyaWVzL3BsYW50LWluc3RhbmNlcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBlcSwgYW5kLCBkZXNjLCBhc2MsIGlzTm90TnVsbCwgbHRlLCBndGUsIGlsaWtlLCBvciwgc3FsLCBpbkFycmF5IH0gZnJvbSAnZHJpenpsZS1vcm0nO1xuaW1wb3J0IHsgZGIgfSBmcm9tICcuLi9pbmRleCc7XG5pbXBvcnQgeyBwbGFudEluc3RhbmNlcywgcGxhbnRzLCB0eXBlIFBsYW50SW5zdGFuY2UsIHR5cGUgTmV3UGxhbnRJbnN0YW5jZSB9IGZyb20gJy4uL3NjaGVtYSc7XG5pbXBvcnQgdHlwZSB7IFxuICBQbGFudEluc3RhbmNlRmlsdGVyLCBcbiAgUGxhbnRJbnN0YW5jZVNlYXJjaCxcbiAgQnVsa1BsYW50SW5zdGFuY2VPcGVyYXRpb24gXG59IGZyb20gJ0AvbGliL3ZhbGlkYXRpb24vcGxhbnQtc2NoZW1hcyc7XG5pbXBvcnQgdHlwZSB7IFxuICBFbmhhbmNlZFBsYW50SW5zdGFuY2UsIFxuICBQbGFudEluc3RhbmNlU2VhcmNoUmVzdWx0LFxuICBDYXJlRGFzaGJvYXJkRGF0YSxcbiAgQnVsa09wZXJhdGlvblJlc3VsdCxcbiAgUGxhbnRJbnN0YW5jZU9wZXJhdGlvblJlc3VsdFxufSBmcm9tICdAL2xpYi90eXBlcy9wbGFudC1pbnN0YW5jZS10eXBlcyc7XG5pbXBvcnQgeyBwbGFudEluc3RhbmNlSGVscGVycyB9IGZyb20gJ0AvbGliL3R5cGVzL3BsYW50LWluc3RhbmNlLXR5cGVzJztcblxuLy8gUGxhbnQgaW5zdGFuY2UgQ1JVRCBvcGVyYXRpb25zXG5leHBvcnQgY2xhc3MgUGxhbnRJbnN0YW5jZVF1ZXJpZXMge1xuICAvLyBDcmVhdGUgYSBuZXcgcGxhbnQgaW5zdGFuY2VcbiAgc3RhdGljIGFzeW5jIGNyZWF0ZShpbnN0YW5jZURhdGE6IE5ld1BsYW50SW5zdGFuY2UpOiBQcm9taXNlPFBsYW50SW5zdGFuY2U+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgW2luc3RhbmNlXSA9IGF3YWl0IGRiLmluc2VydChwbGFudEluc3RhbmNlcykudmFsdWVzKGluc3RhbmNlRGF0YSkucmV0dXJuaW5nKCk7XG4gICAgICByZXR1cm4gaW5zdGFuY2U7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjcmVhdGUgcGxhbnQgaW5zdGFuY2U6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gY3JlYXRlIHBsYW50IGluc3RhbmNlJyk7XG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IHBsYW50IGluc3RhbmNlIGJ5IElEIHdpdGggcGxhbnQgdGF4b25vbXkgZGF0YVxuICBzdGF0aWMgYXN5bmMgZ2V0QnlJZChpZDogbnVtYmVyKTogUHJvbWlzZTwoUGxhbnRJbnN0YW5jZSAmIHsgcGxhbnQ6IHR5cGVvZiBwbGFudHMuJGluZmVyU2VsZWN0IH0pIHwgbnVsbD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBbaW5zdGFuY2VdID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKHBsYW50SW5zdGFuY2VzKVxuICAgICAgICAubGVmdEpvaW4ocGxhbnRzLCBlcShwbGFudEluc3RhbmNlcy5wbGFudElkLCBwbGFudHMuaWQpKVxuICAgICAgICAud2hlcmUoZXEocGxhbnRJbnN0YW5jZXMuaWQsIGlkKSk7XG4gICAgICBcbiAgICAgIGlmICghaW5zdGFuY2UpIHJldHVybiBudWxsO1xuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5pbnN0YW5jZS5wbGFudF9pbnN0YW5jZXMsXG4gICAgICAgIHBsYW50OiBpbnN0YW5jZS5wbGFudHMhXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZ2V0IHBsYW50IGluc3RhbmNlIGJ5IElEOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCBwbGFudCBpbnN0YW5jZScpO1xuICAgIH1cbiAgfVxuXG4gIC8vIEdldCBhbGwgcGxhbnQgaW5zdGFuY2VzIGZvciBhIHVzZXJcbiAgc3RhdGljIGFzeW5jIGdldEJ5VXNlcklkKHVzZXJJZDogbnVtYmVyLCBhY3RpdmVPbmx5OiBib29sZWFuID0gdHJ1ZSk6IFByb21pc2U8KFBsYW50SW5zdGFuY2UgJiB7IHBsYW50OiB0eXBlb2YgcGxhbnRzLiRpbmZlclNlbGVjdCB9KVtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvbmRpdGlvbnMgPSBbZXEocGxhbnRJbnN0YW5jZXMudXNlcklkLCB1c2VySWQpXTtcbiAgICAgIGlmIChhY3RpdmVPbmx5KSB7XG4gICAgICAgIGNvbmRpdGlvbnMucHVzaChlcShwbGFudEluc3RhbmNlcy5pc0FjdGl2ZSwgdHJ1ZSkpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBpbnN0YW5jZXMgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20ocGxhbnRJbnN0YW5jZXMpXG4gICAgICAgIC5sZWZ0Sm9pbihwbGFudHMsIGVxKHBsYW50SW5zdGFuY2VzLnBsYW50SWQsIHBsYW50cy5pZCkpXG4gICAgICAgIC53aGVyZShhbmQoLi4uY29uZGl0aW9ucykpXG4gICAgICAgIC5vcmRlckJ5KGRlc2MocGxhbnRJbnN0YW5jZXMuY3JlYXRlZEF0KSk7XG5cbiAgICAgIHJldHVybiBpbnN0YW5jZXMubWFwKGluc3RhbmNlID0+ICh7XG4gICAgICAgIC4uLmluc3RhbmNlLnBsYW50X2luc3RhbmNlcyxcbiAgICAgICAgcGxhbnQ6IGluc3RhbmNlLnBsYW50cyFcbiAgICAgIH0pKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCBwbGFudCBpbnN0YW5jZXMgYnkgdXNlciBJRDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBnZXQgcGxhbnQgaW5zdGFuY2VzJyk7XG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IHBsYW50IGluc3RhbmNlcyB3aXRoIG92ZXJkdWUgZmVydGlsaXplclxuICBzdGF0aWMgYXN5bmMgZ2V0T3ZlcmR1ZUZlcnRpbGl6ZXIodXNlcklkOiBudW1iZXIpOiBQcm9taXNlPChQbGFudEluc3RhbmNlICYgeyBwbGFudDogdHlwZW9mIHBsYW50cy4kaW5mZXJTZWxlY3QgfSlbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgY29uc3QgaW5zdGFuY2VzID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKHBsYW50SW5zdGFuY2VzKVxuICAgICAgICAubGVmdEpvaW4ocGxhbnRzLCBlcShwbGFudEluc3RhbmNlcy5wbGFudElkLCBwbGFudHMuaWQpKVxuICAgICAgICAud2hlcmUoXG4gICAgICAgICAgYW5kKFxuICAgICAgICAgICAgZXEocGxhbnRJbnN0YW5jZXMudXNlcklkLCB1c2VySWQpLFxuICAgICAgICAgICAgZXEocGxhbnRJbnN0YW5jZXMuaXNBY3RpdmUsIHRydWUpLFxuICAgICAgICAgICAgaXNOb3ROdWxsKHBsYW50SW5zdGFuY2VzLmZlcnRpbGl6ZXJEdWUpLFxuICAgICAgICAgICAgbHRlKHBsYW50SW5zdGFuY2VzLmZlcnRpbGl6ZXJEdWUsIG5vdylcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgICAgLm9yZGVyQnkoYXNjKHBsYW50SW5zdGFuY2VzLmZlcnRpbGl6ZXJEdWUpKTtcblxuICAgICAgcmV0dXJuIGluc3RhbmNlcy5tYXAoaW5zdGFuY2UgPT4gKHtcbiAgICAgICAgLi4uaW5zdGFuY2UucGxhbnRfaW5zdGFuY2VzLFxuICAgICAgICBwbGFudDogaW5zdGFuY2UucGxhbnRzIVxuICAgICAgfSkpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZ2V0IG92ZXJkdWUgZmVydGlsaXplciBpbnN0YW5jZXM6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IG92ZXJkdWUgZmVydGlsaXplciBpbnN0YW5jZXMnKTtcbiAgICB9XG4gIH1cblxuICAvLyBHZXQgcGxhbnQgaW5zdGFuY2VzIHdpdGggZmVydGlsaXplciBkdWUgc29vblxuICBzdGF0aWMgYXN5bmMgZ2V0RmVydGlsaXplckR1ZVNvb24odXNlcklkOiBudW1iZXIsIGRheXNBaGVhZDogbnVtYmVyID0gNyk6IFByb21pc2U8KFBsYW50SW5zdGFuY2UgJiB7IHBsYW50OiB0eXBlb2YgcGxhbnRzLiRpbmZlclNlbGVjdCB9KVtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICBjb25zdCBmdXR1cmVEYXRlID0gbmV3IERhdGUoKTtcbiAgICAgIGZ1dHVyZURhdGUuc2V0RGF0ZShub3cuZ2V0RGF0ZSgpICsgZGF5c0FoZWFkKTtcblxuICAgICAgY29uc3QgaW5zdGFuY2VzID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKHBsYW50SW5zdGFuY2VzKVxuICAgICAgICAubGVmdEpvaW4ocGxhbnRzLCBlcShwbGFudEluc3RhbmNlcy5wbGFudElkLCBwbGFudHMuaWQpKVxuICAgICAgICAud2hlcmUoXG4gICAgICAgICAgYW5kKFxuICAgICAgICAgICAgZXEocGxhbnRJbnN0YW5jZXMudXNlcklkLCB1c2VySWQpLFxuICAgICAgICAgICAgZXEocGxhbnRJbnN0YW5jZXMuaXNBY3RpdmUsIHRydWUpLFxuICAgICAgICAgICAgaXNOb3ROdWxsKHBsYW50SW5zdGFuY2VzLmZlcnRpbGl6ZXJEdWUpLFxuICAgICAgICAgICAgZ3RlKHBsYW50SW5zdGFuY2VzLmZlcnRpbGl6ZXJEdWUsIG5vdyksXG4gICAgICAgICAgICBsdGUocGxhbnRJbnN0YW5jZXMuZmVydGlsaXplckR1ZSwgZnV0dXJlRGF0ZSlcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgICAgLm9yZGVyQnkoYXNjKHBsYW50SW5zdGFuY2VzLmZlcnRpbGl6ZXJEdWUpKTtcblxuICAgICAgcmV0dXJuIGluc3RhbmNlcy5tYXAoaW5zdGFuY2UgPT4gKHtcbiAgICAgICAgLi4uaW5zdGFuY2UucGxhbnRfaW5zdGFuY2VzLFxuICAgICAgICBwbGFudDogaW5zdGFuY2UucGxhbnRzIVxuICAgICAgfSkpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZ2V0IGZlcnRpbGl6ZXIgZHVlIHNvb24gaW5zdGFuY2VzOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCBmZXJ0aWxpemVyIGR1ZSBzb29uIGluc3RhbmNlcycpO1xuICAgIH1cbiAgfVxuXG4gIC8vIFNlYXJjaCBwbGFudCBpbnN0YW5jZXMgYnkgbmlja25hbWUsIGxvY2F0aW9uLCBvciBub3Rlc1xuICBzdGF0aWMgYXN5bmMgc2VhcmNoKHVzZXJJZDogbnVtYmVyLCBxdWVyeTogc3RyaW5nKTogUHJvbWlzZTwoUGxhbnRJbnN0YW5jZSAmIHsgcGxhbnQ6IHR5cGVvZiBwbGFudHMuJGluZmVyU2VsZWN0IH0pW10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2VhcmNoVGVybSA9IGAlJHtxdWVyeS50b0xvd2VyQ2FzZSgpfSVgO1xuICAgICAgXG4gICAgICBjb25zdCBpbnN0YW5jZXMgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20ocGxhbnRJbnN0YW5jZXMpXG4gICAgICAgIC5sZWZ0Sm9pbihwbGFudHMsIGVxKHBsYW50SW5zdGFuY2VzLnBsYW50SWQsIHBsYW50cy5pZCkpXG4gICAgICAgIC53aGVyZShcbiAgICAgICAgICBhbmQoXG4gICAgICAgICAgICBlcShwbGFudEluc3RhbmNlcy51c2VySWQsIHVzZXJJZCksXG4gICAgICAgICAgICBlcShwbGFudEluc3RhbmNlcy5pc0FjdGl2ZSwgdHJ1ZSksXG4gICAgICAgICAgICBvcihcbiAgICAgICAgICAgICAgaWxpa2UocGxhbnRJbnN0YW5jZXMubmlja25hbWUsIHNlYXJjaFRlcm0pLFxuICAgICAgICAgICAgICBpbGlrZShwbGFudEluc3RhbmNlcy5sb2NhdGlvbiwgc2VhcmNoVGVybSksXG4gICAgICAgICAgICAgIGlsaWtlKHBsYW50SW5zdGFuY2VzLm5vdGVzLCBzZWFyY2hUZXJtKSxcbiAgICAgICAgICAgICAgaWxpa2UocGxhbnRzLmNvbW1vbk5hbWUsIHNlYXJjaFRlcm0pLFxuICAgICAgICAgICAgICBpbGlrZShwbGFudHMuZ2VudXMsIHNlYXJjaFRlcm0pLFxuICAgICAgICAgICAgICBpbGlrZShwbGFudHMuc3BlY2llcywgc2VhcmNoVGVybSlcbiAgICAgICAgICAgIClcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgICAgLm9yZGVyQnkoZGVzYyhwbGFudEluc3RhbmNlcy5jcmVhdGVkQXQpKTtcblxuICAgICAgcmV0dXJuIGluc3RhbmNlcy5tYXAoaW5zdGFuY2UgPT4gKHtcbiAgICAgICAgLi4uaW5zdGFuY2UucGxhbnRfaW5zdGFuY2VzLFxuICAgICAgICBwbGFudDogaW5zdGFuY2UucGxhbnRzIVxuICAgICAgfSkpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2VhcmNoIHBsYW50IGluc3RhbmNlczonLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBzZWFyY2ggcGxhbnQgaW5zdGFuY2VzJyk7XG4gICAgfVxuICB9XG5cbiAgLy8gVXBkYXRlIHBsYW50IGluc3RhbmNlXG4gIHN0YXRpYyBhc3luYyB1cGRhdGUoaWQ6IG51bWJlciwgaW5zdGFuY2VEYXRhOiBQYXJ0aWFsPE5ld1BsYW50SW5zdGFuY2U+KTogUHJvbWlzZTxQbGFudEluc3RhbmNlPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IFtpbnN0YW5jZV0gPSBhd2FpdCBkYlxuICAgICAgICAudXBkYXRlKHBsYW50SW5zdGFuY2VzKVxuICAgICAgICAuc2V0KHsgLi4uaW5zdGFuY2VEYXRhLCB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkgfSlcbiAgICAgICAgLndoZXJlKGVxKHBsYW50SW5zdGFuY2VzLmlkLCBpZCkpXG4gICAgICAgIC5yZXR1cm5pbmcoKTtcbiAgICAgIFxuICAgICAgaWYgKCFpbnN0YW5jZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BsYW50IGluc3RhbmNlIG5vdCBmb3VuZCcpO1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaW5zdGFuY2U7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byB1cGRhdGUgcGxhbnQgaW5zdGFuY2U6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gdXBkYXRlIHBsYW50IGluc3RhbmNlJyk7XG4gICAgfVxuICB9XG5cbiAgLy8gTG9nIGZlcnRpbGl6ZXIgYXBwbGljYXRpb24gYW5kIGNhbGN1bGF0ZSBuZXh0IGR1ZSBkYXRlXG4gIHN0YXRpYyBhc3luYyBsb2dGZXJ0aWxpemVyKGlkOiBudW1iZXIsIGZlcnRpbGl6ZXJEYXRlPzogRGF0ZSk6IFByb21pc2U8UGxhbnRJbnN0YW5jZT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBub3cgPSBmZXJ0aWxpemVyRGF0ZSB8fCBuZXcgRGF0ZSgpO1xuICAgICAgXG4gICAgICAvLyBHZXQgY3VycmVudCBpbnN0YW5jZSB0byBjYWxjdWxhdGUgbmV4dCBkdWUgZGF0ZVxuICAgICAgY29uc3QgW2N1cnJlbnRJbnN0YW5jZV0gPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20ocGxhbnRJbnN0YW5jZXMpXG4gICAgICAgIC53aGVyZShlcShwbGFudEluc3RhbmNlcy5pZCwgaWQpKTtcbiAgICAgIFxuICAgICAgaWYgKCFjdXJyZW50SW5zdGFuY2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQbGFudCBpbnN0YW5jZSBub3QgZm91bmQnKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2FsY3VsYXRlIG5leHQgZmVydGlsaXplciBkdWUgZGF0ZSBiYXNlZCBvbiBzY2hlZHVsZVxuICAgICAgbGV0IG5leHREdWU6IERhdGUgfCBudWxsID0gbnVsbDtcbiAgICAgIGlmIChjdXJyZW50SW5zdGFuY2UuZmVydGlsaXplclNjaGVkdWxlKSB7XG4gICAgICAgIGNvbnN0IHNjaGVkdWxlTWF0Y2ggPSBjdXJyZW50SW5zdGFuY2UuZmVydGlsaXplclNjaGVkdWxlLm1hdGNoKC8oXFxkKylcXHMqKGRheXx3ZWVrfG1vbnRoKXM/L2kpO1xuICAgICAgICBpZiAoc2NoZWR1bGVNYXRjaCkge1xuICAgICAgICAgIGNvbnN0IFssIGFtb3VudCwgdW5pdF0gPSBzY2hlZHVsZU1hdGNoO1xuICAgICAgICAgIG5leHREdWUgPSBuZXcgRGF0ZShub3cpO1xuICAgICAgICAgIFxuICAgICAgICAgIHN3aXRjaCAodW5pdC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBjYXNlICdkYXknOlxuICAgICAgICAgICAgICBuZXh0RHVlLnNldERhdGUobmV4dER1ZS5nZXREYXRlKCkgKyBwYXJzZUludChhbW91bnQsIDEwKSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnd2Vlayc6XG4gICAgICAgICAgICAgIG5leHREdWUuc2V0RGF0ZShuZXh0RHVlLmdldERhdGUoKSArIChwYXJzZUludChhbW91bnQsIDEwKSAqIDcpKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdtb250aCc6XG4gICAgICAgICAgICAgIG5leHREdWUuc2V0TW9udGgobmV4dER1ZS5nZXRNb250aCgpICsgcGFyc2VJbnQoYW1vdW50LCAxMCkpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgW2luc3RhbmNlXSA9IGF3YWl0IGRiXG4gICAgICAgIC51cGRhdGUocGxhbnRJbnN0YW5jZXMpXG4gICAgICAgIC5zZXQoe1xuICAgICAgICAgIGxhc3RGZXJ0aWxpemVkOiBub3csXG4gICAgICAgICAgZmVydGlsaXplckR1ZTogbmV4dER1ZSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgICAgfSlcbiAgICAgICAgLndoZXJlKGVxKHBsYW50SW5zdGFuY2VzLmlkLCBpZCkpXG4gICAgICAgIC5yZXR1cm5pbmcoKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIGluc3RhbmNlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9nIGZlcnRpbGl6ZXI6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gbG9nIGZlcnRpbGl6ZXInKTtcbiAgICB9XG4gIH1cblxuICAvLyBMb2cgcmVwb3R0aW5nXG4gIHN0YXRpYyBhc3luYyBsb2dSZXBvdChpZDogbnVtYmVyLCByZXBvdERhdGU/OiBEYXRlLCBub3Rlcz86IHN0cmluZyk6IFByb21pc2U8UGxhbnRJbnN0YW5jZT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBub3cgPSByZXBvdERhdGUgfHwgbmV3IERhdGUoKTtcbiAgICAgIFxuICAgICAgY29uc3QgdXBkYXRlRGF0YTogUGFydGlhbDxOZXdQbGFudEluc3RhbmNlPiA9IHtcbiAgICAgICAgbGFzdFJlcG90OiBub3csXG4gICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgICAgfTtcblxuICAgICAgaWYgKG5vdGVzKSB7XG4gICAgICAgIC8vIEdldCBjdXJyZW50IGluc3RhbmNlIHRvIGFwcGVuZCBub3Rlc1xuICAgICAgICBjb25zdCBbY3VycmVudEluc3RhbmNlXSA9IGF3YWl0IGRiXG4gICAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgICAgLmZyb20ocGxhbnRJbnN0YW5jZXMpXG4gICAgICAgICAgLndoZXJlKGVxKHBsYW50SW5zdGFuY2VzLmlkLCBpZCkpO1xuICAgICAgICBcbiAgICAgICAgaWYgKGN1cnJlbnRJbnN0YW5jZSkge1xuICAgICAgICAgIGNvbnN0IGV4aXN0aW5nTm90ZXMgPSBjdXJyZW50SW5zdGFuY2Uubm90ZXMgfHwgJyc7XG4gICAgICAgICAgY29uc3QgcmVwb3ROb3RlID0gYFJlcG90dGVkIG9uICR7bm93LnRvRGF0ZVN0cmluZygpfTogJHtub3Rlc31gO1xuICAgICAgICAgIHVwZGF0ZURhdGEubm90ZXMgPSBleGlzdGluZ05vdGVzID8gYCR7ZXhpc3RpbmdOb3Rlc31cXG4ke3JlcG90Tm90ZX1gIDogcmVwb3ROb3RlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IFtpbnN0YW5jZV0gPSBhd2FpdCBkYlxuICAgICAgICAudXBkYXRlKHBsYW50SW5zdGFuY2VzKVxuICAgICAgICAuc2V0KHVwZGF0ZURhdGEpXG4gICAgICAgIC53aGVyZShlcShwbGFudEluc3RhbmNlcy5pZCwgaWQpKVxuICAgICAgICAucmV0dXJuaW5nKCk7XG4gICAgICBcbiAgICAgIGlmICghaW5zdGFuY2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQbGFudCBpbnN0YW5jZSBub3QgZm91bmQnKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGluc3RhbmNlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9nIHJlcG90OicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGxvZyByZXBvdCcpO1xuICAgIH1cbiAgfVxuXG4gIC8vIERlYWN0aXZhdGUgcGxhbnQgaW5zdGFuY2UgKHNvZnQgZGVsZXRlKVxuICBzdGF0aWMgYXN5bmMgZGVhY3RpdmF0ZShpZDogbnVtYmVyKTogUHJvbWlzZTxQbGFudEluc3RhbmNlPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IFtpbnN0YW5jZV0gPSBhd2FpdCBkYlxuICAgICAgICAudXBkYXRlKHBsYW50SW5zdGFuY2VzKVxuICAgICAgICAuc2V0KHsgaXNBY3RpdmU6IGZhbHNlLCB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkgfSlcbiAgICAgICAgLndoZXJlKGVxKHBsYW50SW5zdGFuY2VzLmlkLCBpZCkpXG4gICAgICAgIC5yZXR1cm5pbmcoKTtcbiAgICAgIFxuICAgICAgaWYgKCFpbnN0YW5jZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BsYW50IGluc3RhbmNlIG5vdCBmb3VuZCcpO1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaW5zdGFuY2U7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBkZWFjdGl2YXRlIHBsYW50IGluc3RhbmNlOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGRlYWN0aXZhdGUgcGxhbnQgaW5zdGFuY2UnKTtcbiAgICB9XG4gIH1cblxuICAvLyBSZWFjdGl2YXRlIHBsYW50IGluc3RhbmNlXG4gIHN0YXRpYyBhc3luYyByZWFjdGl2YXRlKGlkOiBudW1iZXIpOiBQcm9taXNlPFBsYW50SW5zdGFuY2U+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgW2luc3RhbmNlXSA9IGF3YWl0IGRiXG4gICAgICAgIC51cGRhdGUocGxhbnRJbnN0YW5jZXMpXG4gICAgICAgIC5zZXQoeyBpc0FjdGl2ZTogdHJ1ZSwgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpIH0pXG4gICAgICAgIC53aGVyZShlcShwbGFudEluc3RhbmNlcy5pZCwgaWQpKVxuICAgICAgICAucmV0dXJuaW5nKCk7XG4gICAgICBcbiAgICAgIGlmICghaW5zdGFuY2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQbGFudCBpbnN0YW5jZSBub3QgZm91bmQnKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIGluc3RhbmNlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcmVhY3RpdmF0ZSBwbGFudCBpbnN0YW5jZTonLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byByZWFjdGl2YXRlIHBsYW50IGluc3RhbmNlJyk7XG4gICAgfVxuICB9XG5cbiAgLy8gRGVsZXRlIHBsYW50IGluc3RhbmNlIHBlcm1hbmVudGx5XG4gIHN0YXRpYyBhc3luYyBkZWxldGUoaWQ6IG51bWJlcik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5kZWxldGUocGxhbnRJbnN0YW5jZXMpLndoZXJlKGVxKHBsYW50SW5zdGFuY2VzLmlkLCBpZCkpO1xuICAgICAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZGVsZXRlIHBsYW50IGluc3RhbmNlOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGRlbGV0ZSBwbGFudCBpbnN0YW5jZScpO1xuICAgIH1cbiAgfVxuXG4gIC8vIEdldCBjYXJlIHN0YXRpc3RpY3MgZm9yIGEgdXNlclxuICBzdGF0aWMgYXN5bmMgZ2V0Q2FyZVN0YXRzKHVzZXJJZDogbnVtYmVyKTogUHJvbWlzZTx7XG4gICAgdG90YWxQbGFudHM6IG51bWJlcjtcbiAgICBhY3RpdmVQbGFudHM6IG51bWJlcjtcbiAgICBvdmVyZHVlRmVydGlsaXplcjogbnVtYmVyO1xuICAgIGR1ZVNvb246IG51bWJlcjtcbiAgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgY29uc3Qgd2Vla0Zyb21Ob3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgd2Vla0Zyb21Ob3cuc2V0RGF0ZShub3cuZ2V0RGF0ZSgpICsgNyk7XG5cbiAgICAgIGNvbnN0IFtzdGF0c10gPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KHtcbiAgICAgICAgICB0b3RhbFBsYW50czogc3FsPG51bWJlcj5gY291bnQoKilgLFxuICAgICAgICAgIGFjdGl2ZVBsYW50czogc3FsPG51bWJlcj5gY291bnQoKikgZmlsdGVyICh3aGVyZSAke3BsYW50SW5zdGFuY2VzLmlzQWN0aXZlfSA9IHRydWUpYCxcbiAgICAgICAgICBvdmVyZHVlRmVydGlsaXplcjogc3FsPG51bWJlcj5gY291bnQoKikgZmlsdGVyICh3aGVyZSAke3BsYW50SW5zdGFuY2VzLmlzQWN0aXZlfSA9IHRydWUgYW5kICR7cGxhbnRJbnN0YW5jZXMuZmVydGlsaXplckR1ZX0gPD0gJHtub3d9KWAsXG4gICAgICAgICAgZHVlU29vbjogc3FsPG51bWJlcj5gY291bnQoKikgZmlsdGVyICh3aGVyZSAke3BsYW50SW5zdGFuY2VzLmlzQWN0aXZlfSA9IHRydWUgYW5kICR7cGxhbnRJbnN0YW5jZXMuZmVydGlsaXplckR1ZX0gPiAke25vd30gYW5kICR7cGxhbnRJbnN0YW5jZXMuZmVydGlsaXplckR1ZX0gPD0gJHt3ZWVrRnJvbU5vd30pYFxuICAgICAgICB9KVxuICAgICAgICAuZnJvbShwbGFudEluc3RhbmNlcylcbiAgICAgICAgLndoZXJlKGVxKHBsYW50SW5zdGFuY2VzLnVzZXJJZCwgdXNlcklkKSk7XG5cbiAgICAgIHJldHVybiBzdGF0cztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCBjYXJlIHN0YXRzOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCBjYXJlIHN0YXRzJyk7XG4gICAgfVxuICB9XG5cbiAgLy8gRW5oYW5jZWQgc2VhcmNoIHdpdGggZmlsdGVyc1xuICBzdGF0aWMgYXN5bmMgc2VhcmNoV2l0aEZpbHRlcnMoc2VhcmNoUGFyYW1zOiBQbGFudEluc3RhbmNlU2VhcmNoKTogUHJvbWlzZTxQbGFudEluc3RhbmNlU2VhcmNoUmVzdWx0PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCB7IHF1ZXJ5LCB1c2VySWQsIGFjdGl2ZU9ubHksIGxpbWl0LCBvZmZzZXQgfSA9IHNlYXJjaFBhcmFtcztcbiAgICAgIGNvbnN0IHNlYXJjaFRlcm0gPSBgJSR7cXVlcnkudG9Mb3dlckNhc2UoKX0lYDtcbiAgICAgIFxuICAgICAgY29uc3QgY29uZGl0aW9ucyA9IFtlcShwbGFudEluc3RhbmNlcy51c2VySWQsIHVzZXJJZCldO1xuICAgICAgXG4gICAgICBpZiAoYWN0aXZlT25seSkge1xuICAgICAgICBjb25kaXRpb25zLnB1c2goZXEocGxhbnRJbnN0YW5jZXMuaXNBY3RpdmUsIHRydWUpKTtcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIHNlYXJjaCBjb25kaXRpb25zXG4gICAgICBjb25kaXRpb25zLnB1c2goXG4gICAgICAgIG9yKFxuICAgICAgICAgIGlsaWtlKHBsYW50SW5zdGFuY2VzLm5pY2tuYW1lLCBzZWFyY2hUZXJtKSxcbiAgICAgICAgICBpbGlrZShwbGFudEluc3RhbmNlcy5sb2NhdGlvbiwgc2VhcmNoVGVybSksXG4gICAgICAgICAgaWxpa2UocGxhbnRJbnN0YW5jZXMubm90ZXMsIHNlYXJjaFRlcm0pLFxuICAgICAgICAgIGlsaWtlKHBsYW50cy5jb21tb25OYW1lLCBzZWFyY2hUZXJtKSxcbiAgICAgICAgICBpbGlrZShwbGFudHMuZ2VudXMsIHNlYXJjaFRlcm0pLFxuICAgICAgICAgIGlsaWtlKHBsYW50cy5zcGVjaWVzLCBzZWFyY2hUZXJtKSxcbiAgICAgICAgICBpbGlrZShwbGFudHMuZmFtaWx5LCBzZWFyY2hUZXJtKVxuICAgICAgICApIVxuICAgICAgKTtcblxuICAgICAgLy8gR2V0IHRvdGFsIGNvdW50XG4gICAgICBjb25zdCBbY291bnRSZXN1bHRdID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCh7IGNvdW50OiBzcWw8bnVtYmVyPmBjb3VudCgqKWAgfSlcbiAgICAgICAgLmZyb20ocGxhbnRJbnN0YW5jZXMpXG4gICAgICAgIC5sZWZ0Sm9pbihwbGFudHMsIGVxKHBsYW50SW5zdGFuY2VzLnBsYW50SWQsIHBsYW50cy5pZCkpXG4gICAgICAgIC53aGVyZShhbmQoLi4uY29uZGl0aW9ucykpO1xuXG4gICAgICBjb25zdCB0b3RhbENvdW50ID0gY291bnRSZXN1bHQuY291bnQ7XG5cbiAgICAgIC8vIEdldCBpbnN0YW5jZXMgd2l0aCBwbGFudCBkYXRhXG4gICAgICBjb25zdCBpbnN0YW5jZXMgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20ocGxhbnRJbnN0YW5jZXMpXG4gICAgICAgIC5sZWZ0Sm9pbihwbGFudHMsIGVxKHBsYW50SW5zdGFuY2VzLnBsYW50SWQsIHBsYW50cy5pZCkpXG4gICAgICAgIC53aGVyZShhbmQoLi4uY29uZGl0aW9ucykpXG4gICAgICAgIC5vcmRlckJ5KGRlc2MocGxhbnRJbnN0YW5jZXMuY3JlYXRlZEF0KSlcbiAgICAgICAgLmxpbWl0KGxpbWl0KVxuICAgICAgICAub2Zmc2V0KG9mZnNldCk7XG5cbiAgICAgIGNvbnN0IGVuaGFuY2VkSW5zdGFuY2VzID0gaW5zdGFuY2VzLm1hcChpbnN0YW5jZSA9PiBcbiAgICAgICAgcGxhbnRJbnN0YW5jZUhlbHBlcnMuZW5oYW5jZVBsYW50SW5zdGFuY2UoaW5zdGFuY2UucGxhbnRfaW5zdGFuY2VzLCBpbnN0YW5jZS5wbGFudHMhKVxuICAgICAgKTtcblxuICAgICAgY29uc3Qgc2VhcmNoVGltZSA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGluc3RhbmNlczogZW5oYW5jZWRJbnN0YW5jZXMsXG4gICAgICAgIHRvdGFsQ291bnQsXG4gICAgICAgIGhhc01vcmU6IG9mZnNldCArIGxpbWl0IDwgdG90YWxDb3VudCxcbiAgICAgICAgc2VhcmNoVGltZSxcbiAgICAgICAgZmlsdGVyczoge1xuICAgICAgICAgIC4uLnNlYXJjaFBhcmFtcyxcbiAgICAgICAgICBvdmVyZHVlT25seTogZmFsc2UsIC8vIEFkZCBtaXNzaW5nIGZpZWxkXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2VhcmNoIHBsYW50IGluc3RhbmNlcyB3aXRoIGZpbHRlcnM6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gc2VhcmNoIHBsYW50IGluc3RhbmNlcycpO1xuICAgIH1cbiAgfVxuXG4gIC8vIEFkdmFuY2VkIGZpbHRlcmluZ1xuICBzdGF0aWMgYXN5bmMgZ2V0V2l0aEZpbHRlcnMoZmlsdGVyUGFyYW1zOiBQbGFudEluc3RhbmNlRmlsdGVyKTogUHJvbWlzZTxQbGFudEluc3RhbmNlU2VhcmNoUmVzdWx0PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCB7IFxuICAgICAgICB1c2VySWQsIFxuICAgICAgICBsb2NhdGlvbiwgXG4gICAgICAgIHBsYW50SWQsIFxuICAgICAgICBpc0FjdGl2ZSwgXG4gICAgICAgIG92ZXJkdWVPbmx5LCBcbiAgICAgICAgZHVlU29vbkRheXMsXG4gICAgICAgIGNyZWF0ZWRBZnRlcixcbiAgICAgICAgY3JlYXRlZEJlZm9yZSxcbiAgICAgICAgbGFzdEZlcnRpbGl6ZWRBZnRlcixcbiAgICAgICAgbGFzdEZlcnRpbGl6ZWRCZWZvcmUsXG4gICAgICAgIGxpbWl0LCBcbiAgICAgICAgb2Zmc2V0IFxuICAgICAgfSA9IGZpbHRlclBhcmFtcztcblxuICAgICAgY29uc3QgY29uZGl0aW9ucyA9IFtlcShwbGFudEluc3RhbmNlcy51c2VySWQsIHVzZXJJZCldO1xuICAgICAgXG4gICAgICAvLyBBcHBseSBmaWx0ZXJzXG4gICAgICBpZiAobG9jYXRpb24pIHtcbiAgICAgICAgY29uZGl0aW9ucy5wdXNoKGlsaWtlKHBsYW50SW5zdGFuY2VzLmxvY2F0aW9uLCBgJSR7bG9jYXRpb259JWApKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKHBsYW50SWQpIHtcbiAgICAgICAgY29uZGl0aW9ucy5wdXNoKGVxKHBsYW50SW5zdGFuY2VzLnBsYW50SWQsIHBsYW50SWQpKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGlzQWN0aXZlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29uZGl0aW9ucy5wdXNoKGVxKHBsYW50SW5zdGFuY2VzLmlzQWN0aXZlLCBpc0FjdGl2ZSkpO1xuICAgICAgfVxuXG4gICAgICBpZiAob3ZlcmR1ZU9ubHkpIHtcbiAgICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgICAgICAgY29uZGl0aW9ucy5wdXNoKFxuICAgICAgICAgIGFuZChcbiAgICAgICAgICAgIGlzTm90TnVsbChwbGFudEluc3RhbmNlcy5mZXJ0aWxpemVyRHVlKSxcbiAgICAgICAgICAgIGx0ZShwbGFudEluc3RhbmNlcy5mZXJ0aWxpemVyRHVlLCBub3cpXG4gICAgICAgICAgKSFcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGR1ZVNvb25EYXlzKSB7XG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGNvbnN0IGZ1dHVyZURhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBmdXR1cmVEYXRlLnNldERhdGUobm93LmdldERhdGUoKSArIGR1ZVNvb25EYXlzKTtcbiAgICAgICAgY29uZGl0aW9ucy5wdXNoKFxuICAgICAgICAgIGFuZChcbiAgICAgICAgICAgIGlzTm90TnVsbChwbGFudEluc3RhbmNlcy5mZXJ0aWxpemVyRHVlKSxcbiAgICAgICAgICAgIGd0ZShwbGFudEluc3RhbmNlcy5mZXJ0aWxpemVyRHVlLCBub3cpLFxuICAgICAgICAgICAgbHRlKHBsYW50SW5zdGFuY2VzLmZlcnRpbGl6ZXJEdWUsIGZ1dHVyZURhdGUpXG4gICAgICAgICAgKSFcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGNyZWF0ZWRBZnRlcikge1xuICAgICAgICBjb25kaXRpb25zLnB1c2goZ3RlKHBsYW50SW5zdGFuY2VzLmNyZWF0ZWRBdCwgY3JlYXRlZEFmdGVyKSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChjcmVhdGVkQmVmb3JlKSB7XG4gICAgICAgIGNvbmRpdGlvbnMucHVzaChsdGUocGxhbnRJbnN0YW5jZXMuY3JlYXRlZEF0LCBjcmVhdGVkQmVmb3JlKSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChsYXN0RmVydGlsaXplZEFmdGVyKSB7XG4gICAgICAgIGNvbmRpdGlvbnMucHVzaChcbiAgICAgICAgICBhbmQoXG4gICAgICAgICAgICBpc05vdE51bGwocGxhbnRJbnN0YW5jZXMubGFzdEZlcnRpbGl6ZWQpLFxuICAgICAgICAgICAgZ3RlKHBsYW50SW5zdGFuY2VzLmxhc3RGZXJ0aWxpemVkLCBsYXN0RmVydGlsaXplZEFmdGVyKVxuICAgICAgICAgICkhXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGlmIChsYXN0RmVydGlsaXplZEJlZm9yZSkge1xuICAgICAgICBjb25kaXRpb25zLnB1c2goXG4gICAgICAgICAgYW5kKFxuICAgICAgICAgICAgaXNOb3ROdWxsKHBsYW50SW5zdGFuY2VzLmxhc3RGZXJ0aWxpemVkKSxcbiAgICAgICAgICAgIGx0ZShwbGFudEluc3RhbmNlcy5sYXN0RmVydGlsaXplZCwgbGFzdEZlcnRpbGl6ZWRCZWZvcmUpXG4gICAgICAgICAgKSFcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgLy8gR2V0IHRvdGFsIGNvdW50XG4gICAgICBjb25zdCBbY291bnRSZXN1bHRdID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCh7IGNvdW50OiBzcWw8bnVtYmVyPmBjb3VudCgqKWAgfSlcbiAgICAgICAgLmZyb20ocGxhbnRJbnN0YW5jZXMpXG4gICAgICAgIC5sZWZ0Sm9pbihwbGFudHMsIGVxKHBsYW50SW5zdGFuY2VzLnBsYW50SWQsIHBsYW50cy5pZCkpXG4gICAgICAgIC53aGVyZShhbmQoLi4uY29uZGl0aW9ucykpO1xuXG4gICAgICBjb25zdCB0b3RhbENvdW50ID0gY291bnRSZXN1bHQuY291bnQ7XG5cbiAgICAgIC8vIEdldCBpbnN0YW5jZXMgd2l0aCBwbGFudCBkYXRhXG4gICAgICBjb25zdCBpbnN0YW5jZXMgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20ocGxhbnRJbnN0YW5jZXMpXG4gICAgICAgIC5sZWZ0Sm9pbihwbGFudHMsIGVxKHBsYW50SW5zdGFuY2VzLnBsYW50SWQsIHBsYW50cy5pZCkpXG4gICAgICAgIC53aGVyZShhbmQoLi4uY29uZGl0aW9ucykpXG4gICAgICAgIC5vcmRlckJ5KFxuICAgICAgICAgIG92ZXJkdWVPbmx5IHx8IGR1ZVNvb25EYXlzIFxuICAgICAgICAgICAgPyBhc2MocGxhbnRJbnN0YW5jZXMuZmVydGlsaXplckR1ZSlcbiAgICAgICAgICAgIDogZGVzYyhwbGFudEluc3RhbmNlcy5jcmVhdGVkQXQpXG4gICAgICAgIClcbiAgICAgICAgLmxpbWl0KGxpbWl0KVxuICAgICAgICAub2Zmc2V0KG9mZnNldCk7XG5cbiAgICAgIGNvbnN0IGVuaGFuY2VkSW5zdGFuY2VzID0gaW5zdGFuY2VzLm1hcChpbnN0YW5jZSA9PiBcbiAgICAgICAgcGxhbnRJbnN0YW5jZUhlbHBlcnMuZW5oYW5jZVBsYW50SW5zdGFuY2UoaW5zdGFuY2UucGxhbnRfaW5zdGFuY2VzLCBpbnN0YW5jZS5wbGFudHMhKVxuICAgICAgKTtcblxuICAgICAgY29uc3Qgc2VhcmNoVGltZSA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGluc3RhbmNlczogZW5oYW5jZWRJbnN0YW5jZXMsXG4gICAgICAgIHRvdGFsQ291bnQsXG4gICAgICAgIGhhc01vcmU6IG9mZnNldCArIGxpbWl0IDwgdG90YWxDb3VudCxcbiAgICAgICAgc2VhcmNoVGltZSxcbiAgICAgICAgZmlsdGVyczogZmlsdGVyUGFyYW1zLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCBwbGFudCBpbnN0YW5jZXMgd2l0aCBmaWx0ZXJzOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCBwbGFudCBpbnN0YW5jZXMgd2l0aCBmaWx0ZXJzJyk7XG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IGVuaGFuY2VkIHBsYW50IGluc3RhbmNlcyBmb3IgYSB1c2VyXG4gIHN0YXRpYyBhc3luYyBnZXRFbmhhbmNlZEJ5VXNlcklkKHVzZXJJZDogbnVtYmVyLCBhY3RpdmVPbmx5OiBib29sZWFuID0gdHJ1ZSk6IFByb21pc2U8RW5oYW5jZWRQbGFudEluc3RhbmNlW10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY29uZGl0aW9ucyA9IFtlcShwbGFudEluc3RhbmNlcy51c2VySWQsIHVzZXJJZCldO1xuICAgICAgaWYgKGFjdGl2ZU9ubHkpIHtcbiAgICAgICAgY29uZGl0aW9ucy5wdXNoKGVxKHBsYW50SW5zdGFuY2VzLmlzQWN0aXZlLCB0cnVlKSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGluc3RhbmNlcyA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbShwbGFudEluc3RhbmNlcylcbiAgICAgICAgLmxlZnRKb2luKHBsYW50cywgZXEocGxhbnRJbnN0YW5jZXMucGxhbnRJZCwgcGxhbnRzLmlkKSlcbiAgICAgICAgLndoZXJlKGFuZCguLi5jb25kaXRpb25zKSlcbiAgICAgICAgLm9yZGVyQnkoZGVzYyhwbGFudEluc3RhbmNlcy5jcmVhdGVkQXQpKTtcblxuICAgICAgcmV0dXJuIGluc3RhbmNlcy5tYXAoaW5zdGFuY2UgPT4gXG4gICAgICAgIHBsYW50SW5zdGFuY2VIZWxwZXJzLmVuaGFuY2VQbGFudEluc3RhbmNlKGluc3RhbmNlLnBsYW50X2luc3RhbmNlcywgaW5zdGFuY2UucGxhbnRzISlcbiAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgZW5oYW5jZWQgcGxhbnQgaW5zdGFuY2VzOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCBlbmhhbmNlZCBwbGFudCBpbnN0YW5jZXMnKTtcbiAgICB9XG4gIH1cblxuICAvLyBHZXQgY2FyZSBkYXNoYm9hcmQgZGF0YVxuICBzdGF0aWMgYXN5bmMgZ2V0Q2FyZURhc2hib2FyZERhdGEodXNlcklkOiBudW1iZXIpOiBQcm9taXNlPENhcmVEYXNoYm9hcmREYXRhPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICBjb25zdCB0b21vcnJvdyA9IG5ldyBEYXRlKCk7XG4gICAgICB0b21vcnJvdy5zZXREYXRlKG5vdy5nZXREYXRlKCkgKyAxKTtcbiAgICAgIGNvbnN0IHdlZWtGcm9tTm93ID0gbmV3IERhdGUoKTtcbiAgICAgIHdlZWtGcm9tTm93LnNldERhdGUobm93LmdldERhdGUoKSArIDcpO1xuXG4gICAgICAvLyBHZXQgYWxsIGFjdGl2ZSBpbnN0YW5jZXMgd2l0aCBwbGFudCBkYXRhXG4gICAgICBjb25zdCBpbnN0YW5jZXMgPSBhd2FpdCB0aGlzLmdldEVuaGFuY2VkQnlVc2VySWQodXNlcklkLCB0cnVlKTtcblxuICAgICAgLy8gQ2F0ZWdvcml6ZSBieSBjYXJlIHN0YXR1c1xuICAgICAgY29uc3Qgb3ZlcmR1ZSA9IGluc3RhbmNlcy5maWx0ZXIoaW5zdGFuY2UgPT4gaW5zdGFuY2UuY2FyZVN0YXR1cyA9PT0gJ292ZXJkdWUnKTtcbiAgICAgIGNvbnN0IGR1ZVRvZGF5ID0gaW5zdGFuY2VzLmZpbHRlcihpbnN0YW5jZSA9PiBpbnN0YW5jZS5jYXJlU3RhdHVzID09PSAnZHVlX3RvZGF5Jyk7XG4gICAgICBjb25zdCBkdWVTb29uID0gaW5zdGFuY2VzLmZpbHRlcihpbnN0YW5jZSA9PiBpbnN0YW5jZS5jYXJlU3RhdHVzID09PSAnZHVlX3Nvb24nKTtcbiAgICAgIFxuICAgICAgLy8gR2V0IHJlY2VudGx5IGNhcmVkIGZvciBwbGFudHMgKGZlcnRpbGl6ZWQgaW4gbGFzdCA3IGRheXMpXG4gICAgICBjb25zdCByZWNlbnRseUNhcmVkID0gaW5zdGFuY2VzLmZpbHRlcihpbnN0YW5jZSA9PiB7XG4gICAgICAgIGlmICghaW5zdGFuY2UubGFzdEZlcnRpbGl6ZWQpIHJldHVybiBmYWxzZTtcbiAgICAgICAgY29uc3QgZGF5c1NpbmNlID0gcGxhbnRJbnN0YW5jZUhlbHBlcnMuY2FsY3VsYXRlRGF5c1NpbmNlTGFzdEZlcnRpbGl6ZWQoaW5zdGFuY2UubGFzdEZlcnRpbGl6ZWQpO1xuICAgICAgICByZXR1cm4gZGF5c1NpbmNlICE9PSBudWxsICYmIGRheXNTaW5jZSA8PSA3O1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBjYXJlIHN0cmVhayAoY29uc2VjdXRpdmUgZGF5cyB3aXRoIGNhcmUgYWN0aXZpdHkpXG4gICAgICBjb25zdCBjYXJlU3RyZWFrRGF5cyA9IGF3YWl0IHRoaXMuY2FsY3VsYXRlQ2FyZVN0cmVhayh1c2VySWQpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBvdmVyZHVlOiBwbGFudEluc3RhbmNlSGVscGVycy5zb3J0QnlDYXJlVXJnZW5jeShvdmVyZHVlKSxcbiAgICAgICAgZHVlVG9kYXk6IHBsYW50SW5zdGFuY2VIZWxwZXJzLnNvcnRCeUNhcmVVcmdlbmN5KGR1ZVRvZGF5KSxcbiAgICAgICAgZHVlU29vbjogcGxhbnRJbnN0YW5jZUhlbHBlcnMuc29ydEJ5Q2FyZVVyZ2VuY3koZHVlU29vbiksXG4gICAgICAgIHJlY2VudGx5Q2FyZWQsXG4gICAgICAgIHN0YXRpc3RpY3M6IHtcbiAgICAgICAgICB0b3RhbEFjdGl2ZVBsYW50czogaW5zdGFuY2VzLmxlbmd0aCxcbiAgICAgICAgICBvdmVyZHVlQ291bnQ6IG92ZXJkdWUubGVuZ3RoLFxuICAgICAgICAgIGR1ZVRvZGF5Q291bnQ6IGR1ZVRvZGF5Lmxlbmd0aCxcbiAgICAgICAgICBkdWVTb29uQ291bnQ6IGR1ZVNvb24ubGVuZ3RoLFxuICAgICAgICAgIGNhcmVTdHJlYWtEYXlzLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCBjYXJlIGRhc2hib2FyZCBkYXRhOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCBjYXJlIGRhc2hib2FyZCBkYXRhJyk7XG4gICAgfVxuICB9XG5cbiAgLy8gQ2FsY3VsYXRlIGNhcmUgc3RyZWFrXG4gIHN0YXRpYyBhc3luYyBjYWxjdWxhdGVDYXJlU3RyZWFrKHVzZXJJZDogbnVtYmVyKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICB0cnkge1xuICAgICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgaW1wbGVtZW50YXRpb25cbiAgICAgIC8vIEluIGEgcmVhbCBhcHAsIHlvdSBtaWdodCB3YW50IHRvIHRyYWNrIGNhcmUgZXZlbnRzIGluIGEgc2VwYXJhdGUgdGFibGVcbiAgICAgIGNvbnN0IGluc3RhbmNlcyA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3Qoe1xuICAgICAgICAgIGxhc3RGZXJ0aWxpemVkOiBwbGFudEluc3RhbmNlcy5sYXN0RmVydGlsaXplZCxcbiAgICAgICAgfSlcbiAgICAgICAgLmZyb20ocGxhbnRJbnN0YW5jZXMpXG4gICAgICAgIC53aGVyZShcbiAgICAgICAgICBhbmQoXG4gICAgICAgICAgICBlcShwbGFudEluc3RhbmNlcy51c2VySWQsIHVzZXJJZCksXG4gICAgICAgICAgICBlcShwbGFudEluc3RhbmNlcy5pc0FjdGl2ZSwgdHJ1ZSksXG4gICAgICAgICAgICBpc05vdE51bGwocGxhbnRJbnN0YW5jZXMubGFzdEZlcnRpbGl6ZWQpXG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgICAgIC5vcmRlckJ5KGRlc2MocGxhbnRJbnN0YW5jZXMubGFzdEZlcnRpbGl6ZWQpKTtcblxuICAgICAgaWYgKGluc3RhbmNlcy5sZW5ndGggPT09IDApIHJldHVybiAwO1xuXG4gICAgICAvLyBTaW1wbGUgc3RyZWFrIGNhbGN1bGF0aW9uIGJhc2VkIG9uIHJlY2VudCBmZXJ0aWxpemVyIGFwcGxpY2F0aW9uc1xuICAgICAgbGV0IHN0cmVhayA9IDA7XG4gICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IGluc3RhbmNlIG9mIGluc3RhbmNlcykge1xuICAgICAgICBpZiAoIWluc3RhbmNlLmxhc3RGZXJ0aWxpemVkKSBicmVhaztcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGRheXNTaW5jZSA9IE1hdGguZmxvb3IoXG4gICAgICAgICAgKG5vdy5nZXRUaW1lKCkgLSBpbnN0YW5jZS5sYXN0RmVydGlsaXplZC5nZXRUaW1lKCkpIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICBpZiAoZGF5c1NpbmNlIDw9IDEpIHtcbiAgICAgICAgICBzdHJlYWsgPSBNYXRoLm1heChzdHJlYWssIDEpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzdHJlYWs7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjYWxjdWxhdGUgY2FyZSBzdHJlYWs6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICB9XG5cbiAgLy8gQnVsayBvcGVyYXRpb25zXG4gIHN0YXRpYyBhc3luYyBidWxrT3BlcmF0aW9uKG9wZXJhdGlvbjogQnVsa1BsYW50SW5zdGFuY2VPcGVyYXRpb24pOiBQcm9taXNlPEJ1bGtPcGVyYXRpb25SZXN1bHQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBwbGFudEluc3RhbmNlSWRzLCBvcGVyYXRpb246IG9wLCBmZXJ0aWxpemVyRGF0ZSwgbm90ZXMgfSA9IG9wZXJhdGlvbjtcbiAgICAgIGNvbnN0IHJlc3VsdHM6IEJ1bGtPcGVyYXRpb25SZXN1bHRbJ3Jlc3VsdHMnXSA9IFtdO1xuICAgICAgbGV0IHN1Y2Nlc3NDb3VudCA9IDA7XG4gICAgICBsZXQgZmFpbHVyZUNvdW50ID0gMDtcblxuICAgICAgZm9yIChjb25zdCBpZCBvZiBwbGFudEluc3RhbmNlSWRzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgbGV0IHJlc3VsdDogUGxhbnRJbnN0YW5jZTtcbiAgICAgICAgICBcbiAgICAgICAgICBzd2l0Y2ggKG9wKSB7XG4gICAgICAgICAgICBjYXNlICdhY3RpdmF0ZSc6XG4gICAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMucmVhY3RpdmF0ZShpZCk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZGVhY3RpdmF0ZSc6XG4gICAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuZGVhY3RpdmF0ZShpZCk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kZWxldGUoaWQpO1xuICAgICAgICAgICAgICByZXN1bHQgPSB7IGlkIH0gYXMgUGxhbnRJbnN0YW5jZTsgLy8gUGxhY2Vob2xkZXIgZm9yIGRlbGV0ZWQgaXRlbVxuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2ZlcnRpbGl6ZSc6XG4gICAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMubG9nRmVydGlsaXplcihpZCwgZmVydGlsaXplckRhdGUpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBvcGVyYXRpb246ICR7b3B9YCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmVzdWx0cy5wdXNoKHsgcGxhbnRJbnN0YW5jZUlkOiBpZCwgc3VjY2VzczogdHJ1ZSB9KTtcbiAgICAgICAgICBzdWNjZXNzQ291bnQrKztcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICByZXN1bHRzLnB1c2goeyBcbiAgICAgICAgICAgIHBsYW50SW5zdGFuY2VJZDogaWQsIFxuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsIFxuICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZmFpbHVyZUNvdW50Kys7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2Vzczogc3VjY2Vzc0NvdW50ID4gMCxcbiAgICAgICAgc3VjY2Vzc0NvdW50LFxuICAgICAgICBmYWlsdXJlQ291bnQsXG4gICAgICAgIHJlc3VsdHMsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcGVyZm9ybSBidWxrIG9wZXJhdGlvbjonLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBwZXJmb3JtIGJ1bGsgb3BlcmF0aW9uJyk7XG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IHBsYW50IGluc3RhbmNlcyBieSBsb2NhdGlvblxuICBzdGF0aWMgYXN5bmMgZ2V0QnlMb2NhdGlvbih1c2VySWQ6IG51bWJlciwgbG9jYXRpb246IHN0cmluZyk6IFByb21pc2U8RW5oYW5jZWRQbGFudEluc3RhbmNlW10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgaW5zdGFuY2VzID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKHBsYW50SW5zdGFuY2VzKVxuICAgICAgICAubGVmdEpvaW4ocGxhbnRzLCBlcShwbGFudEluc3RhbmNlcy5wbGFudElkLCBwbGFudHMuaWQpKVxuICAgICAgICAud2hlcmUoXG4gICAgICAgICAgYW5kKFxuICAgICAgICAgICAgZXEocGxhbnRJbnN0YW5jZXMudXNlcklkLCB1c2VySWQpLFxuICAgICAgICAgICAgZXEocGxhbnRJbnN0YW5jZXMuaXNBY3RpdmUsIHRydWUpLFxuICAgICAgICAgICAgaWxpa2UocGxhbnRJbnN0YW5jZXMubG9jYXRpb24sIGAlJHtsb2NhdGlvbn0lYClcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgICAgLm9yZGVyQnkocGxhbnRJbnN0YW5jZXMubmlja25hbWUpO1xuXG4gICAgICByZXR1cm4gaW5zdGFuY2VzLm1hcChpbnN0YW5jZSA9PiBcbiAgICAgICAgcGxhbnRJbnN0YW5jZUhlbHBlcnMuZW5oYW5jZVBsYW50SW5zdGFuY2UoaW5zdGFuY2UucGxhbnRfaW5zdGFuY2VzLCBpbnN0YW5jZS5wbGFudHMhKVxuICAgICAgKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCBwbGFudCBpbnN0YW5jZXMgYnkgbG9jYXRpb246JywgZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZ2V0IHBsYW50IGluc3RhbmNlcyBieSBsb2NhdGlvbicpO1xuICAgIH1cbiAgfVxuXG4gIC8vIEdldCB1bmlxdWUgbG9jYXRpb25zIGZvciBhIHVzZXJcbiAgc3RhdGljIGFzeW5jIGdldFVzZXJMb2NhdGlvbnModXNlcklkOiBudW1iZXIpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGxvY2F0aW9ucyA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3REaXN0aW5jdCh7IGxvY2F0aW9uOiBwbGFudEluc3RhbmNlcy5sb2NhdGlvbiB9KVxuICAgICAgICAuZnJvbShwbGFudEluc3RhbmNlcylcbiAgICAgICAgLndoZXJlKFxuICAgICAgICAgIGFuZChcbiAgICAgICAgICAgIGVxKHBsYW50SW5zdGFuY2VzLnVzZXJJZCwgdXNlcklkKSxcbiAgICAgICAgICAgIGVxKHBsYW50SW5zdGFuY2VzLmlzQWN0aXZlLCB0cnVlKVxuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgICAub3JkZXJCeShwbGFudEluc3RhbmNlcy5sb2NhdGlvbik7XG5cbiAgICAgIHJldHVybiBsb2NhdGlvbnMubWFwKGwgPT4gbC5sb2NhdGlvbikuZmlsdGVyKEJvb2xlYW4pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZ2V0IHVzZXIgbG9jYXRpb25zOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCB1c2VyIGxvY2F0aW9ucycpO1xuICAgIH1cbiAgfVxuXG4gIC8vIEdldCBlbmhhbmNlZCBwbGFudCBpbnN0YW5jZSBieSBJRFxuICBzdGF0aWMgYXN5bmMgZ2V0RW5oYW5jZWRCeUlkKGlkOiBudW1iZXIpOiBQcm9taXNlPEVuaGFuY2VkUGxhbnRJbnN0YW5jZSB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgW2luc3RhbmNlXSA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbShwbGFudEluc3RhbmNlcylcbiAgICAgICAgLmxlZnRKb2luKHBsYW50cywgZXEocGxhbnRJbnN0YW5jZXMucGxhbnRJZCwgcGxhbnRzLmlkKSlcbiAgICAgICAgLndoZXJlKGVxKHBsYW50SW5zdGFuY2VzLmlkLCBpZCkpO1xuICAgICAgXG4gICAgICBpZiAoIWluc3RhbmNlIHx8ICFpbnN0YW5jZS5wbGFudHMpIHJldHVybiBudWxsO1xuICAgICAgXG4gICAgICByZXR1cm4gcGxhbnRJbnN0YW5jZUhlbHBlcnMuZW5oYW5jZVBsYW50SW5zdGFuY2UoaW5zdGFuY2UucGxhbnRfaW5zdGFuY2VzLCBpbnN0YW5jZS5wbGFudHMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZ2V0IGVuaGFuY2VkIHBsYW50IGluc3RhbmNlIGJ5IElEOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCBlbmhhbmNlZCBwbGFudCBpbnN0YW5jZScpO1xuICAgIH1cbiAgfVxufSJdLCJuYW1lcyI6WyJQbGFudEluc3RhbmNlUXVlcmllcyIsImNyZWF0ZSIsImluc3RhbmNlRGF0YSIsImluc3RhbmNlIiwiZGIiLCJpbnNlcnQiLCJwbGFudEluc3RhbmNlcyIsInZhbHVlcyIsInJldHVybmluZyIsImVycm9yIiwiY29uc29sZSIsIkVycm9yIiwiZ2V0QnlJZCIsImlkIiwic2VsZWN0IiwiZnJvbSIsImxlZnRKb2luIiwicGxhbnRzIiwiZXEiLCJwbGFudElkIiwid2hlcmUiLCJwbGFudF9pbnN0YW5jZXMiLCJwbGFudCIsImdldEJ5VXNlcklkIiwidXNlcklkIiwiYWN0aXZlT25seSIsImNvbmRpdGlvbnMiLCJwdXNoIiwiaXNBY3RpdmUiLCJpbnN0YW5jZXMiLCJhbmQiLCJvcmRlckJ5IiwiZGVzYyIsImNyZWF0ZWRBdCIsIm1hcCIsImdldE92ZXJkdWVGZXJ0aWxpemVyIiwibm93IiwiRGF0ZSIsImlzTm90TnVsbCIsImZlcnRpbGl6ZXJEdWUiLCJsdGUiLCJhc2MiLCJnZXRGZXJ0aWxpemVyRHVlU29vbiIsImRheXNBaGVhZCIsImZ1dHVyZURhdGUiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsImd0ZSIsInNlYXJjaCIsInF1ZXJ5Iiwic2VhcmNoVGVybSIsInRvTG93ZXJDYXNlIiwib3IiLCJpbGlrZSIsIm5pY2tuYW1lIiwibG9jYXRpb24iLCJub3RlcyIsImNvbW1vbk5hbWUiLCJnZW51cyIsInNwZWNpZXMiLCJ1cGRhdGUiLCJzZXQiLCJ1cGRhdGVkQXQiLCJsb2dGZXJ0aWxpemVyIiwiZmVydGlsaXplckRhdGUiLCJjdXJyZW50SW5zdGFuY2UiLCJuZXh0RHVlIiwiZmVydGlsaXplclNjaGVkdWxlIiwic2NoZWR1bGVNYXRjaCIsIm1hdGNoIiwiYW1vdW50IiwidW5pdCIsInBhcnNlSW50Iiwic2V0TW9udGgiLCJnZXRNb250aCIsImxhc3RGZXJ0aWxpemVkIiwibG9nUmVwb3QiLCJyZXBvdERhdGUiLCJ1cGRhdGVEYXRhIiwibGFzdFJlcG90IiwiZXhpc3RpbmdOb3RlcyIsInJlcG90Tm90ZSIsInRvRGF0ZVN0cmluZyIsImRlYWN0aXZhdGUiLCJyZWFjdGl2YXRlIiwiZGVsZXRlIiwicmVzdWx0IiwibGVuZ3RoIiwiZ2V0Q2FyZVN0YXRzIiwid2Vla0Zyb21Ob3ciLCJzdGF0cyIsInRvdGFsUGxhbnRzIiwic3FsIiwiYWN0aXZlUGxhbnRzIiwib3ZlcmR1ZUZlcnRpbGl6ZXIiLCJkdWVTb29uIiwic2VhcmNoV2l0aEZpbHRlcnMiLCJzZWFyY2hQYXJhbXMiLCJzdGFydFRpbWUiLCJsaW1pdCIsIm9mZnNldCIsImZhbWlseSIsImNvdW50UmVzdWx0IiwiY291bnQiLCJ0b3RhbENvdW50IiwiZW5oYW5jZWRJbnN0YW5jZXMiLCJwbGFudEluc3RhbmNlSGVscGVycyIsImVuaGFuY2VQbGFudEluc3RhbmNlIiwic2VhcmNoVGltZSIsImhhc01vcmUiLCJmaWx0ZXJzIiwib3ZlcmR1ZU9ubHkiLCJnZXRXaXRoRmlsdGVycyIsImZpbHRlclBhcmFtcyIsImR1ZVNvb25EYXlzIiwiY3JlYXRlZEFmdGVyIiwiY3JlYXRlZEJlZm9yZSIsImxhc3RGZXJ0aWxpemVkQWZ0ZXIiLCJsYXN0RmVydGlsaXplZEJlZm9yZSIsInVuZGVmaW5lZCIsImdldEVuaGFuY2VkQnlVc2VySWQiLCJnZXRDYXJlRGFzaGJvYXJkRGF0YSIsInRvbW9ycm93Iiwib3ZlcmR1ZSIsImZpbHRlciIsImNhcmVTdGF0dXMiLCJkdWVUb2RheSIsInJlY2VudGx5Q2FyZWQiLCJkYXlzU2luY2UiLCJjYWxjdWxhdGVEYXlzU2luY2VMYXN0RmVydGlsaXplZCIsImNhcmVTdHJlYWtEYXlzIiwiY2FsY3VsYXRlQ2FyZVN0cmVhayIsInNvcnRCeUNhcmVVcmdlbmN5Iiwic3RhdGlzdGljcyIsInRvdGFsQWN0aXZlUGxhbnRzIiwib3ZlcmR1ZUNvdW50IiwiZHVlVG9kYXlDb3VudCIsImR1ZVNvb25Db3VudCIsInN0cmVhayIsIk1hdGgiLCJmbG9vciIsImdldFRpbWUiLCJtYXgiLCJidWxrT3BlcmF0aW9uIiwib3BlcmF0aW9uIiwicGxhbnRJbnN0YW5jZUlkcyIsIm9wIiwicmVzdWx0cyIsInN1Y2Nlc3NDb3VudCIsImZhaWx1cmVDb3VudCIsInBsYW50SW5zdGFuY2VJZCIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwiZ2V0QnlMb2NhdGlvbiIsImdldFVzZXJMb2NhdGlvbnMiLCJsb2NhdGlvbnMiLCJzZWxlY3REaXN0aW5jdCIsImwiLCJCb29sZWFuIiwiZ2V0RW5oYW5jZWRCeUlkIl0sIm1hcHBpbmdzIjoiOzs7OytCQWtCYUE7OztlQUFBQTs7OzRCQWxCb0U7dUJBQzlEO3dCQUMrRDtvQ0FhN0M7QUFHOUIsTUFBTUE7SUFDWCw4QkFBOEI7SUFDOUIsYUFBYUMsT0FBT0MsWUFBOEIsRUFBMEI7UUFDMUUsSUFBSTtZQUNGLE1BQU0sQ0FBQ0MsU0FBUyxHQUFHLE1BQU1DLFNBQUUsQ0FBQ0MsTUFBTSxDQUFDQyxzQkFBYyxFQUFFQyxNQUFNLENBQUNMLGNBQWNNLFNBQVM7WUFDakYsT0FBT0w7UUFDVCxFQUFFLE9BQU9NLE9BQU87WUFDZEMsUUFBUUQsS0FBSyxDQUFDLG9DQUFvQ0E7WUFDbEQsTUFBTSxJQUFJRSxNQUFNO1FBQ2xCO0lBQ0Y7SUFFQSxvREFBb0Q7SUFDcEQsYUFB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