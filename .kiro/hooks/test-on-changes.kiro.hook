{
  "enabled": true,
  "name": "Run Tests on Changes",
  "description": "Automatically runs the test suite whenever source files are modified to ensure all tests pass before continuing development",
  "version": "2",
  "when": {
    "type": "fileChanged",
    "patterns": [
      "src/**/*.ts",
      "src/**/*.tsx",
      "src/**/*.js",
      "src/**/*.jsx"
    ]
  },
  "then": {
    "type": "askAgent",
    "prompt": "Source files have been modified. Please analyze the changes and ensure code quality:\n\n**WORKFLOW:**\n1. Analyze the changed files to identify new or modified functions and methods\n2. Check if corresponding tests exist in the appropriate test directory (__tests__ folders or .test/.spec files)\n3. Evaluate current test coverage for the modified code\n4. If coverage is missing or insufficient:\n   - Generate comprehensive test cases for new/modified functions\n   - Include unit tests, integration tests, and edge cases as appropriate\n   - Follow the existing test patterns and use the test utilities in src/test-utils/\n5. Run the test suite to verify all tests pass: `npm test`\n6. Run the build to ensure no compilation errors: `npm run build`\n7. Fix any code that is not passing tests or builds\n8. Update coverage reports and highlight any coverage gaps\n9. Provide a summary of:\n   - What was tested\n   - Coverage percentage changes\n   - Any remaining coverage gaps\n   - Recommendations for additional testing\n\n**QUALITY CHECKS:**\n- Ensure TypeScript compilation passes\n- Verify all tests pass\n- Check for proper error handling\n- Validate component prop interfaces\n- Ensure server-only directives are in place for database/auth files\n\nFocus on maintaining high code quality and comprehensive test coverage across the codebase."
  }
}