{"version":3,"names":["cov_1rns3yk3e5","actualCoverage","s","usePWAInstall","f","deferredPrompt","setDeferredPrompt","_react","useState","isInstallable","setIsInstallable","isInstalled","setIsInstalled","isStandalone","setIsStandalone","useEffect","checkStandalone","isStandaloneMode","b","window","matchMedia","matches","navigator","standalone","document","referrer","includes","handleBeforeInstallPrompt","e","preventDefault","promptEvent","handleAppInstalled","handleDisplayModeChange","addEventListener","standaloneQuery","removeEventListener","promptInstall","useCallback","outcome","prompt","choiceResult","userChoice","error","console","dismissPrompt"],"sources":["/Users/stefanbekker/projects/fancy-planties/src/hooks/usePWAInstall.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\n\ninterface BeforeInstallPromptEvent extends Event {\n  prompt(): Promise<void>;\n  userChoice: Promise<{ outcome: 'accepted' | 'dismissed' }>;\n}\n\n/**\n * Hook for managing PWA installation prompts and detection\n */\nexport function usePWAInstall() {\n  const [deferredPrompt, setDeferredPrompt] = useState<BeforeInstallPromptEvent | null>(null);\n  const [isInstallable, setIsInstallable] = useState(false);\n  const [isInstalled, setIsInstalled] = useState(false);\n  const [isStandalone, setIsStandalone] = useState(false);\n\n  useEffect(() => {\n    // Check if app is running in standalone mode\n    const checkStandalone = () => {\n      const isStandaloneMode = \n        window.matchMedia('(display-mode: standalone)').matches ||\n        (window.navigator as any).standalone ||\n        document.referrer.includes('android-app://');\n      \n      setIsStandalone(isStandaloneMode);\n      setIsInstalled(isStandaloneMode);\n    };\n\n    checkStandalone();\n\n    // Listen for beforeinstallprompt event\n    const handleBeforeInstallPrompt = (e: Event) => {\n      e.preventDefault();\n      const promptEvent = e as BeforeInstallPromptEvent;\n      setDeferredPrompt(promptEvent);\n      setIsInstallable(true);\n    };\n\n    // Listen for app installed event\n    const handleAppInstalled = () => {\n      setIsInstalled(true);\n      setIsInstallable(false);\n      setDeferredPrompt(null);\n    };\n\n    // Listen for display mode changes\n    const handleDisplayModeChange = (e: MediaQueryListEvent) => {\n      setIsStandalone(e.matches);\n    };\n\n    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\n    window.addEventListener('appinstalled', handleAppInstalled);\n    \n    const standaloneQuery = window.matchMedia('(display-mode: standalone)');\n    standaloneQuery.addEventListener('change', handleDisplayModeChange);\n\n    return () => {\n      window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\n      window.removeEventListener('appinstalled', handleAppInstalled);\n      standaloneQuery.removeEventListener('change', handleDisplayModeChange);\n    };\n  }, []);\n\n  const promptInstall = useCallback(async () => {\n    if (!deferredPrompt) {\n      return { outcome: 'not-available' as const };\n    }\n\n    try {\n      await deferredPrompt.prompt();\n      const choiceResult = await deferredPrompt.userChoice;\n      \n      if (choiceResult.outcome === 'accepted') {\n        setIsInstallable(false);\n        setDeferredPrompt(null);\n      }\n      \n      return choiceResult;\n    } catch (error) {\n      console.error('Error prompting install:', error);\n      return { outcome: 'error' as const };\n    }\n  }, [deferredPrompt]);\n\n  const dismissPrompt = useCallback(() => {\n    setIsInstallable(false);\n    setDeferredPrompt(null);\n  }, []);\n\n  return {\n    isInstallable,\n    isInstalled,\n    isStandalone,\n    promptInstall,\n    dismissPrompt,\n  };\n}"],"mappings":"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","ignoreList":[]}