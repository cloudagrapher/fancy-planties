7c09a23ac943b163815aff8dbe8384a3
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get EmailVerificationCleanupService () {
        return EmailVerificationCleanupService;
    },
    get emailVerificationCleanupService () {
        return emailVerificationCleanupService;
    }
});
require("server-only");
const _emailverificationcodeservice = require("./email-verification-code-service");
const _emailverificationratelimiter = require("./email-verification-rate-limiter");
class EmailVerificationCleanupService {
    /**
   * Run cleanup of expired verification codes and rate limit data
   */ async runCleanup() {
        if (this.isRunning) {
            throw new Error('Cleanup is already running');
        }
        this.isRunning = true;
        const startTime = Date.now();
        try {
            console.log('[CLEANUP] Starting email verification cleanup...');
            // Clean up expired verification codes
            const expiredCodes = await _emailverificationcodeservice.emailVerificationCodeService.cleanupExpiredCodes();
            console.log(`[CLEANUP] Removed ${expiredCodes} expired verification codes`);
            // Clean up rate limit data
            const rateLimitStatsBefore = _emailverificationratelimiter.emailVerificationRateLimiter.getStats();
            _emailverificationratelimiter.emailVerificationRateLimiter.cleanup();
            const rateLimitStatsAfter = _emailverificationratelimiter.emailVerificationRateLimiter.getStats();
            const rateLimitDataCleaned = rateLimitStatsBefore.verificationAttempts - rateLimitStatsAfter.verificationAttempts + (rateLimitStatsBefore.resendRequests - rateLimitStatsAfter.resendRequests) + (rateLimitStatsBefore.emailVerificationActivity - rateLimitStatsAfter.emailVerificationActivity) + (rateLimitStatsBefore.resendCooldowns - rateLimitStatsAfter.resendCooldowns);
            console.log(`[CLEANUP] Cleaned up ${rateLimitDataCleaned} rate limit entries`);
            const stats = {
                expiredCodes,
                rateLimitData: rateLimitDataCleaned,
                timestamp: startTime
            };
            // Store cleanup stats (keep last 24 entries)
            this.cleanupStats.push(stats);
            if (this.cleanupStats.length > 24) {
                this.cleanupStats.shift();
            }
            this.lastCleanup = startTime;
            const duration = Date.now() - startTime;
            console.log(`[CLEANUP] Email verification cleanup completed in ${duration}ms`);
            return stats;
        } catch (error) {
            console.error('[CLEANUP] Email verification cleanup failed:', error);
            throw error;
        } finally{
            this.isRunning = false;
        }
    }
    /**
   * Schedule automatic cleanup to run periodically
   */ scheduleCleanup(intervalMs = 60 * 60 * 1000) {
        console.log(`[CLEANUP] Scheduling email verification cleanup every ${intervalMs / 1000} seconds`);
        const runScheduledCleanup = async ()=>{
            try {
                await this.runCleanup();
            } catch (error) {
                console.error('[CLEANUP] Scheduled cleanup failed:', error);
            }
        };
        // Run initial cleanup after a short delay
        setTimeout(runScheduledCleanup, 5000); // 5 seconds
        // Then run periodically
        setInterval(runScheduledCleanup, intervalMs);
    }
    /**
   * Run startup cleanup to clean any leftover data
   */ async runStartupCleanup() {
        console.log('[CLEANUP] Running startup cleanup...');
        try {
            const stats = await this.runCleanup();
            console.log('[CLEANUP] Startup cleanup completed successfully');
            return stats;
        } catch (error) {
            console.error('[CLEANUP] Startup cleanup failed:', error);
            throw error;
        }
    }
    /**
   * Get cleanup statistics
   */ getCleanupStats() {
        const totalExpiredCodes = this.cleanupStats.reduce((sum, stat)=>sum + stat.expiredCodes, 0);
        const totalRateLimitData = this.cleanupStats.reduce((sum, stat)=>sum + stat.rateLimitData, 0);
        return {
            lastCleanup: this.lastCleanup,
            isRunning: this.isRunning,
            recentStats: [
                ...this.cleanupStats
            ],
            totalExpiredCodes,
            totalRateLimitData
        };
    }
    /**
   * Get current system status
   */ async getSystemStatus() {
        const codeStats = await _emailverificationcodeservice.emailVerificationCodeService.getCodeStats();
        const rateLimitStats = _emailverificationratelimiter.emailVerificationRateLimiter.getStats();
        const cleanupStats = this.getCleanupStats();
        // Estimate next cleanup time (assuming hourly cleanup)
        const nextCleanupDue = cleanupStats.lastCleanup + 60 * 60 * 1000;
        return {
            verificationCodes: codeStats,
            rateLimits: rateLimitStats,
            cleanup: {
                lastCleanup: cleanupStats.lastCleanup,
                isRunning: cleanupStats.isRunning,
                nextCleanupDue
            }
        };
    }
    /**
   * Force cleanup if needed (for manual triggers)
   */ async forceCleanup() {
        if (this.isRunning) {
            throw new Error('Cleanup is already running. Please wait for it to complete.');
        }
        console.log('[CLEANUP] Force cleanup requested');
        return await this.runCleanup();
    }
    constructor(){
        this.isRunning = false;
        this.lastCleanup = 0;
        this.cleanupStats = [];
    }
}
const emailVerificationCleanupService = new EmailVerificationCleanupService();
// Auto-schedule cleanup when this module is imported
if (process.env.NODE_ENV === 'production') {
    // In production, start cleanup automatically
    emailVerificationCleanupService.scheduleCleanup();
} else {
    // In development, run less frequently to avoid noise
    emailVerificationCleanupService.scheduleCleanup(2 * 60 * 60 * 1000); // 2 hours
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdGVmYW5iZWtrZXIvcHJvamVjdHMvZmFuY3ktcGxhbnRpZXMvc3JjL2xpYi9zZXJ2aWNlcy9lbWFpbC12ZXJpZmljYXRpb24tY2xlYW51cC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJ3NlcnZlci1vbmx5JztcbmltcG9ydCB7IGVtYWlsVmVyaWZpY2F0aW9uQ29kZVNlcnZpY2UgfSBmcm9tICcuL2VtYWlsLXZlcmlmaWNhdGlvbi1jb2RlLXNlcnZpY2UnO1xuaW1wb3J0IHsgZW1haWxWZXJpZmljYXRpb25SYXRlTGltaXRlciB9IGZyb20gJy4vZW1haWwtdmVyaWZpY2F0aW9uLXJhdGUtbGltaXRlcic7XG5pbXBvcnQgeyBlbWFpbFNlcnZpY2VNb25pdG9yIH0gZnJvbSAnLi9lbWFpbC1zZXJ2aWNlLW1vbml0b3InO1xuXG5leHBvcnQgaW50ZXJmYWNlIENsZWFudXBTdGF0cyB7XG4gIGV4cGlyZWRDb2RlczogbnVtYmVyO1xuICByYXRlTGltaXREYXRhOiBudW1iZXI7XG4gIHRpbWVzdGFtcDogbnVtYmVyO1xufVxuXG5leHBvcnQgY2xhc3MgRW1haWxWZXJpZmljYXRpb25DbGVhbnVwU2VydmljZSB7XG4gIHByaXZhdGUgaXNSdW5uaW5nID0gZmFsc2U7XG4gIHByaXZhdGUgbGFzdENsZWFudXAgPSAwO1xuICBwcml2YXRlIGNsZWFudXBTdGF0czogQ2xlYW51cFN0YXRzW10gPSBbXTtcbiAgXG4gIC8qKlxuICAgKiBSdW4gY2xlYW51cCBvZiBleHBpcmVkIHZlcmlmaWNhdGlvbiBjb2RlcyBhbmQgcmF0ZSBsaW1pdCBkYXRhXG4gICAqL1xuICBhc3luYyBydW5DbGVhbnVwKCk6IFByb21pc2U8Q2xlYW51cFN0YXRzPiB7XG4gICAgaWYgKHRoaXMuaXNSdW5uaW5nKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NsZWFudXAgaXMgYWxyZWFkeSBydW5uaW5nJyk7XG4gICAgfVxuICAgIFxuICAgIHRoaXMuaXNSdW5uaW5nID0gdHJ1ZTtcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZygnW0NMRUFOVVBdIFN0YXJ0aW5nIGVtYWlsIHZlcmlmaWNhdGlvbiBjbGVhbnVwLi4uJyk7XG4gICAgICBcbiAgICAgIC8vIENsZWFuIHVwIGV4cGlyZWQgdmVyaWZpY2F0aW9uIGNvZGVzXG4gICAgICBjb25zdCBleHBpcmVkQ29kZXMgPSBhd2FpdCBlbWFpbFZlcmlmaWNhdGlvbkNvZGVTZXJ2aWNlLmNsZWFudXBFeHBpcmVkQ29kZXMoKTtcbiAgICAgIGNvbnNvbGUubG9nKGBbQ0xFQU5VUF0gUmVtb3ZlZCAke2V4cGlyZWRDb2Rlc30gZXhwaXJlZCB2ZXJpZmljYXRpb24gY29kZXNgKTtcbiAgICAgIFxuICAgICAgLy8gQ2xlYW4gdXAgcmF0ZSBsaW1pdCBkYXRhXG4gICAgICBjb25zdCByYXRlTGltaXRTdGF0c0JlZm9yZSA9IGVtYWlsVmVyaWZpY2F0aW9uUmF0ZUxpbWl0ZXIuZ2V0U3RhdHMoKTtcbiAgICAgIGVtYWlsVmVyaWZpY2F0aW9uUmF0ZUxpbWl0ZXIuY2xlYW51cCgpO1xuICAgICAgY29uc3QgcmF0ZUxpbWl0U3RhdHNBZnRlciA9IGVtYWlsVmVyaWZpY2F0aW9uUmF0ZUxpbWl0ZXIuZ2V0U3RhdHMoKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmF0ZUxpbWl0RGF0YUNsZWFuZWQgPSBcbiAgICAgICAgKHJhdGVMaW1pdFN0YXRzQmVmb3JlLnZlcmlmaWNhdGlvbkF0dGVtcHRzIC0gcmF0ZUxpbWl0U3RhdHNBZnRlci52ZXJpZmljYXRpb25BdHRlbXB0cykgK1xuICAgICAgICAocmF0ZUxpbWl0U3RhdHNCZWZvcmUucmVzZW5kUmVxdWVzdHMgLSByYXRlTGltaXRTdGF0c0FmdGVyLnJlc2VuZFJlcXVlc3RzKSArXG4gICAgICAgIChyYXRlTGltaXRTdGF0c0JlZm9yZS5lbWFpbFZlcmlmaWNhdGlvbkFjdGl2aXR5IC0gcmF0ZUxpbWl0U3RhdHNBZnRlci5lbWFpbFZlcmlmaWNhdGlvbkFjdGl2aXR5KSArXG4gICAgICAgIChyYXRlTGltaXRTdGF0c0JlZm9yZS5yZXNlbmRDb29sZG93bnMgLSByYXRlTGltaXRTdGF0c0FmdGVyLnJlc2VuZENvb2xkb3ducyk7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKGBbQ0xFQU5VUF0gQ2xlYW5lZCB1cCAke3JhdGVMaW1pdERhdGFDbGVhbmVkfSByYXRlIGxpbWl0IGVudHJpZXNgKTtcbiAgICAgIFxuICAgICAgY29uc3Qgc3RhdHM6IENsZWFudXBTdGF0cyA9IHtcbiAgICAgICAgZXhwaXJlZENvZGVzLFxuICAgICAgICByYXRlTGltaXREYXRhOiByYXRlTGltaXREYXRhQ2xlYW5lZCxcbiAgICAgICAgdGltZXN0YW1wOiBzdGFydFRpbWUsXG4gICAgICB9O1xuICAgICAgXG4gICAgICAvLyBTdG9yZSBjbGVhbnVwIHN0YXRzIChrZWVwIGxhc3QgMjQgZW50cmllcylcbiAgICAgIHRoaXMuY2xlYW51cFN0YXRzLnB1c2goc3RhdHMpO1xuICAgICAgaWYgKHRoaXMuY2xlYW51cFN0YXRzLmxlbmd0aCA+IDI0KSB7XG4gICAgICAgIHRoaXMuY2xlYW51cFN0YXRzLnNoaWZ0KCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHRoaXMubGFzdENsZWFudXAgPSBzdGFydFRpbWU7XG4gICAgICBcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgIGNvbnNvbGUubG9nKGBbQ0xFQU5VUF0gRW1haWwgdmVyaWZpY2F0aW9uIGNsZWFudXAgY29tcGxldGVkIGluICR7ZHVyYXRpb259bXNgKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHN0YXRzO1xuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tDTEVBTlVQXSBFbWFpbCB2ZXJpZmljYXRpb24gY2xlYW51cCBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7XG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICogU2NoZWR1bGUgYXV0b21hdGljIGNsZWFudXAgdG8gcnVuIHBlcmlvZGljYWxseVxuICAgKi9cbiAgc2NoZWR1bGVDbGVhbnVwKGludGVydmFsTXM6IG51bWJlciA9IDYwICogNjAgKiAxMDAwKTogdm9pZCB7IC8vIERlZmF1bHQ6IDEgaG91clxuICAgIGNvbnNvbGUubG9nKGBbQ0xFQU5VUF0gU2NoZWR1bGluZyBlbWFpbCB2ZXJpZmljYXRpb24gY2xlYW51cCBldmVyeSAke2ludGVydmFsTXMgLyAxMDAwfSBzZWNvbmRzYCk7XG4gICAgXG4gICAgY29uc3QgcnVuU2NoZWR1bGVkQ2xlYW51cCA9IGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHRoaXMucnVuQ2xlYW51cCgpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW0NMRUFOVVBdIFNjaGVkdWxlZCBjbGVhbnVwIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICB9XG4gICAgfTtcbiAgICBcbiAgICAvLyBSdW4gaW5pdGlhbCBjbGVhbnVwIGFmdGVyIGEgc2hvcnQgZGVsYXlcbiAgICBzZXRUaW1lb3V0KHJ1blNjaGVkdWxlZENsZWFudXAsIDUwMDApOyAvLyA1IHNlY29uZHNcbiAgICBcbiAgICAvLyBUaGVuIHJ1biBwZXJpb2RpY2FsbHlcbiAgICBzZXRJbnRlcnZhbChydW5TY2hlZHVsZWRDbGVhbnVwLCBpbnRlcnZhbE1zKTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIFJ1biBzdGFydHVwIGNsZWFudXAgdG8gY2xlYW4gYW55IGxlZnRvdmVyIGRhdGFcbiAgICovXG4gIGFzeW5jIHJ1blN0YXJ0dXBDbGVhbnVwKCk6IFByb21pc2U8Q2xlYW51cFN0YXRzPiB7XG4gICAgY29uc29sZS5sb2coJ1tDTEVBTlVQXSBSdW5uaW5nIHN0YXJ0dXAgY2xlYW51cC4uLicpO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCBzdGF0cyA9IGF3YWl0IHRoaXMucnVuQ2xlYW51cCgpO1xuICAgICAgY29uc29sZS5sb2coJ1tDTEVBTlVQXSBTdGFydHVwIGNsZWFudXAgY29tcGxldGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgcmV0dXJuIHN0YXRzO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbQ0xFQU5VUF0gU3RhcnR1cCBjbGVhbnVwIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBHZXQgY2xlYW51cCBzdGF0aXN0aWNzXG4gICAqL1xuICBnZXRDbGVhbnVwU3RhdHMoKToge1xuICAgIGxhc3RDbGVhbnVwOiBudW1iZXI7XG4gICAgaXNSdW5uaW5nOiBib29sZWFuO1xuICAgIHJlY2VudFN0YXRzOiBDbGVhbnVwU3RhdHNbXTtcbiAgICB0b3RhbEV4cGlyZWRDb2RlczogbnVtYmVyO1xuICAgIHRvdGFsUmF0ZUxpbWl0RGF0YTogbnVtYmVyO1xuICB9IHtcbiAgICBjb25zdCB0b3RhbEV4cGlyZWRDb2RlcyA9IHRoaXMuY2xlYW51cFN0YXRzLnJlZHVjZSgoc3VtLCBzdGF0KSA9PiBzdW0gKyBzdGF0LmV4cGlyZWRDb2RlcywgMCk7XG4gICAgY29uc3QgdG90YWxSYXRlTGltaXREYXRhID0gdGhpcy5jbGVhbnVwU3RhdHMucmVkdWNlKChzdW0sIHN0YXQpID0+IHN1bSArIHN0YXQucmF0ZUxpbWl0RGF0YSwgMCk7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGxhc3RDbGVhbnVwOiB0aGlzLmxhc3RDbGVhbnVwLFxuICAgICAgaXNSdW5uaW5nOiB0aGlzLmlzUnVubmluZyxcbiAgICAgIHJlY2VudFN0YXRzOiBbLi4udGhpcy5jbGVhbnVwU3RhdHNdLFxuICAgICAgdG90YWxFeHBpcmVkQ29kZXMsXG4gICAgICB0b3RhbFJhdGVMaW1pdERhdGEsXG4gICAgfTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIEdldCBjdXJyZW50IHN5c3RlbSBzdGF0dXNcbiAgICovXG4gIGFzeW5jIGdldFN5c3RlbVN0YXR1cygpOiBQcm9taXNlPHtcbiAgICB2ZXJpZmljYXRpb25Db2Rlczoge1xuICAgICAgdG90YWxBY3RpdmU6IG51bWJlcjtcbiAgICAgIGV4cGlyZWRDb3VudDogbnVtYmVyO1xuICAgICAgaGlnaEF0dGVtcHRDb3VudDogbnVtYmVyO1xuICAgIH07XG4gICAgcmF0ZUxpbWl0czoge1xuICAgICAgdmVyaWZpY2F0aW9uQXR0ZW1wdHM6IG51bWJlcjtcbiAgICAgIHJlc2VuZFJlcXVlc3RzOiBudW1iZXI7XG4gICAgICBlbWFpbFZlcmlmaWNhdGlvbkFjdGl2aXR5OiBudW1iZXI7XG4gICAgICByZXNlbmRDb29sZG93bnM6IG51bWJlcjtcbiAgICAgIHNlY3VyaXR5RXZlbnRzOiBudW1iZXI7XG4gICAgfTtcbiAgICBjbGVhbnVwOiB7XG4gICAgICBsYXN0Q2xlYW51cDogbnVtYmVyO1xuICAgICAgaXNSdW5uaW5nOiBib29sZWFuO1xuICAgICAgbmV4dENsZWFudXBEdWU6IG51bWJlcjtcbiAgICB9O1xuICB9PiB7XG4gICAgY29uc3QgY29kZVN0YXRzID0gYXdhaXQgZW1haWxWZXJpZmljYXRpb25Db2RlU2VydmljZS5nZXRDb2RlU3RhdHMoKTtcbiAgICBjb25zdCByYXRlTGltaXRTdGF0cyA9IGVtYWlsVmVyaWZpY2F0aW9uUmF0ZUxpbWl0ZXIuZ2V0U3RhdHMoKTtcbiAgICBjb25zdCBjbGVhbnVwU3RhdHMgPSB0aGlzLmdldENsZWFudXBTdGF0cygpO1xuICAgIFxuICAgIC8vIEVzdGltYXRlIG5leHQgY2xlYW51cCB0aW1lIChhc3N1bWluZyBob3VybHkgY2xlYW51cClcbiAgICBjb25zdCBuZXh0Q2xlYW51cER1ZSA9IGNsZWFudXBTdGF0cy5sYXN0Q2xlYW51cCArICg2MCAqIDYwICogMTAwMCk7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHZlcmlmaWNhdGlvbkNvZGVzOiBjb2RlU3RhdHMsXG4gICAgICByYXRlTGltaXRzOiByYXRlTGltaXRTdGF0cyxcbiAgICAgIGNsZWFudXA6IHtcbiAgICAgICAgbGFzdENsZWFudXA6IGNsZWFudXBTdGF0cy5sYXN0Q2xlYW51cCxcbiAgICAgICAgaXNSdW5uaW5nOiBjbGVhbnVwU3RhdHMuaXNSdW5uaW5nLFxuICAgICAgICBuZXh0Q2xlYW51cER1ZSxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIEZvcmNlIGNsZWFudXAgaWYgbmVlZGVkIChmb3IgbWFudWFsIHRyaWdnZXJzKVxuICAgKi9cbiAgYXN5bmMgZm9yY2VDbGVhbnVwKCk6IFByb21pc2U8Q2xlYW51cFN0YXRzPiB7XG4gICAgaWYgKHRoaXMuaXNSdW5uaW5nKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NsZWFudXAgaXMgYWxyZWFkeSBydW5uaW5nLiBQbGVhc2Ugd2FpdCBmb3IgaXQgdG8gY29tcGxldGUuJyk7XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCdbQ0xFQU5VUF0gRm9yY2UgY2xlYW51cCByZXF1ZXN0ZWQnKTtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5ydW5DbGVhbnVwKCk7XG4gIH1cbn1cblxuLy8gRXhwb3J0IHNpbmdsZXRvbiBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IGVtYWlsVmVyaWZpY2F0aW9uQ2xlYW51cFNlcnZpY2UgPSBuZXcgRW1haWxWZXJpZmljYXRpb25DbGVhbnVwU2VydmljZSgpO1xuXG4vLyBBdXRvLXNjaGVkdWxlIGNsZWFudXAgd2hlbiB0aGlzIG1vZHVsZSBpcyBpbXBvcnRlZFxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicpIHtcbiAgLy8gSW4gcHJvZHVjdGlvbiwgc3RhcnQgY2xlYW51cCBhdXRvbWF0aWNhbGx5XG4gIGVtYWlsVmVyaWZpY2F0aW9uQ2xlYW51cFNlcnZpY2Uuc2NoZWR1bGVDbGVhbnVwKCk7XG59IGVsc2Uge1xuICAvLyBJbiBkZXZlbG9wbWVudCwgcnVuIGxlc3MgZnJlcXVlbnRseSB0byBhdm9pZCBub2lzZVxuICBlbWFpbFZlcmlmaWNhdGlvbkNsZWFudXBTZXJ2aWNlLnNjaGVkdWxlQ2xlYW51cCgyICogNjAgKiA2MCAqIDEwMDApOyAvLyAyIGhvdXJzXG59Il0sIm5hbWVzIjpbIkVtYWlsVmVyaWZpY2F0aW9uQ2xlYW51cFNlcnZpY2UiLCJlbWFpbFZlcmlmaWNhdGlvbkNsZWFudXBTZXJ2aWNlIiwicnVuQ2xlYW51cCIsImlzUnVubmluZyIsIkVycm9yIiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsImNvbnNvbGUiLCJsb2ciLCJleHBpcmVkQ29kZXMiLCJlbWFpbFZlcmlmaWNhdGlvbkNvZGVTZXJ2aWNlIiwiY2xlYW51cEV4cGlyZWRDb2RlcyIsInJhdGVMaW1pdFN0YXRzQmVmb3JlIiwiZW1haWxWZXJpZmljYXRpb25SYXRlTGltaXRlciIsImdldFN0YXRzIiwiY2xlYW51cCIsInJhdGVMaW1pdFN0YXRzQWZ0ZXIiLCJyYXRlTGltaXREYXRhQ2xlYW5lZCIsInZlcmlmaWNhdGlvbkF0dGVtcHRzIiwicmVzZW5kUmVxdWVzdHMiLCJlbWFpbFZlcmlmaWNhdGlvbkFjdGl2aXR5IiwicmVzZW5kQ29vbGRvd25zIiwic3RhdHMiLCJyYXRlTGltaXREYXRhIiwidGltZXN0YW1wIiwiY2xlYW51cFN0YXRzIiwicHVzaCIsImxlbmd0aCIsInNoaWZ0IiwibGFzdENsZWFudXAiLCJkdXJhdGlvbiIsImVycm9yIiwic2NoZWR1bGVDbGVhbnVwIiwiaW50ZXJ2YWxNcyIsInJ1blNjaGVkdWxlZENsZWFudXAiLCJzZXRUaW1lb3V0Iiwic2V0SW50ZXJ2YWwiLCJydW5TdGFydHVwQ2xlYW51cCIsImdldENsZWFudXBTdGF0cyIsInRvdGFsRXhwaXJlZENvZGVzIiwicmVkdWNlIiwic3VtIiwic3RhdCIsInRvdGFsUmF0ZUxpbWl0RGF0YSIsInJlY2VudFN0YXRzIiwiZ2V0U3lzdGVtU3RhdHVzIiwiY29kZVN0YXRzIiwiZ2V0Q29kZVN0YXRzIiwicmF0ZUxpbWl0U3RhdHMiLCJuZXh0Q2xlYW51cER1ZSIsInZlcmlmaWNhdGlvbkNvZGVzIiwicmF0ZUxpbWl0cyIsImZvcmNlQ2xlYW51cCIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7UUFXYUE7ZUFBQUE7O1FBZ0xBQztlQUFBQTs7O1FBM0xOOzhDQUNzQzs4Q0FDQTtBQVN0QyxNQUFNRDtJQUtYOztHQUVDLEdBQ0QsTUFBTUUsYUFBb0M7UUFDeEMsSUFBSSxJQUFJLENBQUNDLFNBQVMsRUFBRTtZQUNsQixNQUFNLElBQUlDLE1BQU07UUFDbEI7UUFFQSxJQUFJLENBQUNELFNBQVMsR0FBRztRQUNqQixNQUFNRSxZQUFZQyxLQUFLQyxHQUFHO1FBRTFCLElBQUk7WUFDRkMsUUFBUUMsR0FBRyxDQUFDO1lBRVosc0NBQXNDO1lBQ3RDLE1BQU1DLGVBQWUsTUFBTUMsMERBQTRCLENBQUNDLG1CQUFtQjtZQUMzRUosUUFBUUMsR0FBRyxDQUFDLENBQUMsa0JBQWtCLEVBQUVDLGFBQWEsMkJBQTJCLENBQUM7WUFFMUUsMkJBQTJCO1lBQzNCLE1BQU1HLHVCQUF1QkMsMERBQTRCLENBQUNDLFFBQVE7WUFDbEVELDBEQUE0QixDQUFDRSxPQUFPO1lBQ3BDLE1BQU1DLHNCQUFzQkgsMERBQTRCLENBQUNDLFFBQVE7WUFFakUsTUFBTUcsdUJBQ0osQUFBQ0wscUJBQXFCTSxvQkFBb0IsR0FBR0Ysb0JBQW9CRSxvQkFBb0IsR0FDcEZOLENBQUFBLHFCQUFxQk8sY0FBYyxHQUFHSCxvQkFBb0JHLGNBQWMsQUFBRCxJQUN2RVAsQ0FBQUEscUJBQXFCUSx5QkFBeUIsR0FBR0osb0JBQW9CSSx5QkFBeUIsQUFBRCxJQUM3RlIsQ0FBQUEscUJBQXFCUyxlQUFlLEdBQUdMLG9CQUFvQkssZUFBZSxBQUFEO1lBRTVFZCxRQUFRQyxHQUFHLENBQUMsQ0FBQyxxQkFBcUIsRUFBRVMscUJBQXFC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