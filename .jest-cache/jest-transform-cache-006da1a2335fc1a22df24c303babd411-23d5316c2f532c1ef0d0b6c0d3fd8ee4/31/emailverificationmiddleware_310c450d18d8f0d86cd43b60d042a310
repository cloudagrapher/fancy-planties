499b7515613682ed535045cb18c37ad1
"use strict";

/* istanbul ignore next */
function cov_2p8r0y8w0l() {
  var path = "/Users/stefanbekker/projects/fancy-planties/src/lib/auth/email-verification-middleware.ts";
  var hash = "c23fd05a13404366dcdbed7df9ea52fa739ea216";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/Users/stefanbekker/projects/fancy-planties/src/lib/auth/email-verification-middleware.ts",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 0
        },
        end: {
          line: 4,
          column: 3
        }
      },
      "1": {
        start: {
          line: 6,
          column: 4
        },
        end: {
          line: 9,
          column: 7
        }
      },
      "2": {
        start: {
          line: 6,
          column: 24
        },
        end: {
          line: 9,
          column: 7
        }
      },
      "3": {
        start: {
          line: 11,
          column: 0
        },
        end: {
          line: 24,
          column: 3
        }
      },
      "4": {
        start: {
          line: 13,
          column: 8
        },
        end: {
          line: 13,
          column: 46
        }
      },
      "5": {
        start: {
          line: 16,
          column: 8
        },
        end: {
          line: 16,
          column: 35
        }
      },
      "6": {
        start: {
          line: 19,
          column: 8
        },
        end: {
          line: 19,
          column: 38
        }
      },
      "7": {
        start: {
          line: 22,
          column: 8
        },
        end: {
          line: 22,
          column: 41
        }
      },
      "8": {
        start: {
          line: 25,
          column: 0
        },
        end: {
          line: 25,
          column: 23
        }
      },
      "9": {
        start: {
          line: 26,
          column: 16
        },
        end: {
          line: 26,
          column: 38
        }
      },
      "10": {
        start: {
          line: 27,
          column: 38
        },
        end: {
          line: 27,
          column: 92
        }
      },
      "11": {
        start: {
          line: 32,
          column: 25
        },
        end: {
          line: 32,
          column: 63
        }
      },
      "12": {
        start: {
          line: 33,
          column: 19
        },
        end: {
          line: 33,
          column: 51
        }
      },
      "13": {
        start: {
          line: 34,
          column: 23
        },
        end: {
          line: 34,
          column: 59
        }
      },
      "14": {
        start: {
          line: 35,
          column: 4
        },
        end: {
          line: 38,
          column: 5
        }
      },
      "15": {
        start: {
          line: 37,
          column: 8
        },
        end: {
          line: 37,
          column: 49
        }
      },
      "16": {
        start: {
          line: 39,
          column: 4
        },
        end: {
          line: 41,
          column: 5
        }
      },
      "17": {
        start: {
          line: 40,
          column: 8
        },
        end: {
          line: 40,
          column: 22
        }
      },
      "18": {
        start: {
          line: 42,
          column: 4
        },
        end: {
          line: 44,
          column: 5
        }
      },
      "19": {
        start: {
          line: 43,
          column: 8
        },
        end: {
          line: 43,
          column: 26
        }
      },
      "20": {
        start: {
          line: 46,
          column: 4
        },
        end: {
          line: 46,
          column: 21
        }
      },
      "21": {
        start: {
          line: 49,
          column: 4
        },
        end: {
          line: 162,
          column: 5
        }
      },
      "22": {
        start: {
          line: 50,
          column: 27
        },
        end: {
          line: 50,
          column: 55
        }
      },
      "23": {
        start: {
          line: 53,
          column: 8
        },
        end: {
          line: 80,
          column: 9
        }
      },
      "24": {
        start: {
          line: 54,
          column: 12
        },
        end: {
          line: 79,
          column: 13
        }
      },
      "25": {
        start: {
          line: 55,
          column: 29
        },
        end: {
          line: 55,
          column: 49
        }
      },
      "26": {
        start: {
          line: 56,
          column: 16
        },
        end: {
          line: 56,
          column: 50
        }
      },
      "27": {
        start: {
          line: 57,
          column: 16
        },
        end: {
          line: 63,
          column: 17
        }
      },
      "28": {
        start: {
          line: 58,
          column: 20
        },
        end: {
          line: 62,
          column: 23
        }
      },
      "29": {
        start: {
          line: 65,
          column: 35
        },
        end: {
          line: 69,
          column: 18
        }
      },
      "30": {
        start: {
          line: 71,
          column: 16
        },
        end: {
          line: 71,
          column: 46
        }
      },
      "31": {
        start: {
          line: 72,
          column: 16
        },
        end: {
          line: 72,
          column: 37
        }
      },
      "32": {
        start: {
          line: 74,
          column: 16
        },
        end: {
          line: 78,
          column: 19
        }
      },
      "33": {
        start: {
          line: 82,
          column: 8
        },
        end: {
          line: 99,
          column: 9
        }
      },
      "34": {
        start: {
          line: 83,
          column: 35
        },
        end: {
          line: 83,
          column: 143
        }
      },
      "35": {
        start: {
          line: 84,
          column: 12
        },
        end: {
          line: 98,
          column: 13
        }
      },
      "36": {
        start: {
          line: 85,
          column: 16
        },
        end: {
          line: 97,
          column: 19
        }
      },
      "37": {
        start: {
          line: 101,
          column: 8
        },
        end: {
          line: 118,
          column: 9
        }
      },
      "38": {
        start: {
          line: 102,
          column: 39
        },
        end: {
          line: 102,
          column: 142
        }
      },
      "39": {
        start: {
          line: 103,
          column: 12
        },
        end: {
          line: 117,
          column: 13
        }
      },
      "40": {
        start: {
          line: 104,
          column: 16
        },
        end: {
          line: 116,
          column: 19
        }
      },
      "41": {
        start: {
          line: 120,
          column: 8
        },
        end: {
          line: 139,
          column: 9
        }
      },
      "42": {
        start: {
          line: 121,
          column: 33
        },
        end: {
          line: 121,
          column: 130
        }
      },
      "43": {
        start: {
          line: 122,
          column: 12
        },
        end: {
          line: 138,
          column: 13
        }
      },
      "44": {
        start: {
          line: 123,
          column: 37
        },
        end: {
          line: 123,
          column: 224
        }
      },
      "45": {
        start: {
          line: 124,
          column: 16
        },
        end: {
          line: 137,
          column: 19
        }
      },
      "46": {
        start: {
          line: 141,
          column: 29
        },
        end: {
          line: 141,
          column: 131
        }
      },
      "47": {
        start: {
          line: 142,
          column: 8
        },
        end: {
          line: 147,
          column: 9
        }
      },
      "48": {
        start: {
          line: 144,
          column: 12
        },
        end: {
          line: 146,
          column: 15
        }
      },
      "49": {
        start: {
          line: 149,
          column: 25
        },
        end: {
          line: 149,
          column: 47
        }
      },
      "50": {
        start: {
          line: 151,
          column: 8
        },
        end: {
          line: 153,
          column: 9
        }
      },
      "51": {
        start: {
          line: 152,
          column: 12
        },
        end: {
          line: 152,
          column: 98
        }
      },
      "52": {
        start: {
          line: 154,
          column: 8
        },
        end: {
          line: 154,
          column: 24
        }
      },
      "53": {
        start: {
          line: 156,
          column: 8
        },
        end: {
          line: 156,
          column: 80
        }
      },
      "54": {
        start: {
          line: 157,
          column: 8
        },
        end: {
          line: 161,
          column: 11
        }
      },
      "55": {
        start: {
          line: 165,
          column: 4
        },
        end: {
          line: 169,
          column: 7
        }
      },
      "56": {
        start: {
          line: 172,
          column: 4
        },
        end: {
          line: 176,
          column: 7
        }
      },
      "57": {
        start: {
          line: 179,
          column: 4
        },
        end: {
          line: 198,
          column: 5
        }
      },
      "58": {
        start: {
          line: 180,
          column: 27
        },
        end: {
          line: 180,
          column: 55
        }
      },
      "59": {
        start: {
          line: 182,
          column: 31
        },
        end: {
          line: 182,
          column: 132
        }
      },
      "60": {
        start: {
          line: 183,
          column: 8
        },
        end: {
          line: 189,
          column: 9
        }
      },
      "61": {
        start: {
          line: 184,
          column: 12
        },
        end: {
          line: 188,
          column: 15
        }
      },
      "62": {
        start: {
          line: 190,
          column: 8
        },
        end: {
          line: 190,
          column: 38
        }
      },
      "63": {
        start: {
          line: 192,
          column: 8
        },
        end: {
          line: 192,
          column: 70
        }
      },
      "64": {
        start: {
          line: 193,
          column: 8
        },
        end: {
          line: 197,
          column: 11
        }
      }
    },
    fnMap: {
      "0": {
        name: "_export",
        decl: {
          start: {
            line: 5,
            column: 9
          },
          end: {
            line: 5,
            column: 16
          }
        },
        loc: {
          start: {
            line: 5,
            column: 30
          },
          end: {
            line: 10,
            column: 1
          }
        },
        line: 5
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 12,
            column: 4
          },
          end: {
            line: 12,
            column: 5
          }
        },
        loc: {
          start: {
            line: 12,
            column: 42
          },
          end: {
            line: 14,
            column: 5
          }
        },
        line: 12
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 15,
            column: 4
          },
          end: {
            line: 15,
            column: 5
          }
        },
        loc: {
          start: {
            line: 15,
            column: 31
          },
          end: {
            line: 17,
            column: 5
          }
        },
        line: 15
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 18,
            column: 4
          },
          end: {
            line: 18,
            column: 5
          }
        },
        loc: {
          start: {
            line: 18,
            column: 34
          },
          end: {
            line: 20,
            column: 5
          }
        },
        line: 18
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 21,
            column: 4
          },
          end: {
            line: 21,
            column: 5
          }
        },
        loc: {
          start: {
            line: 21,
            column: 37
          },
          end: {
            line: 23,
            column: 5
          }
        },
        line: 21
      },
      "5": {
        name: "getClientIdentifier",
        decl: {
          start: {
            line: 30,
            column: 13
          },
          end: {
            line: 30,
            column: 32
          }
        },
        loc: {
          start: {
            line: 30,
            column: 42
          },
          end: {
            line: 47,
            column: 1
          }
        },
        line: 30
      },
      "6": {
        name: "withEmailVerificationRateLimit",
        decl: {
          start: {
            line: 48,
            column: 15
          },
          end: {
            line: 48,
            column: 45
          }
        },
        loc: {
          start: {
            line: 48,
            column: 78
          },
          end: {
            line: 163,
            column: 1
          }
        },
        line: 48
      },
      "7": {
        name: "withVerificationRateLimit",
        decl: {
          start: {
            line: 164,
            column: 15
          },
          end: {
            line: 164,
            column: 40
          }
        },
        loc: {
          start: {
            line: 164,
            column: 59
          },
          end: {
            line: 170,
            column: 1
          }
        },
        line: 164
      },
      "8": {
        name: "withResendRateLimit",
        decl: {
          start: {
            line: 171,
            column: 15
          },
          end: {
            line: 171,
            column: 34
          }
        },
        loc: {
          start: {
            line: 171,
            column: 53
          },
          end: {
            line: 177,
            column: 1
          }
        },
        line: 171
      },
      "9": {
        name: "withSecurityMonitoring",
        decl: {
          start: {
            line: 178,
            column: 15
          },
          end: {
            line: 178,
            column: 37
          }
        },
        loc: {
          start: {
            line: 178,
            column: 56
          },
          end: {
            line: 199,
            column: 1
          }
        },
        line: 178
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 35,
            column: 4
          },
          end: {
            line: 38,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 35,
            column: 4
          },
          end: {
            line: 38,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 35
      },
      "1": {
        loc: {
          start: {
            line: 39,
            column: 4
          },
          end: {
            line: 41,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 39,
            column: 4
          },
          end: {
            line: 41,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 39
      },
      "2": {
        loc: {
          start: {
            line: 42,
            column: 4
          },
          end: {
            line: 44,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 42,
            column: 4
          },
          end: {
            line: 44,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 42
      },
      "3": {
        loc: {
          start: {
            line: 48,
            column: 64
          },
          end: {
            line: 48,
            column: 76
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 48,
            column: 74
          },
          end: {
            line: 48,
            column: 76
          }
        }],
        line: 48
      },
      "4": {
        loc: {
          start: {
            line: 53,
            column: 8
          },
          end: {
            line: 80,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 53,
            column: 8
          },
          end: {
            line: 80,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 53
      },
      "5": {
        loc: {
          start: {
            line: 53,
            column: 12
          },
          end: {
            line: 53,
            column: 63
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 53,
            column: 12
          },
          end: {
            line: 53,
            column: 32
          }
        }, {
          start: {
            line: 53,
            column: 36
          },
          end: {
            line: 53,
            column: 63
          }
        }],
        line: 53
      },
      "6": {
        loc: {
          start: {
            line: 57,
            column: 16
          },
          end: {
            line: 63,
            column: 17
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 57,
            column: 16
          },
          end: {
            line: 63,
            column: 17
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 57
      },
      "7": {
        loc: {
          start: {
            line: 57,
            column: 20
          },
          end: {
            line: 57,
            column: 50
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 57,
            column: 20
          },
          end: {
            line: 57,
            column: 40
          }
        }, {
          start: {
            line: 57,
            column: 44
          },
          end: {
            line: 57,
            column: 50
          }
        }],
        line: 57
      },
      "8": {
        loc: {
          start: {
            line: 82,
            column: 8
          },
          end: {
            line: 99,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 82,
            column: 8
          },
          end: {
            line: 99,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 82
      },
      "9": {
        loc: {
          start: {
            line: 84,
            column: 12
          },
          end: {
            line: 98,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 84,
            column: 12
          },
          end: {
            line: 98,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 84
      },
      "10": {
        loc: {
          start: {
            line: 95,
            column: 39
          },
          end: {
            line: 95,
            column: 86
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 95,
            column: 39
          },
          end: {
            line: 95,
            column: 76
          }
        }, {
          start: {
            line: 95,
            column: 80
          },
          end: {
            line: 95,
            column: 86
          }
        }],
        line: 95
      },
      "11": {
        loc: {
          start: {
            line: 101,
            column: 8
          },
          end: {
            line: 118,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 101,
            column: 8
          },
          end: {
            line: 118,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 101
      },
      "12": {
        loc: {
          start: {
            line: 103,
            column: 12
          },
          end: {
            line: 117,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 103,
            column: 12
          },
          end: {
            line: 117,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 103
      },
      "13": {
        loc: {
          start: {
            line: 114,
            column: 39
          },
          end: {
            line: 114,
            column: 90
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 114,
            column: 39
          },
          end: {
            line: 114,
            column: 80
          }
        }, {
          start: {
            line: 114,
            column: 84
          },
          end: {
            line: 114,
            column: 90
          }
        }],
        line: 114
      },
      "14": {
        loc: {
          start: {
            line: 120,
            column: 8
          },
          end: {
            line: 139,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 120,
            column: 8
          },
          end: {
            line: 139,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 120
      },
      "15": {
        loc: {
          start: {
            line: 120,
            column: 12
          },
          end: {
            line: 120,
            column: 48
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 120,
            column: 12
          },
          end: {
            line: 120,
            column: 39
          }
        }, {
          start: {
            line: 120,
            column: 43
          },
          end: {
            line: 120,
            column: 48
          }
        }],
        line: 120
      },
      "16": {
        loc: {
          start: {
            line: 122,
            column: 12
          },
          end: {
            line: 138,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 122,
            column: 12
          },
          end: {
            line: 138,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 122
      },
      "17": {
        loc: {
          start: {
            line: 123,
            column: 37
          },
          end: {
            line: 123,
            column: 224
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 123,
            column: 70
          },
          end: {
            line: 123,
            column: 170
          }
        }, {
          start: {
            line: 123,
            column: 173
          },
          end: {
            line: 123,
            column: 224
          }
        }],
        line: 123
      },
      "18": {
        loc: {
          start: {
            line: 135,
            column: 39
          },
          end: {
            line: 135,
            column: 82
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 135,
            column: 39
          },
          end: {
            line: 135,
            column: 74
          }
        }, {
          start: {
            line: 135,
            column: 78
          },
          end: {
            line: 135,
            column: 82
          }
        }],
        line: 135
      },
      "19": {
        loc: {
          start: {
            line: 142,
            column: 8
          },
          end: {
            line: 147,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 142,
            column: 8
          },
          end: {
            line: 147,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 142
      },
      "20": {
        loc: {
          start: {
            line: 151,
            column: 8
          },
          end: {
            line: 153,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 151,
            column: 8
          },
          end: {
            line: 153,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 151
      },
      "21": {
        loc: {
          start: {
            line: 151,
            column: 12
          },
          end: {
            line: 151,
            column: 75
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 151,
            column: 12
          },
          end: {
            line: 151,
            column: 39
          }
        }, {
          start: {
            line: 151,
            column: 43
          },
          end: {
            line: 151,
            column: 48
          }
        }, {
          start: {
            line: 151,
            column: 52
          },
          end: {
            line: 151,
            column: 75
          }
        }],
        line: 151
      },
      "22": {
        loc: {
          start: {
            line: 183,
            column: 8
          },
          end: {
            line: 189,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 183,
            column: 8
          },
          end: {
            line: 189,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 183
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0,
      "48": 0,
      "49": 0,
      "50": 0,
      "51": 0,
      "52": 0,
      "53": 0,
      "54": 0,
      "55": 0,
      "56": 0,
      "57": 0,
      "58": 0,
      "59": 0,
      "60": 0,
      "61": 0,
      "62": 0,
      "63": 0,
      "64": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0],
      "11": [0, 0],
      "12": [0, 0],
      "13": [0, 0],
      "14": [0, 0],
      "15": [0, 0],
      "16": [0, 0],
      "17": [0, 0],
      "18": [0, 0],
      "19": [0, 0],
      "20": [0, 0],
      "21": [0, 0, 0],
      "22": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      sources: ["/Users/stefanbekker/projects/fancy-planties/src/lib/auth/email-verification-middleware.ts"],
      sourcesContent: ["import 'server-only';\nimport { NextRequest, NextResponse } from 'next/server';\nimport { emailVerificationRateLimiter } from '@/lib/services/email-verification-rate-limiter';\n\n/**\n * Get client identifier for rate limiting\n */\nfunction getClientIdentifier(request: NextRequest): string {\n  // Try to get real IP address\n  const forwardedFor = request.headers.get('x-forwarded-for');\n  const realIp = request.headers.get('x-real-ip');\n  const remoteAddr = request.headers.get('x-remote-addr');\n  \n  if (forwardedFor) {\n    // x-forwarded-for can contain multiple IPs, take the first one\n    return forwardedFor.split(',')[0].trim();\n  }\n  \n  if (realIp) {\n    return realIp;\n  }\n  \n  if (remoteAddr) {\n    return remoteAddr;\n  }\n  \n  // Fallback identifier\n  return 'unknown';\n}\n\n/**\n * Enhanced rate limiting middleware for email verification endpoints\n */\nexport async function withEmailVerificationRateLimit(\n  request: NextRequest,\n  handler: (request: NextRequest) => Promise<NextResponse>,\n  options: {\n    checkVerificationAttempts?: boolean;\n    checkResendRequests?: boolean;\n    checkOverallActivity?: boolean;\n    requireEmail?: boolean;\n  } = {}\n): Promise<NextResponse> {\n  try {\n    const identifier = getClientIdentifier(request);\n    let email: string | undefined;\n    \n    // Extract email from request body if needed\n    if (options.requireEmail || options.checkResendRequests) {\n      try {\n        const body = await request.json();\n        email = body.email?.toLowerCase();\n        \n        if (options.requireEmail && !email) {\n          return NextResponse.json(\n            { error: 'Email is required' },\n            { status: 400 }\n          );\n        }\n        \n        // Create a new request with the parsed body for the handler\n        const newRequest = new NextRequest(request.url, {\n          method: request.method,\n          headers: request.headers,\n          body: JSON.stringify(body),\n        });\n        \n        // Copy the parsed body to the new request for the handler to use\n        (newRequest as any)._parsedBody = body;\n        request = newRequest;\n      } catch (error) {\n        return NextResponse.json(\n          { error: 'Invalid JSON in request body' },\n          { status: 400 }\n        );\n      }\n    }\n    \n    // Check overall email verification activity first\n    if (options.checkOverallActivity !== false) {\n      const activityResult = emailVerificationRateLimiter.checkEmailVerificationActivity(identifier, email);\n      \n      if (!activityResult.allowed) {\n        return NextResponse.json(\n          {\n            error: 'Too many email verification requests. Please try again later.',\n            retryAfter: activityResult.retryAfter,\n            resetTime: activityResult.resetTime,\n          },\n          {\n            status: 429,\n            headers: {\n              'X-RateLimit-Limit': '20',\n              'X-RateLimit-Remaining': activityResult.remaining.toString(),\n              'X-RateLimit-Reset': activityResult.resetTime.toString(),\n              'Retry-After': activityResult.retryAfter?.toString() || '3600',\n            },\n          }\n        );\n      }\n    }\n    \n    // Check verification attempts rate limit\n    if (options.checkVerificationAttempts) {\n      const verificationResult = emailVerificationRateLimiter.checkVerificationAttempts(identifier, email);\n      \n      if (!verificationResult.allowed) {\n        return NextResponse.json(\n          {\n            error: 'Too many verification attempts. Please try again later.',\n            retryAfter: verificationResult.retryAfter,\n            resetTime: verificationResult.resetTime,\n          },\n          {\n            status: 429,\n            headers: {\n              'X-RateLimit-Limit': '10',\n              'X-RateLimit-Remaining': verificationResult.remaining.toString(),\n              'X-RateLimit-Reset': verificationResult.resetTime.toString(),\n              'Retry-After': verificationResult.retryAfter?.toString() || '3600',\n            },\n          }\n        );\n      }\n    }\n    \n    // Check resend requests rate limit\n    if (options.checkResendRequests && email) {\n      const resendResult = emailVerificationRateLimiter.checkResendRequests(email, identifier);\n      \n      if (!resendResult.allowed) {\n        const errorMessage = resendResult.cooldownRemaining\n          ? `Please wait ${resendResult.cooldownRemaining} seconds before requesting another verification code.`\n          : 'Too many resend requests. Please try again later.';\n        \n        return NextResponse.json(\n          {\n            error: errorMessage,\n            retryAfter: resendResult.retryAfter,\n            resetTime: resendResult.resetTime,\n            cooldownSeconds: resendResult.cooldownRemaining,\n          },\n          {\n            status: 429,\n            headers: {\n              'X-RateLimit-Limit': '5',\n              'X-RateLimit-Remaining': resendResult.remaining.toString(),\n              'X-RateLimit-Reset': resendResult.resetTime.toString(),\n              'Retry-After': resendResult.retryAfter?.toString() || '60',\n            },\n          }\n        );\n      }\n    }\n    \n    // Check for suspicious activity\n    const isSuspicious = emailVerificationRateLimiter.detectSuspiciousActivity(identifier, email);\n    if (isSuspicious) {\n      // For now, just log it. In production, you might want to add additional restrictions\n      console.warn(`Suspicious email verification activity detected from ${identifier}`, { email });\n    }\n    \n    // Call the handler\n    const response = await handler(request);\n    \n    // Record successful resend if applicable\n    if (options.checkResendRequests && email && response.status === 200) {\n      emailVerificationRateLimiter.recordResendSuccess(email);\n    }\n    \n    return response;\n    \n  } catch (error) {\n    console.error('Email verification rate limit middleware error:', error);\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    );\n  }\n}\n\n/**\n * Middleware specifically for verification attempts\n */\nexport async function withVerificationRateLimit(\n  request: NextRequest,\n  handler: (request: NextRequest) => Promise<NextResponse>\n): Promise<NextResponse> {\n  return withEmailVerificationRateLimit(request, handler, {\n    checkVerificationAttempts: true,\n    checkOverallActivity: true,\n    requireEmail: true,\n  });\n}\n\n/**\n * Middleware specifically for resend requests\n */\nexport async function withResendRateLimit(\n  request: NextRequest,\n  handler: (request: NextRequest) => Promise<NextResponse>\n): Promise<NextResponse> {\n  return withEmailVerificationRateLimit(request, handler, {\n    checkResendRequests: true,\n    checkOverallActivity: true,\n    requireEmail: true,\n  });\n}\n\n/**\n * Security monitoring endpoint middleware\n */\nexport async function withSecurityMonitoring(\n  request: NextRequest,\n  handler: (request: NextRequest) => Promise<NextResponse>\n): Promise<NextResponse> {\n  try {\n    const identifier = getClientIdentifier(request);\n    \n    // Basic rate limiting for monitoring endpoints\n    const activityResult = emailVerificationRateLimiter.checkEmailVerificationActivity(identifier);\n    \n    if (!activityResult.allowed) {\n      return NextResponse.json(\n        { error: 'Too many requests' },\n        { status: 429 }\n      );\n    }\n    \n    return await handler(request);\n    \n  } catch (error) {\n    console.error('Security monitoring middleware error:', error);\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    );\n  }\n}"],
      names: ["withEmailVerificationRateLimit", "withResendRateLimit", "withSecurityMonitoring", "withVerificationRateLimit", "getClientIdentifier", "request", "forwardedFor", "headers", "get", "realIp", "remoteAddr", "split", "trim", "handler", "options", "identifier", "email", "requireEmail", "checkResendRequests", "body", "json", "toLowerCase", "NextResponse", "error", "status", "newRequest", "NextRequest", "url", "method", "JSON", "stringify", "_parsedBody", "checkOverallActivity", "activityResult", "emailVerificationRateLimiter", "checkEmailVerificationActivity", "allowed", "retryAfter", "resetTime", "remaining", "toString", "checkVerificationAttempts", "verificationResult", "resendResult", "errorMessage", "cooldownRemaining", "cooldownSeconds", "isSuspicious", "detectSuspiciousActivity", "console", "warn", "response", "recordResendSuccess"],
      mappings: ";;;;;;;;;;;QAiCsBA;eAAAA;;QAqKAC;eAAAA;;QAcAC;eAAAA;;QA5BAC;eAAAA;;;QAxLf;wBACmC;8CACG;AAE7C;;CAEC,GACD,SAASC,oBAAoBC,OAAoB;IAC/C,6BAA6B;IAC7B,MAAMC,eAAeD,QAAQE,OAAO,CAACC,GAAG,CAAC;IACzC,MAAMC,SAASJ,QAAQE,OAAO,CAACC,GAAG,CAAC;IACnC,MAAME,aAAaL,QAAQE,OAAO,CAACC,GAAG,CAAC;IAEvC,IAAIF,cAAc;QAChB,+DAA+D;QAC/D,OAAOA,aAAaK,KAAK,CAAC,IAAI,CAAC,EAAE,CAACC,IAAI;IACxC;IAEA,IAAIH,QAAQ;QACV,OAAOA;IACT;IAEA,IAAIC,YAAY;QACd,OAAOA;IACT;IAEA,sBAAsB;IACtB,OAAO;AACT;AAKO,eAAeV,+BACpBK,OAAoB,EACpBQ,OAAwD,EACxDC,UAKI,CAAC,CAAC;IAEN,IAAI;QACF,MAAMC,aAAaX,oBAAoBC;QACvC,IAAIW;QAEJ,4CAA4C;QAC5C,IAAIF,QAAQG,YAAY,IAAIH,QAAQI,mBAAmB,EAAE;YACvD,IAAI;gBACF,MAAMC,OAAO,MAAMd,QAAQe,IAAI;gBAC/BJ,QAAQG,KAAKH,KAAK,EAAEK;gBAEpB,IAAIP,QAAQG,YAAY,IAAI,CAACD,OAAO;oBAClC,OAAOM,oBAAY,CAACF,IAAI,CACtB;wBAAEG,OAAO;oBAAoB,GAC7B;wBAAEC,QAAQ;oBAAI;gBAElB;gBAEA,4DAA4D;gBAC5D,MAAMC,aAAa,IAAIC,mBAAW,CAACrB,QAAQsB,GAAG,EAAE;oBAC9CC,QAAQvB,QAAQuB,MAAM;oBACtBrB,SAASF,QAAQE,OAAO;oBACxBY,MAAMU,KAAKC,SAAS,CAACX;gBACvB;gBAEA,iEAAiE;gBAChEM,WAAmBM,WAAW,GAAGZ;gBAClCd,UAAUoB;YACZ,EAAE,OAAOF,OAAO;gBACd,OAAOD,oBAAY,CAACF,IAAI,CACtB;oBAAEG,OAAO;gBAA+B,GACxC;oBAAEC,QAAQ;gBAAI;YAElB;QACF;QAEA,kDAAkD;QAClD,IAAIV,QAAQkB,oBAAoB,KAAK,OAAO;YAC1C,MAAMC,iBAAiBC,0DAA4B,CAACC,8BAA8B,CAACpB,YAAYC;YAE/F,IAAI,CAACiB,eAAeG,OAAO,EAAE;gBAC3B,OAAOd,oBAAY,CAACF,IAAI,CACtB;oBACEG,OAAO;oBACPc,YAAYJ,eAAeI,UAAU;oBACrCC,WAAWL,eAAeK,SAAS;gBACrC,GACA;oBACEd,QAAQ;oBACRjB,SAAS;wBACP,qBAAqB;wBACrB,yBAAyB0B,eAAeM,SAAS,CAACC,QAAQ;wBAC1D,qBAAqBP,eAAeK,SAAS,CAACE,QAAQ;wBACtD,eAAeP,eAAeI,UAAU,EAAEG,cAAc;oBAC1D;gBACF;YAEJ;QACF;QAEA,yCAAyC;QACzC,IAAI1B,QAAQ2B,yBAAyB,EAAE;YACrC,MAAMC,qBAAqBR,0DAA4B,CAACO,yBAAyB,CAAC1B,YAAYC;YAE9F,IAAI,CAAC0B,mBAAmBN,OAAO,EAAE;gBAC/B,OAAOd,oBAAY,CAACF,IAAI,CACtB;oBACEG,OAAO;oBACPc,YAAYK,mBAAmBL,UAAU;oBACzCC,WAAWI,mBAAmBJ,SAAS;gBACzC,GACA;oBACEd,QAAQ;oBACRjB,SAAS;wBACP,qBAAqB;wBACrB,yBAAyBmC,mBAAmBH,SAAS,CAACC,QAAQ;wBAC9D,qBAAqBE,mBAAmBJ,SAAS,CAACE,QAAQ;wBAC1D,eAAeE,mBAAmBL,UAAU,EAAEG,cAAc;oBAC9D;gBACF;YAEJ;QACF;QAEA,mCAAmC;QACnC,IAAI1B,QAAQI,mBAAmB,IAAIF,OAAO;YACxC,MAAM2B,eAAeT,0DAA4B,CAAChB,mBAAmB,CAACF,OAAOD;YAE7E,IAAI,CAAC4B,aAAaP,OAAO,EAAE;gBACzB,MAAMQ,eAAeD,aAAaE,iBAAiB,GAC/C,CAAC,YAAY,EAAEF,aAAaE,iBAAiB,CAAC,qDAAqD,CAAC,GACpG;gBAEJ,OAAOvB,oBAAY,CAACF,IAAI,CACtB;oBACEG,OAAOqB;oBACPP,YAAYM,aAAaN,UAAU;oBACnCC,WAAWK,aAAaL,SAAS;oBACjCQ,iBAAiBH,aAAaE,iBAAiB;gBACjD,GACA;oBACErB,QAAQ;oBACRjB,SAAS;wBACP,qBAAqB;wBACrB,yBAAyBoC,aAAaJ,SAAS,CAACC,QAAQ;wBACxD,qBAAqBG,aAAaL,SAAS,CAACE,QAAQ;wBACpD,eAAeG,aAAaN,UAAU,EAAEG,cAAc;oBACxD;gBACF;YAEJ;QACF;QAEA,gCAAgC;QAChC,MAAMO,eAAeb,0DAA4B,CAACc,wBAAwB,CAACjC,YAAYC;QACvF,IAAI+B,cAAc;YAChB,qFAAqF;YACrFE,QAAQC,IAAI,CAAC,CAAC,qDAAqD,EAAEnC,YAAY,EAAE;gBAAEC;YAAM;QAC7F;QAEA,mBAAmB;QACnB,MAAMmC,WAAW,MAAMtC,QAAQR;QAE/B,yCAAyC;QACzC,IAAIS,QAAQI,mBAAmB,IAAIF,SAASmC,SAAS3B,MAAM,KAAK,KAAK;YACnEU,0DAA4B,CAACkB,mBAAmB,CAACpC;QACnD;QAEA,OAAOmC;IAET,EAAE,OAAO5B,OAAO;QACd0B,QAAQ1B,KAAK,CAAC,mDAAmDA;QACjE,OAAOD,oBAAY,CAACF,IAAI,CACtB;YAAEG,OAAO;QAAwB,GACjC;YAAEC,QAAQ;QAAI;IAElB;AACF;AAKO,eAAerB,0BACpBE,OAAoB,EACpBQ,OAAwD;IAExD,OAAOb,+BAA+BK,SAASQ,SAAS;QACtD4B,2BAA2B;QAC3BT,sBAAsB;QACtBf,cAAc;IAChB;AACF;AAKO,eAAehB,oBACpBI,OAAoB,EACpBQ,OAAwD;IAExD,OAAOb,+BAA+BK,SAASQ,SAAS;QACtDK,qBAAqB;QACrBc,sBAAsB;QACtBf,cAAc;IAChB;AACF;AAKO,eAAef,uBACpBG,OAAoB,EACpBQ,OAAwD;IAExD,IAAI;QACF,MAAME,aAAaX,oBAAoBC;QAEvC,+CAA+C;QAC/C,MAAM4B,iBAAiBC,0DAA4B,CAACC,8BAA8B,CAACpB;QAEnF,IAAI,CAACkB,eAAeG,OAAO,EAAE;YAC3B,OAAOd,oBAAY,CAACF,IAAI,CACtB;gBAAEG,OAAO;YAAoB,GAC7B;gBAAEC,QAAQ;YAAI;QAElB;QAEA,OAAO,MAAMX,QAAQR;IAEvB,EAAE,OAAOkB,OAAO;QACd0B,QAAQ1B,KAAK,CAAC,yCAAyCA;QACvD,OAAOD,oBAAY,CAACF,IAAI,CACtB;YAAEG,OAAO;QAAwB,GACjC;YAAEC,QAAQ;QAAI;IAElB;AACF"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "c23fd05a13404366dcdbed7df9ea52fa739ea216"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_2p8r0y8w0l = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_2p8r0y8w0l();
cov_2p8r0y8w0l().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
function _export(target, all) {
  /* istanbul ignore next */
  cov_2p8r0y8w0l().f[0]++;
  cov_2p8r0y8w0l().s[1]++;
  for (var name in all) {
    /* istanbul ignore next */
    cov_2p8r0y8w0l().s[2]++;
    Object.defineProperty(target, name, {
      enumerable: true,
      get: Object.getOwnPropertyDescriptor(all, name).get
    });
  }
}
/* istanbul ignore next */
cov_2p8r0y8w0l().s[3]++;
_export(exports, {
  get withEmailVerificationRateLimit() {
    /* istanbul ignore next */
    cov_2p8r0y8w0l().f[1]++;
    cov_2p8r0y8w0l().s[4]++;
    return withEmailVerificationRateLimit;
  },
  get withResendRateLimit() {
    /* istanbul ignore next */
    cov_2p8r0y8w0l().f[2]++;
    cov_2p8r0y8w0l().s[5]++;
    return withResendRateLimit;
  },
  get withSecurityMonitoring() {
    /* istanbul ignore next */
    cov_2p8r0y8w0l().f[3]++;
    cov_2p8r0y8w0l().s[6]++;
    return withSecurityMonitoring;
  },
  get withVerificationRateLimit() {
    /* istanbul ignore next */
    cov_2p8r0y8w0l().f[4]++;
    cov_2p8r0y8w0l().s[7]++;
    return withVerificationRateLimit;
  }
});
/* istanbul ignore next */
cov_2p8r0y8w0l().s[8]++;
require("server-only");
const _server =
/* istanbul ignore next */
(cov_2p8r0y8w0l().s[9]++, require("next/server"));
const _emailverificationratelimiter =
/* istanbul ignore next */
(cov_2p8r0y8w0l().s[10]++, require("../services/email-verification-rate-limiter"));
/**
 * Get client identifier for rate limiting
 */
function getClientIdentifier(request) {
  /* istanbul ignore next */
  cov_2p8r0y8w0l().f[5]++;
  // Try to get real IP address
  const forwardedFor =
  /* istanbul ignore next */
  (cov_2p8r0y8w0l().s[11]++, request.headers.get('x-forwarded-for'));
  const realIp =
  /* istanbul ignore next */
  (cov_2p8r0y8w0l().s[12]++, request.headers.get('x-real-ip'));
  const remoteAddr =
  /* istanbul ignore next */
  (cov_2p8r0y8w0l().s[13]++, request.headers.get('x-remote-addr'));
  /* istanbul ignore next */
  cov_2p8r0y8w0l().s[14]++;
  if (forwardedFor) {
    /* istanbul ignore next */
    cov_2p8r0y8w0l().b[0][0]++;
    cov_2p8r0y8w0l().s[15]++;
    // x-forwarded-for can contain multiple IPs, take the first one
    return forwardedFor.split(',')[0].trim();
  } else
  /* istanbul ignore next */
  {
    cov_2p8r0y8w0l().b[0][1]++;
  }
  cov_2p8r0y8w0l().s[16]++;
  if (realIp) {
    /* istanbul ignore next */
    cov_2p8r0y8w0l().b[1][0]++;
    cov_2p8r0y8w0l().s[17]++;
    return realIp;
  } else
  /* istanbul ignore next */
  {
    cov_2p8r0y8w0l().b[1][1]++;
  }
  cov_2p8r0y8w0l().s[18]++;
  if (remoteAddr) {
    /* istanbul ignore next */
    cov_2p8r0y8w0l().b[2][0]++;
    cov_2p8r0y8w0l().s[19]++;
    return remoteAddr;
  } else
  /* istanbul ignore next */
  {
    cov_2p8r0y8w0l().b[2][1]++;
  }
  // Fallback identifier
  cov_2p8r0y8w0l().s[20]++;
  return 'unknown';
}
async function withEmailVerificationRateLimit(request, handler, options =
/* istanbul ignore next */
(cov_2p8r0y8w0l().b[3][0]++, {})) {
  /* istanbul ignore next */
  cov_2p8r0y8w0l().f[6]++;
  cov_2p8r0y8w0l().s[21]++;
  try {
    const identifier =
    /* istanbul ignore next */
    (cov_2p8r0y8w0l().s[22]++, getClientIdentifier(request));
    let email;
    // Extract email from request body if needed
    /* istanbul ignore next */
    cov_2p8r0y8w0l().s[23]++;
    if (
    /* istanbul ignore next */
    (cov_2p8r0y8w0l().b[5][0]++, options.requireEmail) ||
    /* istanbul ignore next */
    (cov_2p8r0y8w0l().b[5][1]++, options.checkResendRequests)) {
      /* istanbul ignore next */
      cov_2p8r0y8w0l().b[4][0]++;
      cov_2p8r0y8w0l().s[24]++;
      try {
        const body =
        /* istanbul ignore next */
        (cov_2p8r0y8w0l().s[25]++, await request.json());
        /* istanbul ignore next */
        cov_2p8r0y8w0l().s[26]++;
        email = body.email?.toLowerCase();
        /* istanbul ignore next */
        cov_2p8r0y8w0l().s[27]++;
        if (
        /* istanbul ignore next */
        (cov_2p8r0y8w0l().b[7][0]++, options.requireEmail) &&
        /* istanbul ignore next */
        (cov_2p8r0y8w0l().b[7][1]++, !email)) {
          /* istanbul ignore next */
          cov_2p8r0y8w0l().b[6][0]++;
          cov_2p8r0y8w0l().s[28]++;
          return _server.NextResponse.json({
            error: 'Email is required'
          }, {
            status: 400
          });
        } else
        /* istanbul ignore next */
        {
          cov_2p8r0y8w0l().b[6][1]++;
        }
        // Create a new request with the parsed body for the handler
        const newRequest =
        /* istanbul ignore next */
        (cov_2p8r0y8w0l().s[29]++, new _server.NextRequest(request.url, {
          method: request.method,
          headers: request.headers,
          body: JSON.stringify(body)
        }));
        // Copy the parsed body to the new request for the handler to use
        /* istanbul ignore next */
        cov_2p8r0y8w0l().s[30]++;
        newRequest._parsedBody = body;
        /* istanbul ignore next */
        cov_2p8r0y8w0l().s[31]++;
        request = newRequest;
      } catch (error) {
        /* istanbul ignore next */
        cov_2p8r0y8w0l().s[32]++;
        return _server.NextResponse.json({
          error: 'Invalid JSON in request body'
        }, {
          status: 400
        });
      }
    } else
    /* istanbul ignore next */
    {
      cov_2p8r0y8w0l().b[4][1]++;
    }
    // Check overall email verification activity first
    cov_2p8r0y8w0l().s[33]++;
    if (options.checkOverallActivity !== false) {
      /* istanbul ignore next */
      cov_2p8r0y8w0l().b[8][0]++;
      const activityResult =
      /* istanbul ignore next */
      (cov_2p8r0y8w0l().s[34]++, _emailverificationratelimiter.emailVerificationRateLimiter.checkEmailVerificationActivity(identifier, email));
      /* istanbul ignore next */
      cov_2p8r0y8w0l().s[35]++;
      if (!activityResult.allowed) {
        /* istanbul ignore next */
        cov_2p8r0y8w0l().b[9][0]++;
        cov_2p8r0y8w0l().s[36]++;
        return _server.NextResponse.json({
          error: 'Too many email verification requests. Please try again later.',
          retryAfter: activityResult.retryAfter,
          resetTime: activityResult.resetTime
        }, {
          status: 429,
          headers: {
            'X-RateLimit-Limit': '20',
            'X-RateLimit-Remaining': activityResult.remaining.toString(),
            'X-RateLimit-Reset': activityResult.resetTime.toString(),
            'Retry-After':
            /* istanbul ignore next */
            (cov_2p8r0y8w0l().b[10][0]++, activityResult.retryAfter?.toString()) ||
            /* istanbul ignore next */
            (cov_2p8r0y8w0l().b[10][1]++, '3600')
          }
        });
      } else
      /* istanbul ignore next */
      {
        cov_2p8r0y8w0l().b[9][1]++;
      }
    } else
    /* istanbul ignore next */
    {
      cov_2p8r0y8w0l().b[8][1]++;
    }
    // Check verification attempts rate limit
    cov_2p8r0y8w0l().s[37]++;
    if (options.checkVerificationAttempts) {
      /* istanbul ignore next */
      cov_2p8r0y8w0l().b[11][0]++;
      const verificationResult =
      /* istanbul ignore next */
      (cov_2p8r0y8w0l().s[38]++, _emailverificationratelimiter.emailVerificationRateLimiter.checkVerificationAttempts(identifier, email));
      /* istanbul ignore next */
      cov_2p8r0y8w0l().s[39]++;
      if (!verificationResult.allowed) {
        /* istanbul ignore next */
        cov_2p8r0y8w0l().b[12][0]++;
        cov_2p8r0y8w0l().s[40]++;
        return _server.NextResponse.json({
          error: 'Too many verification attempts. Please try again later.',
          retryAfter: verificationResult.retryAfter,
          resetTime: verificationResult.resetTime
        }, {
          status: 429,
          headers: {
            'X-RateLimit-Limit': '10',
            'X-RateLimit-Remaining': verificationResult.remaining.toString(),
            'X-RateLimit-Reset': verificationResult.resetTime.toString(),
            'Retry-After':
            /* istanbul ignore next */
            (cov_2p8r0y8w0l().b[13][0]++, verificationResult.retryAfter?.toString()) ||
            /* istanbul ignore next */
            (cov_2p8r0y8w0l().b[13][1]++, '3600')
          }
        });
      } else
      /* istanbul ignore next */
      {
        cov_2p8r0y8w0l().b[12][1]++;
      }
    } else
    /* istanbul ignore next */
    {
      cov_2p8r0y8w0l().b[11][1]++;
    }
    // Check resend requests rate limit
    cov_2p8r0y8w0l().s[41]++;
    if (
    /* istanbul ignore next */
    (cov_2p8r0y8w0l().b[15][0]++, options.checkResendRequests) &&
    /* istanbul ignore next */
    (cov_2p8r0y8w0l().b[15][1]++, email)) {
      /* istanbul ignore next */
      cov_2p8r0y8w0l().b[14][0]++;
      const resendResult =
      /* istanbul ignore next */
      (cov_2p8r0y8w0l().s[42]++, _emailverificationratelimiter.emailVerificationRateLimiter.checkResendRequests(email, identifier));
      /* istanbul ignore next */
      cov_2p8r0y8w0l().s[43]++;
      if (!resendResult.allowed) {
        /* istanbul ignore next */
        cov_2p8r0y8w0l().b[16][0]++;
        const errorMessage =
        /* istanbul ignore next */
        (cov_2p8r0y8w0l().s[44]++, resendResult.cooldownRemaining ?
        /* istanbul ignore next */
        (cov_2p8r0y8w0l().b[17][0]++, `Please wait ${resendResult.cooldownRemaining} seconds before requesting another verification code.`) :
        /* istanbul ignore next */
        (cov_2p8r0y8w0l().b[17][1]++, 'Too many resend requests. Please try again later.'));
        /* istanbul ignore next */
        cov_2p8r0y8w0l().s[45]++;
        return _server.NextResponse.json({
          error: errorMessage,
          retryAfter: resendResult.retryAfter,
          resetTime: resendResult.resetTime,
          cooldownSeconds: resendResult.cooldownRemaining
        }, {
          status: 429,
          headers: {
            'X-RateLimit-Limit': '5',
            'X-RateLimit-Remaining': resendResult.remaining.toString(),
            'X-RateLimit-Reset': resendResult.resetTime.toString(),
            'Retry-After':
            /* istanbul ignore next */
            (cov_2p8r0y8w0l().b[18][0]++, resendResult.retryAfter?.toString()) ||
            /* istanbul ignore next */
            (cov_2p8r0y8w0l().b[18][1]++, '60')
          }
        });
      } else
      /* istanbul ignore next */
      {
        cov_2p8r0y8w0l().b[16][1]++;
      }
    } else
    /* istanbul ignore next */
    {
      cov_2p8r0y8w0l().b[14][1]++;
    }
    // Check for suspicious activity
    const isSuspicious =
    /* istanbul ignore next */
    (cov_2p8r0y8w0l().s[46]++, _emailverificationratelimiter.emailVerificationRateLimiter.detectSuspiciousActivity(identifier, email));
    /* istanbul ignore next */
    cov_2p8r0y8w0l().s[47]++;
    if (isSuspicious) {
      /* istanbul ignore next */
      cov_2p8r0y8w0l().b[19][0]++;
      cov_2p8r0y8w0l().s[48]++;
      // For now, just log it. In production, you might want to add additional restrictions
      console.warn(`Suspicious email verification activity detected from ${identifier}`, {
        email
      });
    } else
    /* istanbul ignore next */
    {
      cov_2p8r0y8w0l().b[19][1]++;
    }
    // Call the handler
    const response =
    /* istanbul ignore next */
    (cov_2p8r0y8w0l().s[49]++, await handler(request));
    // Record successful resend if applicable
    /* istanbul ignore next */
    cov_2p8r0y8w0l().s[50]++;
    if (
    /* istanbul ignore next */
    (cov_2p8r0y8w0l().b[21][0]++, options.checkResendRequests) &&
    /* istanbul ignore next */
    (cov_2p8r0y8w0l().b[21][1]++, email) &&
    /* istanbul ignore next */
    (cov_2p8r0y8w0l().b[21][2]++, response.status === 200)) {
      /* istanbul ignore next */
      cov_2p8r0y8w0l().b[20][0]++;
      cov_2p8r0y8w0l().s[51]++;
      _emailverificationratelimiter.emailVerificationRateLimiter.recordResendSuccess(email);
    } else
    /* istanbul ignore next */
    {
      cov_2p8r0y8w0l().b[20][1]++;
    }
    cov_2p8r0y8w0l().s[52]++;
    return response;
  } catch (error) {
    /* istanbul ignore next */
    cov_2p8r0y8w0l().s[53]++;
    console.error('Email verification rate limit middleware error:', error);
    /* istanbul ignore next */
    cov_2p8r0y8w0l().s[54]++;
    return _server.NextResponse.json({
      error: 'Internal server error'
    }, {
      status: 500
    });
  }
}
async function withVerificationRateLimit(request, handler) {
  /* istanbul ignore next */
  cov_2p8r0y8w0l().f[7]++;
  cov_2p8r0y8w0l().s[55]++;
  return withEmailVerificationRateLimit(request, handler, {
    checkVerificationAttempts: true,
    checkOverallActivity: true,
    requireEmail: true
  });
}
async function withResendRateLimit(request, handler) {
  /* istanbul ignore next */
  cov_2p8r0y8w0l().f[8]++;
  cov_2p8r0y8w0l().s[56]++;
  return withEmailVerificationRateLimit(request, handler, {
    checkResendRequests: true,
    checkOverallActivity: true,
    requireEmail: true
  });
}
async function withSecurityMonitoring(request, handler) {
  /* istanbul ignore next */
  cov_2p8r0y8w0l().f[9]++;
  cov_2p8r0y8w0l().s[57]++;
  try {
    const identifier =
    /* istanbul ignore next */
    (cov_2p8r0y8w0l().s[58]++, getClientIdentifier(request));
    // Basic rate limiting for monitoring endpoints
    const activityResult =
    /* istanbul ignore next */
    (cov_2p8r0y8w0l().s[59]++, _emailverificationratelimiter.emailVerificationRateLimiter.checkEmailVerificationActivity(identifier));
    /* istanbul ignore next */
    cov_2p8r0y8w0l().s[60]++;
    if (!activityResult.allowed) {
      /* istanbul ignore next */
      cov_2p8r0y8w0l().b[22][0]++;
      cov_2p8r0y8w0l().s[61]++;
      return _server.NextResponse.json({
        error: 'Too many requests'
      }, {
        status: 429
      });
    } else
    /* istanbul ignore next */
    {
      cov_2p8r0y8w0l().b[22][1]++;
    }
    cov_2p8r0y8w0l().s[62]++;
    return await handler(request);
  } catch (error) {
    /* istanbul ignore next */
    cov_2p8r0y8w0l().s[63]++;
    console.error('Security monitoring middleware error:', error);
    /* istanbul ignore next */
    cov_2p8r0y8w0l().s[64]++;
    return _server.NextResponse.json({
      error: 'Internal server error'
    }, {
      status: 500
    });
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ3aXRoRW1haWxWZXJpZmljYXRpb25SYXRlTGltaXQiLCJjb3ZfMnA4cjB5OHcwbCIsImYiLCJzIiwid2l0aFJlc2VuZFJhdGVMaW1pdCIsIndpdGhTZWN1cml0eU1vbml0b3JpbmciLCJ3aXRoVmVyaWZpY2F0aW9uUmF0ZUxpbWl0IiwiZ2V0Q2xpZW50SWRlbnRpZmllciIsInJlcXVlc3QiLCJmb3J3YXJkZWRGb3IiLCJoZWFkZXJzIiwiZ2V0IiwicmVhbElwIiwicmVtb3RlQWRkciIsImIiLCJzcGxpdCIsInRyaW0iLCJoYW5kbGVyIiwib3B0aW9ucyIsImlkZW50aWZpZXIiLCJlbWFpbCIsInJlcXVpcmVFbWFpbCIsImNoZWNrUmVzZW5kUmVxdWVzdHMiLCJib2R5IiwianNvbiIsInRvTG93ZXJDYXNlIiwiX3NlcnZlciIsIk5leHRSZXNwb25zZSIsImVycm9yIiwic3RhdHVzIiwibmV3UmVxdWVzdCIsIk5leHRSZXF1ZXN0IiwidXJsIiwibWV0aG9kIiwiSlNPTiIsInN0cmluZ2lmeSIsIl9wYXJzZWRCb2R5IiwiY2hlY2tPdmVyYWxsQWN0aXZpdHkiLCJhY3Rpdml0eVJlc3VsdCIsIl9lbWFpbHZlcmlmaWNhdGlvbnJhdGVsaW1pdGVyIiwiZW1haWxWZXJpZmljYXRpb25SYXRlTGltaXRlciIsImNoZWNrRW1haWxWZXJpZmljYXRpb25BY3Rpdml0eSIsImFsbG93ZWQiLCJyZXRyeUFmdGVyIiwicmVzZXRUaW1lIiwicmVtYWluaW5nIiwidG9TdHJpbmciLCJjaGVja1ZlcmlmaWNhdGlvbkF0dGVtcHRzIiwidmVyaWZpY2F0aW9uUmVzdWx0IiwicmVzZW5kUmVzdWx0IiwiZXJyb3JNZXNzYWdlIiwiY29vbGRvd25SZW1haW5pbmciLCJjb29sZG93blNlY29uZHMiLCJpc1N1c3BpY2lvdXMiLCJkZXRlY3RTdXNwaWNpb3VzQWN0aXZpdHkiLCJjb25zb2xlIiwid2FybiIsInJlc3BvbnNlIiwicmVjb3JkUmVzZW5kU3VjY2VzcyJdLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdGVmYW5iZWtrZXIvcHJvamVjdHMvZmFuY3ktcGxhbnRpZXMvc3JjL2xpYi9hdXRoL2VtYWlsLXZlcmlmaWNhdGlvbi1taWRkbGV3YXJlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAnc2VydmVyLW9ubHknO1xuaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IGVtYWlsVmVyaWZpY2F0aW9uUmF0ZUxpbWl0ZXIgfSBmcm9tICdAL2xpYi9zZXJ2aWNlcy9lbWFpbC12ZXJpZmljYXRpb24tcmF0ZS1saW1pdGVyJztcblxuLyoqXG4gKiBHZXQgY2xpZW50IGlkZW50aWZpZXIgZm9yIHJhdGUgbGltaXRpbmdcbiAqL1xuZnVuY3Rpb24gZ2V0Q2xpZW50SWRlbnRpZmllcihyZXF1ZXN0OiBOZXh0UmVxdWVzdCk6IHN0cmluZyB7XG4gIC8vIFRyeSB0byBnZXQgcmVhbCBJUCBhZGRyZXNzXG4gIGNvbnN0IGZvcndhcmRlZEZvciA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpO1xuICBjb25zdCByZWFsSXAgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LXJlYWwtaXAnKTtcbiAgY29uc3QgcmVtb3RlQWRkciA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtcmVtb3RlLWFkZHInKTtcbiAgXG4gIGlmIChmb3J3YXJkZWRGb3IpIHtcbiAgICAvLyB4LWZvcndhcmRlZC1mb3IgY2FuIGNvbnRhaW4gbXVsdGlwbGUgSVBzLCB0YWtlIHRoZSBmaXJzdCBvbmVcbiAgICByZXR1cm4gZm9yd2FyZGVkRm9yLnNwbGl0KCcsJylbMF0udHJpbSgpO1xuICB9XG4gIFxuICBpZiAocmVhbElwKSB7XG4gICAgcmV0dXJuIHJlYWxJcDtcbiAgfVxuICBcbiAgaWYgKHJlbW90ZUFkZHIpIHtcbiAgICByZXR1cm4gcmVtb3RlQWRkcjtcbiAgfVxuICBcbiAgLy8gRmFsbGJhY2sgaWRlbnRpZmllclxuICByZXR1cm4gJ3Vua25vd24nO1xufVxuXG4vKipcbiAqIEVuaGFuY2VkIHJhdGUgbGltaXRpbmcgbWlkZGxld2FyZSBmb3IgZW1haWwgdmVyaWZpY2F0aW9uIGVuZHBvaW50c1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gd2l0aEVtYWlsVmVyaWZpY2F0aW9uUmF0ZUxpbWl0KFxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCxcbiAgaGFuZGxlcjogKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSA9PiBQcm9taXNlPE5leHRSZXNwb25zZT4sXG4gIG9wdGlvbnM6IHtcbiAgICBjaGVja1ZlcmlmaWNhdGlvbkF0dGVtcHRzPzogYm9vbGVhbjtcbiAgICBjaGVja1Jlc2VuZFJlcXVlc3RzPzogYm9vbGVhbjtcbiAgICBjaGVja092ZXJhbGxBY3Rpdml0eT86IGJvb2xlYW47XG4gICAgcmVxdWlyZUVtYWlsPzogYm9vbGVhbjtcbiAgfSA9IHt9XG4pOiBQcm9taXNlPE5leHRSZXNwb25zZT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGlkZW50aWZpZXIgPSBnZXRDbGllbnRJZGVudGlmaWVyKHJlcXVlc3QpO1xuICAgIGxldCBlbWFpbDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgIFxuICAgIC8vIEV4dHJhY3QgZW1haWwgZnJvbSByZXF1ZXN0IGJvZHkgaWYgbmVlZGVkXG4gICAgaWYgKG9wdGlvbnMucmVxdWlyZUVtYWlsIHx8IG9wdGlvbnMuY2hlY2tSZXNlbmRSZXF1ZXN0cykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgICAgICBlbWFpbCA9IGJvZHkuZW1haWw/LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAob3B0aW9ucy5yZXF1aXJlRW1haWwgJiYgIWVtYWlsKSB7XG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICAgICAgeyBlcnJvcjogJ0VtYWlsIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IHJlcXVlc3Qgd2l0aCB0aGUgcGFyc2VkIGJvZHkgZm9yIHRoZSBoYW5kbGVyXG4gICAgICAgIGNvbnN0IG5ld1JlcXVlc3QgPSBuZXcgTmV4dFJlcXVlc3QocmVxdWVzdC51cmwsIHtcbiAgICAgICAgICBtZXRob2Q6IHJlcXVlc3QubWV0aG9kLFxuICAgICAgICAgIGhlYWRlcnM6IHJlcXVlc3QuaGVhZGVycyxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShib2R5KSxcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBDb3B5IHRoZSBwYXJzZWQgYm9keSB0byB0aGUgbmV3IHJlcXVlc3QgZm9yIHRoZSBoYW5kbGVyIHRvIHVzZVxuICAgICAgICAobmV3UmVxdWVzdCBhcyBhbnkpLl9wYXJzZWRCb2R5ID0gYm9keTtcbiAgICAgICAgcmVxdWVzdCA9IG5ld1JlcXVlc3Q7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgeyBlcnJvcjogJ0ludmFsaWQgSlNPTiBpbiByZXF1ZXN0IGJvZHknIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIENoZWNrIG92ZXJhbGwgZW1haWwgdmVyaWZpY2F0aW9uIGFjdGl2aXR5IGZpcnN0XG4gICAgaWYgKG9wdGlvbnMuY2hlY2tPdmVyYWxsQWN0aXZpdHkgIT09IGZhbHNlKSB7XG4gICAgICBjb25zdCBhY3Rpdml0eVJlc3VsdCA9IGVtYWlsVmVyaWZpY2F0aW9uUmF0ZUxpbWl0ZXIuY2hlY2tFbWFpbFZlcmlmaWNhdGlvbkFjdGl2aXR5KGlkZW50aWZpZXIsIGVtYWlsKTtcbiAgICAgIFxuICAgICAgaWYgKCFhY3Rpdml0eVJlc3VsdC5hbGxvd2VkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7XG4gICAgICAgICAgICBlcnJvcjogJ1RvbyBtYW55IGVtYWlsIHZlcmlmaWNhdGlvbiByZXF1ZXN0cy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci4nLFxuICAgICAgICAgICAgcmV0cnlBZnRlcjogYWN0aXZpdHlSZXN1bHQucmV0cnlBZnRlcixcbiAgICAgICAgICAgIHJlc2V0VGltZTogYWN0aXZpdHlSZXN1bHQucmVzZXRUaW1lLFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgc3RhdHVzOiA0MjksXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICdYLVJhdGVMaW1pdC1MaW1pdCc6ICcyMCcsXG4gICAgICAgICAgICAgICdYLVJhdGVMaW1pdC1SZW1haW5pbmcnOiBhY3Rpdml0eVJlc3VsdC5yZW1haW5pbmcudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgJ1gtUmF0ZUxpbWl0LVJlc2V0JzogYWN0aXZpdHlSZXN1bHQucmVzZXRUaW1lLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICdSZXRyeS1BZnRlcic6IGFjdGl2aXR5UmVzdWx0LnJldHJ5QWZ0ZXI/LnRvU3RyaW5nKCkgfHwgJzM2MDAnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIENoZWNrIHZlcmlmaWNhdGlvbiBhdHRlbXB0cyByYXRlIGxpbWl0XG4gICAgaWYgKG9wdGlvbnMuY2hlY2tWZXJpZmljYXRpb25BdHRlbXB0cykge1xuICAgICAgY29uc3QgdmVyaWZpY2F0aW9uUmVzdWx0ID0gZW1haWxWZXJpZmljYXRpb25SYXRlTGltaXRlci5jaGVja1ZlcmlmaWNhdGlvbkF0dGVtcHRzKGlkZW50aWZpZXIsIGVtYWlsKTtcbiAgICAgIFxuICAgICAgaWYgKCF2ZXJpZmljYXRpb25SZXN1bHQuYWxsb3dlZCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAge1xuICAgICAgICAgICAgZXJyb3I6ICdUb28gbWFueSB2ZXJpZmljYXRpb24gYXR0ZW1wdHMuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJyxcbiAgICAgICAgICAgIHJldHJ5QWZ0ZXI6IHZlcmlmaWNhdGlvblJlc3VsdC5yZXRyeUFmdGVyLFxuICAgICAgICAgICAgcmVzZXRUaW1lOiB2ZXJpZmljYXRpb25SZXN1bHQucmVzZXRUaW1lLFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgc3RhdHVzOiA0MjksXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICdYLVJhdGVMaW1pdC1MaW1pdCc6ICcxMCcsXG4gICAgICAgICAgICAgICdYLVJhdGVMaW1pdC1SZW1haW5pbmcnOiB2ZXJpZmljYXRpb25SZXN1bHQucmVtYWluaW5nLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICdYLVJhdGVMaW1pdC1SZXNldCc6IHZlcmlmaWNhdGlvblJlc3VsdC5yZXNldFRpbWUudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgJ1JldHJ5LUFmdGVyJzogdmVyaWZpY2F0aW9uUmVzdWx0LnJldHJ5QWZ0ZXI/LnRvU3RyaW5nKCkgfHwgJzM2MDAnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIENoZWNrIHJlc2VuZCByZXF1ZXN0cyByYXRlIGxpbWl0XG4gICAgaWYgKG9wdGlvbnMuY2hlY2tSZXNlbmRSZXF1ZXN0cyAmJiBlbWFpbCkge1xuICAgICAgY29uc3QgcmVzZW5kUmVzdWx0ID0gZW1haWxWZXJpZmljYXRpb25SYXRlTGltaXRlci5jaGVja1Jlc2VuZFJlcXVlc3RzKGVtYWlsLCBpZGVudGlmaWVyKTtcbiAgICAgIFxuICAgICAgaWYgKCFyZXNlbmRSZXN1bHQuYWxsb3dlZCkge1xuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSByZXNlbmRSZXN1bHQuY29vbGRvd25SZW1haW5pbmdcbiAgICAgICAgICA/IGBQbGVhc2Ugd2FpdCAke3Jlc2VuZFJlc3VsdC5jb29sZG93blJlbWFpbmluZ30gc2Vjb25kcyBiZWZvcmUgcmVxdWVzdGluZyBhbm90aGVyIHZlcmlmaWNhdGlvbiBjb2RlLmBcbiAgICAgICAgICA6ICdUb28gbWFueSByZXNlbmQgcmVxdWVzdHMuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJztcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICB7XG4gICAgICAgICAgICBlcnJvcjogZXJyb3JNZXNzYWdlLFxuICAgICAgICAgICAgcmV0cnlBZnRlcjogcmVzZW5kUmVzdWx0LnJldHJ5QWZ0ZXIsXG4gICAgICAgICAgICByZXNldFRpbWU6IHJlc2VuZFJlc3VsdC5yZXNldFRpbWUsXG4gICAgICAgICAgICBjb29sZG93blNlY29uZHM6IHJlc2VuZFJlc3VsdC5jb29sZG93blJlbWFpbmluZyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHN0YXR1czogNDI5LFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAnWC1SYXRlTGltaXQtTGltaXQnOiAnNScsXG4gICAgICAgICAgICAgICdYLVJhdGVMaW1pdC1SZW1haW5pbmcnOiByZXNlbmRSZXN1bHQucmVtYWluaW5nLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICdYLVJhdGVMaW1pdC1SZXNldCc6IHJlc2VuZFJlc3VsdC5yZXNldFRpbWUudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgJ1JldHJ5LUFmdGVyJzogcmVzZW5kUmVzdWx0LnJldHJ5QWZ0ZXI/LnRvU3RyaW5nKCkgfHwgJzYwJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBDaGVjayBmb3Igc3VzcGljaW91cyBhY3Rpdml0eVxuICAgIGNvbnN0IGlzU3VzcGljaW91cyA9IGVtYWlsVmVyaWZpY2F0aW9uUmF0ZUxpbWl0ZXIuZGV0ZWN0U3VzcGljaW91c0FjdGl2aXR5KGlkZW50aWZpZXIsIGVtYWlsKTtcbiAgICBpZiAoaXNTdXNwaWNpb3VzKSB7XG4gICAgICAvLyBGb3Igbm93LCBqdXN0IGxvZyBpdC4gSW4gcHJvZHVjdGlvbiwgeW91IG1pZ2h0IHdhbnQgdG8gYWRkIGFkZGl0aW9uYWwgcmVzdHJpY3Rpb25zXG4gICAgICBjb25zb2xlLndhcm4oYFN1c3BpY2lvdXMgZW1haWwgdmVyaWZpY2F0aW9uIGFjdGl2aXR5IGRldGVjdGVkIGZyb20gJHtpZGVudGlmaWVyfWAsIHsgZW1haWwgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIENhbGwgdGhlIGhhbmRsZXJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGhhbmRsZXIocmVxdWVzdCk7XG4gICAgXG4gICAgLy8gUmVjb3JkIHN1Y2Nlc3NmdWwgcmVzZW5kIGlmIGFwcGxpY2FibGVcbiAgICBpZiAob3B0aW9ucy5jaGVja1Jlc2VuZFJlcXVlc3RzICYmIGVtYWlsICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICBlbWFpbFZlcmlmaWNhdGlvblJhdGVMaW1pdGVyLnJlY29yZFJlc2VuZFN1Y2Nlc3MoZW1haWwpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRW1haWwgdmVyaWZpY2F0aW9uIHJhdGUgbGltaXQgbWlkZGxld2FyZSBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cblxuLyoqXG4gKiBNaWRkbGV3YXJlIHNwZWNpZmljYWxseSBmb3IgdmVyaWZpY2F0aW9uIGF0dGVtcHRzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3aXRoVmVyaWZpY2F0aW9uUmF0ZUxpbWl0KFxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCxcbiAgaGFuZGxlcjogKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSA9PiBQcm9taXNlPE5leHRSZXNwb25zZT5cbik6IFByb21pc2U8TmV4dFJlc3BvbnNlPiB7XG4gIHJldHVybiB3aXRoRW1haWxWZXJpZmljYXRpb25SYXRlTGltaXQocmVxdWVzdCwgaGFuZGxlciwge1xuICAgIGNoZWNrVmVyaWZpY2F0aW9uQXR0ZW1wdHM6IHRydWUsXG4gICAgY2hlY2tPdmVyYWxsQWN0aXZpdHk6IHRydWUsXG4gICAgcmVxdWlyZUVtYWlsOiB0cnVlLFxuICB9KTtcbn1cblxuLyoqXG4gKiBNaWRkbGV3YXJlIHNwZWNpZmljYWxseSBmb3IgcmVzZW5kIHJlcXVlc3RzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3aXRoUmVzZW5kUmF0ZUxpbWl0KFxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCxcbiAgaGFuZGxlcjogKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSA9PiBQcm9taXNlPE5leHRSZXNwb25zZT5cbik6IFByb21pc2U8TmV4dFJlc3BvbnNlPiB7XG4gIHJldHVybiB3aXRoRW1haWxWZXJpZmljYXRpb25SYXRlTGltaXQocmVxdWVzdCwgaGFuZGxlciwge1xuICAgIGNoZWNrUmVzZW5kUmVxdWVzdHM6IHRydWUsXG4gICAgY2hlY2tPdmVyYWxsQWN0aXZpdHk6IHRydWUsXG4gICAgcmVxdWlyZUVtYWlsOiB0cnVlLFxuICB9KTtcbn1cblxuLyoqXG4gKiBTZWN1cml0eSBtb25pdG9yaW5nIGVuZHBvaW50IG1pZGRsZXdhcmVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHdpdGhTZWN1cml0eU1vbml0b3JpbmcoXG4gIHJlcXVlc3Q6IE5leHRSZXF1ZXN0LFxuICBoYW5kbGVyOiAocmVxdWVzdDogTmV4dFJlcXVlc3QpID0+IFByb21pc2U8TmV4dFJlc3BvbnNlPlxuKTogUHJvbWlzZTxOZXh0UmVzcG9uc2U+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBpZGVudGlmaWVyID0gZ2V0Q2xpZW50SWRlbnRpZmllcihyZXF1ZXN0KTtcbiAgICBcbiAgICAvLyBCYXNpYyByYXRlIGxpbWl0aW5nIGZvciBtb25pdG9yaW5nIGVuZHBvaW50c1xuICAgIGNvbnN0IGFjdGl2aXR5UmVzdWx0ID0gZW1haWxWZXJpZmljYXRpb25SYXRlTGltaXRlci5jaGVja0VtYWlsVmVyaWZpY2F0aW9uQWN0aXZpdHkoaWRlbnRpZmllcik7XG4gICAgXG4gICAgaWYgKCFhY3Rpdml0eVJlc3VsdC5hbGxvd2VkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdUb28gbWFueSByZXF1ZXN0cycgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQyOSB9XG4gICAgICApO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gYXdhaXQgaGFuZGxlcihyZXF1ZXN0KTtcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdTZWN1cml0eSBtb25pdG9yaW5nIG1pZGRsZXdhcmUgZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O01BaUNzQkEsK0JBQUE7SUFBQTtJQUFBQyxjQUFBLEdBQUFDLENBQUE7SUFBQUQsY0FBQSxHQUFBRSxDQUFBO1dBQUFILDhCQUFBOztNQXFLQUksb0JBQUE7SUFBQTtJQUFBSCxjQUFBLEdBQUFDLENBQUE7SUFBQUQsY0FBQSxHQUFBRSxDQUFBO1dBQUFDLG1CQUFBOztNQWNBQyx1QkFBQTtJQUFB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