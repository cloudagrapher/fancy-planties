19502a9b53f8e78bfb67dc502173521c
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "CareHistoryQueries", {
    enumerable: true,
    get: function() {
        return CareHistoryQueries;
    }
});
const _db = require("..");
const _schema = require("../schema");
const _drizzleorm = require("drizzle-orm");
const _carecalculator = require("../../services/care-calculator");
const _caretypes = require("../../types/care-types");
class CareHistoryQueries {
    /**
   * Create a new care history entry
   */ static async createCareHistory(data) {
        const [careEntry] = await _db.db.insert(_schema.careHistory).values({
            ...data,
            createdAt: new Date(),
            updatedAt: new Date()
        }).returning();
        return careEntry;
    }
    /**
   * Get care history by ID
   */ static async getCareHistoryById(id) {
        const [careEntry] = await _db.db.select().from(_schema.careHistory).where((0, _drizzleorm.eq)(_schema.careHistory.id, id)).limit(1);
        return careEntry || null;
    }
    /**
   * Get care history for a specific plant instance
   */ static async getCareHistoryForPlant(plantInstanceId, userId, filters) {
        // Build where conditions
        const conditions = [
            (0, _drizzleorm.eq)(_schema.careHistory.plantInstanceId, plantInstanceId),
            (0, _drizzleorm.eq)(_schema.careHistory.userId, userId)
        ];
        if (filters?.careType) {
            conditions.push((0, _drizzleorm.eq)(_schema.careHistory.careType, filters.careType));
        }
        if (filters?.startDate) {
            conditions.push((0, _drizzleorm.gte)(_schema.careHistory.careDate, filters.startDate));
        }
        if (filters?.endDate) {
            conditions.push((0, _drizzleorm.lte)(_schema.careHistory.careDate, filters.endDate));
        }
        // Apply sorting
        const sortField = filters?.sortBy === 'care_type' ? _schema.careHistory.careType : filters?.sortBy === 'created_at' ? _schema.careHistory.createdAt : _schema.careHistory.careDate;
        const sortOrder = filters?.sortOrder === 'asc' ? (0, _drizzleorm.asc)(sortField) : (0, _drizzleorm.desc)(sortField);
        // Build the query
        let query = _db.db.select({
            careHistory: _schema.careHistory,
            plantInstance: _schema.plantInstances,
            plant: _schema.plants
        }).from(_schema.careHistory).leftJoin(_schema.plantInstances, (0, _drizzleorm.eq)(_schema.careHistory.plantInstanceId, _schema.plantInstances.id)).leftJoin(_schema.plants, (0, _drizzleorm.eq)(_schema.plantInstances.plantId, _schema.plants.id)).where((0, _drizzleorm.and)(...conditions)).orderBy(sortOrder);
        // Apply pagination
        if (filters?.limit) {
            query = query.limit(filters.limit);
        }
        if (filters?.offset) {
            query = query.offset(filters.offset);
        }
        const results = await query;
        return results.map((result)=>this.enhanceCareHistory(result.careHistory, result.plantInstance, result.plant));
    }
    /**
   * Get care history for multiple plant instances (for dashboard)
   */ static async getCareHistoryForPlants(plantInstanceIds, userId, filters) {
        if (plantInstanceIds.length === 0) return [];
        // Build where conditions
        const conditions = [
            (0, _drizzleorm.inArray)(_schema.careHistory.plantInstanceId, plantInstanceIds),
            (0, _drizzleorm.eq)(_schema.careHistory.userId, userId)
        ];
        if (filters?.careType) {
            conditions.push((0, _drizzleorm.eq)(_schema.careHistory.careType, filters.careType));
        }
        if (filters?.startDate) {
            conditions.push((0, _drizzleorm.gte)(_schema.careHistory.careDate, filters.startDate));
        }
        if (filters?.endDate) {
            conditions.push((0, _drizzleorm.lte)(_schema.careHistory.careDate, filters.endDate));
        }
        // Apply sorting
        const sortField = filters?.sortBy === 'care_type' ? _schema.careHistory.careType : filters?.sortBy === 'created_at' ? _schema.careHistory.createdAt : _schema.careHistory.careDate;
        const sortOrder = filters?.sortOrder === 'asc' ? (0, _drizzleorm.asc)(sortField) : (0, _drizzleorm.desc)(sortField);
        // Build the query
        let query = _db.db.select({
            careHistory: _schema.careHistory,
            plantInstance: _schema.plantInstances,
            plant: _schema.plants
        }).from(_schema.careHistory).leftJoin(_schema.plantInstances, (0, _drizzleorm.eq)(_schema.careHistory.plantInstanceId, _schema.plantInstances.id)).leftJoin(_schema.plants, (0, _drizzleorm.eq)(_schema.plantInstances.plantId, _schema.plants.id)).where((0, _drizzleorm.and)(...conditions)).orderBy(sortOrder);
        // Apply pagination
        if (filters?.limit) {
            query = query.limit(filters.limit);
        }
        if (filters?.offset) {
            query = query.offset(filters.offset);
        }
        const results = await query;
        return results.map((result)=>this.enhanceCareHistory(result.careHistory, result.plantInstance, result.plant));
    }
    /**
   * Get recent care history for a user
   */ static async getRecentCareHistory(userId, limit = 20) {
        const results = await _db.db.select({
            careHistory: _schema.careHistory,
            plantInstance: _schema.plantInstances,
            plant: _schema.plants
        }).from(_schema.careHistory).leftJoin(_schema.plantInstances, (0, _drizzleorm.eq)(_schema.careHistory.plantInstanceId, _schema.plantInstances.id)).leftJoin(_schema.plants, (0, _drizzleorm.eq)(_schema.plantInstances.plantId, _schema.plants.id)).where((0, _drizzleorm.eq)(_schema.careHistory.userId, userId)).orderBy((0, _drizzleorm.desc)(_schema.careHistory.careDate)).limit(limit);
        return results.map((result)=>this.enhanceCareHistory(result.careHistory, result.plantInstance, result.plant));
    }
    /**
   * Update care history entry
   */ static async updateCareHistory(id, userId, updates) {
        const [updated] = await _db.db.update(_schema.careHistory).set({
            ...updates,
            updatedAt: new Date()
        }).where((0, _drizzleorm.and)((0, _drizzleorm.eq)(_schema.careHistory.id, id), (0, _drizzleorm.eq)(_schema.careHistory.userId, userId))).returning();
        return updated || null;
    }
    /**
   * Delete care history entry
   */ static async deleteCareHistory(id, userId) {
        // First check if record exists and belongs to user
        const existing = await _db.db.select().from(_schema.careHistory).where((0, _drizzleorm.and)((0, _drizzleorm.eq)(_schema.careHistory.id, id), (0, _drizzleorm.eq)(_schema.careHistory.userId, userId))).limit(1);
        if (existing.length === 0) {
            return false; // Record doesn't exist or doesn't belong to user
        }
        // Perform the delete
        await _db.db.delete(_schema.careHistory).where((0, _drizzleorm.and)((0, _drizzleorm.eq)(_schema.careHistory.id, id), (0, _drizzleorm.eq)(_schema.careHistory.userId, userId)));
        // Verify deletion by checking if record still exists
        const stillExists = await _db.db.select().from(_schema.careHistory).where((0, _drizzleorm.eq)(_schema.careHistory.id, id)).limit(1);
        return stillExists.length === 0;
    }
    /**
   * Get care statistics for a plant instance
   */ static async getPlantCareStatistics(plantInstanceId, userId) {
        // Get plant instance
        const [plantInstance] = await _db.db.select().from(_schema.plantInstances).where((0, _drizzleorm.and)((0, _drizzleorm.eq)(_schema.plantInstances.id, plantInstanceId), (0, _drizzleorm.eq)(_schema.plantInstances.userId, userId))).limit(1);
        if (!plantInstance) return null;
        // Get care history
        const careHistoryData = await _db.db.select().from(_schema.careHistory).where((0, _drizzleorm.and)((0, _drizzleorm.eq)(_schema.careHistory.plantInstanceId, plantInstanceId), (0, _drizzleorm.eq)(_schema.careHistory.userId, userId))).orderBy((0, _drizzleorm.asc)(_schema.careHistory.careDate));
        return _carecalculator.CareCalculator.calculatePlantCareStatistics(plantInstance, careHistoryData);
    }
    /**
   * Get care statistics for multiple plants
   */ static async getBulkCareStatistics(plantInstanceIds, userId) {
        if (plantInstanceIds.length === 0) return [];
        // Get plant instances
        const plantInstancesData = await _db.db.select().from(_schema.plantInstances).where((0, _drizzleorm.and)((0, _drizzleorm.inArray)(_schema.plantInstances.id, plantInstanceIds), (0, _drizzleorm.eq)(_schema.plantInstances.userId, userId)));
        // Get care history for all plants
        const careHistoryData = await _db.db.select().from(_schema.careHistory).where((0, _drizzleorm.and)((0, _drizzleorm.inArray)(_schema.careHistory.plantInstanceId, plantInstanceIds), (0, _drizzleorm.eq)(_schema.careHistory.userId, userId))).orderBy((0, _drizzleorm.asc)(_schema.careHistory.careDate));
        // Group care history by plant instance
        const careHistoryByPlant = careHistoryData.reduce((acc, care)=>{
            if (!acc[care.plantInstanceId]) {
                acc[care.plantInstanceId] = [];
            }
            acc[care.plantInstanceId].push(care);
            return acc;
        }, {});
        // Calculate statistics for each plant
        return plantInstancesData.map((plantInstance)=>_carecalculator.CareCalculator.calculatePlantCareStatistics(plantInstance, careHistoryByPlant[plantInstance.id] || []));
    }
    /**
   * Get care dashboard data
   */ static async getCareDashboardData(userId, options = {}) {
        const { includeInactive = false, daysAhead = 7 } = options;
        // Get all plant instances for the user
        const plantInstancesData = await _db.db.select({
            plantInstance: _schema.plantInstances,
            plant: _schema.plants
        }).from(_schema.plantInstances).leftJoin(_schema.plants, (0, _drizzleorm.eq)(_schema.plantInstances.plantId, _schema.plants.id)).where(includeInactive ? (0, _drizzleorm.eq)(_schema.plantInstances.userId, userId) : (0, _drizzleorm.and)((0, _drizzleorm.eq)(_schema.plantInstances.userId, userId), (0, _drizzleorm.eq)(_schema.plantInstances.isActive, true)));
        // Get recent care history for statistics
        const oneWeekAgo = new Date();
        oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
        const recentCareHistory = await _db.db.select().from(_schema.careHistory).where((0, _drizzleorm.and)((0, _drizzleorm.eq)(_schema.careHistory.userId, userId), (0, _drizzleorm.gte)(_schema.careHistory.careDate, oneWeekAgo)));
        // Enhance plant instances with care calculations
        const enhancedPlants = plantInstancesData.map(({ plantInstance, plant })=>{
            if (!plant) return null;
            const careStatus = _carecalculator.CareCalculator.calculateCareStatus(plantInstance.fertilizerDue);
            const careUrgency = _carecalculator.CareCalculator.calculateCareUrgency(plantInstance.fertilizerDue);
            const daysUntilFertilizerDue = _carecalculator.CareCalculator.calculateDaysUntilFertilizerDue(plantInstance.fertilizerDue);
            const daysSinceLastFertilized = _carecalculator.CareCalculator.calculateDaysSinceLastFertilized(plantInstance.lastFertilized);
            const daysSinceLastRepot = _carecalculator.CareCalculator.calculateDaysSinceLastRepot(plantInstance.lastRepot);
            const displayName = plantInstance.nickname || plant.commonName;
            const primaryImage = plantInstance.images?.[0] || plant.defaultImage || null;
            return {
                ...plantInstance,
                plant,
                careStatus,
                careUrgency,
                daysUntilFertilizerDue,
                daysSinceLastFertilized,
                daysSinceLastRepot,
                displayName,
                primaryImage
            };
        }).filter((plant)=>plant !== null);
        // Categorize plants by care status
        const overdue = enhancedPlants.filter((p)=>p.careStatus === 'overdue');
        const dueToday = enhancedPlants.filter((p)=>p.careStatus === 'due_today');
        const dueSoon = enhancedPlants.filter((p)=>p.careStatus === 'due_soon');
        // Get recently cared plants (fertilized in last 3 days)
        const threeDaysAgo = new Date();
        threeDaysAgo.setDate(threeDaysAgo.getDate() - 3);
        const recentlyCared = enhancedPlants.filter((p)=>p.lastFertilized && p.lastFertilized >= threeDaysAgo);
        // Calculate care streak (consecutive days with proper care)
        const careStreakDays = this.calculateUserCareStreak(userId, recentCareHistory);
        // Calculate average care consistency across all plants
        const averageCareConsistency = enhancedPlants.length > 0 ? enhancedPlants.reduce((sum, plant)=>{
            // Simplified consistency calculation for dashboard
            const daysSince = plant.daysSinceLastFertilized || 0;
            const scheduleDays = _caretypes.careHelpers.parseFertilizerSchedule(plant.fertilizerSchedule);
            const consistency = Math.max(0, 100 - daysSince / scheduleDays * 50);
            return sum + consistency;
        }, 0) / enhancedPlants.length : 0;
        return {
            overdue,
            dueToday,
            dueSoon,
            recentlyCared,
            statistics: {
                totalActivePlants: enhancedPlants.length,
                overdueCount: overdue.length,
                dueTodayCount: dueToday.length,
                dueSoonCount: dueSoon.length,
                careStreakDays,
                totalCareEventsThisWeek: recentCareHistory.length,
                averageCareConsistency: Math.round(averageCareConsistency)
            },
            quickActions: _caretypes.careHelpers.getDefaultQuickCareActions()
        };
    }
    /**
   * Get care history count for a plant instance
   */ static async getCareHistoryCount(plantInstanceId, userId, careType) {
        const conditions = [
            (0, _drizzleorm.eq)(_schema.careHistory.plantInstanceId, plantInstanceId),
            (0, _drizzleorm.eq)(_schema.careHistory.userId, userId)
        ];
        if (careType) {
            conditions.push((0, _drizzleorm.eq)(_schema.careHistory.careType, careType));
        }
        const [result] = await _db.db.select({
            count: (0, _drizzleorm.count)()
        }).from(_schema.careHistory).where((0, _drizzleorm.and)(...conditions));
        return result.count;
    }
    /**
   * Get last care date for a specific care type
   */ static async getLastCareDate(plantInstanceId, userId, careType) {
        const [result] = await _db.db.select({
            careDate: _schema.careHistory.careDate
        }).from(_schema.careHistory).where((0, _drizzleorm.and)((0, _drizzleorm.eq)(_schema.careHistory.plantInstanceId, plantInstanceId), (0, _drizzleorm.eq)(_schema.careHistory.userId, userId), (0, _drizzleorm.eq)(_schema.careHistory.careType, careType))).orderBy((0, _drizzleorm.desc)(_schema.careHistory.careDate)).limit(1);
        return result?.careDate || null;
    }
    /**
   * Bulk create care history entries
   */ static async bulkCreateCareHistory(entries) {
        if (entries.length === 0) return [];
        const entriesWithTimestamps = entries.map((entry)=>({
                ...entry,
                createdAt: new Date(),
                updatedAt: new Date()
            }));
        return await _db.db.insert(_schema.careHistory).values(entriesWithTimestamps).returning();
    }
    /**
   * Private helper to enhance care history with computed properties
   */ static enhanceCareHistory(care, plantInstance, plant) {
        const now = new Date();
        const daysSinceCare = Math.floor((now.getTime() - care.careDate.getTime()) / (1000 * 60 * 60 * 24));
        const formattedDate = _caretypes.careHelpers.formatCareDate(care.careDate);
        const careTypeDisplay = _caretypes.careHelpers.getCareTypeDisplay(care.careType);
        return {
            ...care,
            plantInstance: plantInstance && plant ? {
                ...plantInstance,
                plant
            } : undefined,
            daysSinceCare,
            formattedDate,
            careTypeDisplay
        };
    }
    /**
   * Private helper to calculate user care streak
   */ static calculateUserCareStreak(userId, recentCareHistory) {
        // Simplified care streak calculation
        // Count consecutive days with at least one care event
        const careByDate = recentCareHistory.reduce((acc, care)=>{
            const dateKey = care.careDate.toISOString().split('T')[0];
            acc[dateKey] = true;
            return acc;
        }, {});
        let streak = 0;
        const today = new Date();
        for(let i = 0; i < 30; i++){
            const checkDate = new Date(today);
            checkDate.setDate(checkDate.getDate() - i);
            const dateKey = checkDate.toISOString().split('T')[0];
            if (careByDate[dateKey]) {
                streak++;
            } else if (i > 0) {
                break;
            }
        }
        return streak;
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdGVmYW5iZWtrZXIvcHJvamVjdHMvZmFuY3ktcGxhbnRpZXMvc3JjL2xpYi9kYi9xdWVyaWVzL2NhcmUtaGlzdG9yeS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkYiB9IGZyb20gJ0AvbGliL2RiJztcbmltcG9ydCB7IGNhcmVIaXN0b3J5LCBwbGFudEluc3RhbmNlcywgcGxhbnRzIH0gZnJvbSAnQC9saWIvZGIvc2NoZW1hJztcbmltcG9ydCB7IGVxLCBhbmQsIGRlc2MsIGFzYywgZ3RlLCBsdGUsIGluQXJyYXksIHNxbCwgY291bnQgfSBmcm9tICdkcml6emxlLW9ybSc7XG5pbXBvcnQgdHlwZSB7IFxuICBDYXJlSGlzdG9yeSwgXG4gIE5ld0NhcmVIaXN0b3J5LCBcbiAgUGxhbnRJbnN0YW5jZSxcbiAgUGxhbnQgXG59IGZyb20gJ0AvbGliL2RiL3NjaGVtYSc7XG5pbXBvcnQgdHlwZSB7IEVuaGFuY2VkUGxhbnRJbnN0YW5jZSB9IGZyb20gJ0AvbGliL3R5cGVzL3BsYW50LWluc3RhbmNlLXR5cGVzJztcbmltcG9ydCB0eXBlIHsgXG4gIENhcmVGaWx0ZXJJbnB1dCxcbiAgQ2FyZVN0YXRzUXVlcnlJbnB1dCxcbiAgQ2FyZURhc2hib2FyZFF1ZXJ5SW5wdXQgXG59IGZyb20gJ0AvbGliL3ZhbGlkYXRpb24vY2FyZS1zY2hlbWFzJztcbmltcG9ydCB0eXBlIHsgXG4gIEVuaGFuY2VkQ2FyZUhpc3RvcnksXG4gIFBsYW50Q2FyZVN0YXRpc3RpY3MsXG4gIENhcmVEYXNoYm9hcmREYXRhLFxuICBDYXJlVHlwZVxufSBmcm9tICdAL2xpYi90eXBlcy9jYXJlLXR5cGVzJztcbmltcG9ydCB7IENhcmVDYWxjdWxhdG9yIH0gZnJvbSAnQC9saWIvc2VydmljZXMvY2FyZS1jYWxjdWxhdG9yJztcbmltcG9ydCB7IGNhcmVIZWxwZXJzIH0gZnJvbSAnQC9saWIvdHlwZXMvY2FyZS10eXBlcyc7XG5cbi8qKlxuICogRGF0YWJhc2UgcXVlcmllcyBmb3IgY2FyZSBoaXN0b3J5IG1hbmFnZW1lbnRcbiAqL1xuZXhwb3J0IGNsYXNzIENhcmVIaXN0b3J5UXVlcmllcyB7XG4gIC8qKlxuICAgKiBDcmVhdGUgYSBuZXcgY2FyZSBoaXN0b3J5IGVudHJ5XG4gICAqL1xuICBzdGF0aWMgYXN5bmMgY3JlYXRlQ2FyZUhpc3RvcnkoZGF0YTogTmV3Q2FyZUhpc3RvcnkpOiBQcm9taXNlPENhcmVIaXN0b3J5PiB7XG4gICAgY29uc3QgW2NhcmVFbnRyeV0gPSBhd2FpdCBkYlxuICAgICAgLmluc2VydChjYXJlSGlzdG9yeSlcbiAgICAgIC52YWx1ZXMoe1xuICAgICAgICAuLi5kYXRhLFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIH0pXG4gICAgICAucmV0dXJuaW5nKCk7XG5cbiAgICByZXR1cm4gY2FyZUVudHJ5O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjYXJlIGhpc3RvcnkgYnkgSURcbiAgICovXG4gIHN0YXRpYyBhc3luYyBnZXRDYXJlSGlzdG9yeUJ5SWQoaWQ6IG51bWJlcik6IFByb21pc2U8Q2FyZUhpc3RvcnkgfCBudWxsPiB7XG4gICAgY29uc3QgW2NhcmVFbnRyeV0gPSBhd2FpdCBkYlxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuZnJvbShjYXJlSGlzdG9yeSlcbiAgICAgIC53aGVyZShlcShjYXJlSGlzdG9yeS5pZCwgaWQpKVxuICAgICAgLmxpbWl0KDEpO1xuXG4gICAgcmV0dXJuIGNhcmVFbnRyeSB8fCBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjYXJlIGhpc3RvcnkgZm9yIGEgc3BlY2lmaWMgcGxhbnQgaW5zdGFuY2VcbiAgICovXG4gIHN0YXRpYyBhc3luYyBnZXRDYXJlSGlzdG9yeUZvclBsYW50KFxuICAgIHBsYW50SW5zdGFuY2VJZDogbnVtYmVyLFxuICAgIHVzZXJJZDogbnVtYmVyLFxuICAgIGZpbHRlcnM/OiBQYXJ0aWFsPENhcmVGaWx0ZXJJbnB1dD5cbiAgKTogUHJvbWlzZTxFbmhhbmNlZENhcmVIaXN0b3J5W10+IHtcbiAgICAvLyBCdWlsZCB3aGVyZSBjb25kaXRpb25zXG4gICAgY29uc3QgY29uZGl0aW9ucyA9IFtcbiAgICAgIGVxKGNhcmVIaXN0b3J5LnBsYW50SW5zdGFuY2VJZCwgcGxhbnRJbnN0YW5jZUlkKSxcbiAgICAgIGVxKGNhcmVIaXN0b3J5LnVzZXJJZCwgdXNlcklkKVxuICAgIF07XG5cbiAgICBpZiAoZmlsdGVycz8uY2FyZVR5cGUpIHtcbiAgICAgIGNvbmRpdGlvbnMucHVzaChlcShjYXJlSGlzdG9yeS5jYXJlVHlwZSwgZmlsdGVycy5jYXJlVHlwZSkpO1xuICAgIH1cblxuICAgIGlmIChmaWx0ZXJzPy5zdGFydERhdGUpIHtcbiAgICAgIGNvbmRpdGlvbnMucHVzaChndGUoY2FyZUhpc3RvcnkuY2FyZURhdGUsIGZpbHRlcnMuc3RhcnREYXRlKSk7XG4gICAgfVxuXG4gICAgaWYgKGZpbHRlcnM/LmVuZERhdGUpIHtcbiAgICAgIGNvbmRpdGlvbnMucHVzaChsdGUoY2FyZUhpc3RvcnkuY2FyZURhdGUsIGZpbHRlcnMuZW5kRGF0ZSkpO1xuICAgIH1cblxuICAgIC8vIEFwcGx5IHNvcnRpbmdcbiAgICBjb25zdCBzb3J0RmllbGQgPSBmaWx0ZXJzPy5zb3J0QnkgPT09ICdjYXJlX3R5cGUnID8gY2FyZUhpc3RvcnkuY2FyZVR5cGUgOlxuICAgICAgICAgICAgICAgICAgICAgZmlsdGVycz8uc29ydEJ5ID09PSAnY3JlYXRlZF9hdCcgPyBjYXJlSGlzdG9yeS5jcmVhdGVkQXQgOlxuICAgICAgICAgICAgICAgICAgICAgY2FyZUhpc3RvcnkuY2FyZURhdGU7XG4gICAgXG4gICAgY29uc3Qgc29ydE9yZGVyID0gZmlsdGVycz8uc29ydE9yZGVyID09PSAnYXNjJyA/IGFzYyhzb3J0RmllbGQpIDogZGVzYyhzb3J0RmllbGQpO1xuXG4gICAgLy8gQnVpbGQgdGhlIHF1ZXJ5XG4gICAgbGV0IHF1ZXJ5ID0gZGJcbiAgICAgIC5zZWxlY3Qoe1xuICAgICAgICBjYXJlSGlzdG9yeTogY2FyZUhpc3RvcnksXG4gICAgICAgIHBsYW50SW5zdGFuY2U6IHBsYW50SW5zdGFuY2VzLFxuICAgICAgICBwbGFudDogcGxhbnRzLFxuICAgICAgfSlcbiAgICAgIC5mcm9tKGNhcmVIaXN0b3J5KVxuICAgICAgLmxlZnRKb2luKHBsYW50SW5zdGFuY2VzLCBlcShjYXJlSGlzdG9yeS5wbGFudEluc3RhbmNlSWQsIHBsYW50SW5zdGFuY2VzLmlkKSlcbiAgICAgIC5sZWZ0Sm9pbihwbGFudHMsIGVxKHBsYW50SW5zdGFuY2VzLnBsYW50SWQsIHBsYW50cy5pZCkpXG4gICAgICAud2hlcmUoYW5kKC4uLmNvbmRpdGlvbnMpKVxuICAgICAgLm9yZGVyQnkoc29ydE9yZGVyKTtcblxuICAgIC8vIEFwcGx5IHBhZ2luYXRpb25cbiAgICBpZiAoZmlsdGVycz8ubGltaXQpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkubGltaXQoZmlsdGVycy5saW1pdCkgYXMgYW55O1xuICAgIH1cbiAgICBpZiAoZmlsdGVycz8ub2Zmc2V0KSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5Lm9mZnNldChmaWx0ZXJzLm9mZnNldCkgYXMgYW55O1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBxdWVyeTtcblxuICAgIHJldHVybiByZXN1bHRzLm1hcChyZXN1bHQgPT4gdGhpcy5lbmhhbmNlQ2FyZUhpc3RvcnkocmVzdWx0LmNhcmVIaXN0b3J5LCByZXN1bHQucGxhbnRJbnN0YW5jZSwgcmVzdWx0LnBsYW50KSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGNhcmUgaGlzdG9yeSBmb3IgbXVsdGlwbGUgcGxhbnQgaW5zdGFuY2VzIChmb3IgZGFzaGJvYXJkKVxuICAgKi9cbiAgc3RhdGljIGFzeW5jIGdldENhcmVIaXN0b3J5Rm9yUGxhbnRzKFxuICAgIHBsYW50SW5zdGFuY2VJZHM6IG51bWJlcltdLFxuICAgIHVzZXJJZDogbnVtYmVyLFxuICAgIGZpbHRlcnM/OiBQYXJ0aWFsPENhcmVGaWx0ZXJJbnB1dD5cbiAgKTogUHJvbWlzZTxFbmhhbmNlZENhcmVIaXN0b3J5W10+IHtcbiAgICBpZiAocGxhbnRJbnN0YW5jZUlkcy5sZW5ndGggPT09IDApIHJldHVybiBbXTtcblxuICAgIC8vIEJ1aWxkIHdoZXJlIGNvbmRpdGlvbnNcbiAgICBjb25zdCBjb25kaXRpb25zID0gW1xuICAgICAgaW5BcnJheShjYXJlSGlzdG9yeS5wbGFudEluc3RhbmNlSWQsIHBsYW50SW5zdGFuY2VJZHMpLFxuICAgICAgZXEoY2FyZUhpc3RvcnkudXNlcklkLCB1c2VySWQpXG4gICAgXTtcblxuICAgIGlmIChmaWx0ZXJzPy5jYXJlVHlwZSkge1xuICAgICAgY29uZGl0aW9ucy5wdXNoKGVxKGNhcmVIaXN0b3J5LmNhcmVUeXBlLCBmaWx0ZXJzLmNhcmVUeXBlKSk7XG4gICAgfVxuXG4gICAgaWYgKGZpbHRlcnM/LnN0YXJ0RGF0ZSkge1xuICAgICAgY29uZGl0aW9ucy5wdXNoKGd0ZShjYXJlSGlzdG9yeS5jYXJlRGF0ZSwgZmlsdGVycy5zdGFydERhdGUpKTtcbiAgICB9XG5cbiAgICBpZiAoZmlsdGVycz8uZW5kRGF0ZSkge1xuICAgICAgY29uZGl0aW9ucy5wdXNoKGx0ZShjYXJlSGlzdG9yeS5jYXJlRGF0ZSwgZmlsdGVycy5lbmREYXRlKSk7XG4gICAgfVxuXG4gICAgLy8gQXBwbHkgc29ydGluZ1xuICAgIGNvbnN0IHNvcnRGaWVsZCA9IGZpbHRlcnM/LnNvcnRCeSA9PT0gJ2NhcmVfdHlwZScgPyBjYXJlSGlzdG9yeS5jYXJlVHlwZSA6XG4gICAgICAgICAgICAgICAgICAgICBmaWx0ZXJzPy5zb3J0QnkgPT09ICdjcmVhdGVkX2F0JyA/IGNhcmVIaXN0b3J5LmNyZWF0ZWRBdCA6XG4gICAgICAgICAgICAgICAgICAgICBjYXJlSGlzdG9yeS5jYXJlRGF0ZTtcbiAgICBcbiAgICBjb25zdCBzb3J0T3JkZXIgPSBmaWx0ZXJzPy5zb3J0T3JkZXIgPT09ICdhc2MnID8gYXNjKHNvcnRGaWVsZCkgOiBkZXNjKHNvcnRGaWVsZCk7XG5cbiAgICAvLyBCdWlsZCB0aGUgcXVlcnlcbiAgICBsZXQgcXVlcnkgPSBkYlxuICAgICAgLnNlbGVjdCh7XG4gICAgICAgIGNhcmVIaXN0b3J5OiBjYXJlSGlzdG9yeSxcbiAgICAgICAgcGxhbnRJbnN0YW5jZTogcGxhbnRJbnN0YW5jZXMsXG4gICAgICAgIHBsYW50OiBwbGFudHMsXG4gICAgICB9KVxuICAgICAgLmZyb20oY2FyZUhpc3RvcnkpXG4gICAgICAubGVmdEpvaW4ocGxhbnRJbnN0YW5jZXMsIGVxKGNhcmVIaXN0b3J5LnBsYW50SW5zdGFuY2VJZCwgcGxhbnRJbnN0YW5jZXMuaWQpKVxuICAgICAgLmxlZnRKb2luKHBsYW50cywgZXEocGxhbnRJbnN0YW5jZXMucGxhbnRJZCwgcGxhbnRzLmlkKSlcbiAgICAgIC53aGVyZShhbmQoLi4uY29uZGl0aW9ucykpXG4gICAgICAub3JkZXJCeShzb3J0T3JkZXIpO1xuXG4gICAgLy8gQXBwbHkgcGFnaW5hdGlvblxuICAgIGlmIChmaWx0ZXJzPy5saW1pdCkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5saW1pdChmaWx0ZXJzLmxpbWl0KSBhcyBhbnk7XG4gICAgfVxuICAgIGlmIChmaWx0ZXJzPy5vZmZzZXQpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkub2Zmc2V0KGZpbHRlcnMub2Zmc2V0KSBhcyBhbnk7XG4gICAgfVxuXG4gICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHF1ZXJ5O1xuXG4gICAgcmV0dXJuIHJlc3VsdHMubWFwKHJlc3VsdCA9PiB0aGlzLmVuaGFuY2VDYXJlSGlzdG9yeShyZXN1bHQuY2FyZUhpc3RvcnksIHJlc3VsdC5wbGFudEluc3RhbmNlLCByZXN1bHQucGxhbnQpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgcmVjZW50IGNhcmUgaGlzdG9yeSBmb3IgYSB1c2VyXG4gICAqL1xuICBzdGF0aWMgYXN5bmMgZ2V0UmVjZW50Q2FyZUhpc3RvcnkoXG4gICAgdXNlcklkOiBudW1iZXIsXG4gICAgbGltaXQ6IG51bWJlciA9IDIwXG4gICk6IFByb21pc2U8RW5oYW5jZWRDYXJlSGlzdG9yeVtdPiB7XG4gICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGRiXG4gICAgICAuc2VsZWN0KHtcbiAgICAgICAgY2FyZUhpc3Rvcnk6IGNhcmVIaXN0b3J5LFxuICAgICAgICBwbGFudEluc3RhbmNlOiBwbGFudEluc3RhbmNlcyxcbiAgICAgICAgcGxhbnQ6IHBsYW50cyxcbiAgICAgIH0pXG4gICAgICAuZnJvbShjYXJlSGlzdG9yeSlcbiAgICAgIC5sZWZ0Sm9pbihwbGFudEluc3RhbmNlcywgZXEoY2FyZUhpc3RvcnkucGxhbnRJbnN0YW5jZUlkLCBwbGFudEluc3RhbmNlcy5pZCkpXG4gICAgICAubGVmdEpvaW4ocGxhbnRzLCBlcShwbGFudEluc3RhbmNlcy5wbGFudElkLCBwbGFudHMuaWQpKVxuICAgICAgLndoZXJlKGVxKGNhcmVIaXN0b3J5LnVzZXJJZCwgdXNlcklkKSlcbiAgICAgIC5vcmRlckJ5KGRlc2MoY2FyZUhpc3RvcnkuY2FyZURhdGUpKVxuICAgICAgLmxpbWl0KGxpbWl0KTtcblxuICAgIHJldHVybiByZXN1bHRzLm1hcChyZXN1bHQgPT4gdGhpcy5lbmhhbmNlQ2FyZUhpc3RvcnkocmVzdWx0LmNhcmVIaXN0b3J5LCByZXN1bHQucGxhbnRJbnN0YW5jZSwgcmVzdWx0LnBsYW50KSk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIGNhcmUgaGlzdG9yeSBlbnRyeVxuICAgKi9cbiAgc3RhdGljIGFzeW5jIHVwZGF0ZUNhcmVIaXN0b3J5KFxuICAgIGlkOiBudW1iZXIsXG4gICAgdXNlcklkOiBudW1iZXIsXG4gICAgdXBkYXRlczogUGFydGlhbDxOZXdDYXJlSGlzdG9yeT5cbiAgKTogUHJvbWlzZTxDYXJlSGlzdG9yeSB8IG51bGw+IHtcbiAgICBjb25zdCBbdXBkYXRlZF0gPSBhd2FpdCBkYlxuICAgICAgLnVwZGF0ZShjYXJlSGlzdG9yeSlcbiAgICAgIC5zZXQoe1xuICAgICAgICAuLi51cGRhdGVzLFxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICB9KVxuICAgICAgLndoZXJlKFxuICAgICAgICBhbmQoXG4gICAgICAgICAgZXEoY2FyZUhpc3RvcnkuaWQsIGlkKSxcbiAgICAgICAgICBlcShjYXJlSGlzdG9yeS51c2VySWQsIHVzZXJJZClcbiAgICAgICAgKVxuICAgICAgKVxuICAgICAgLnJldHVybmluZygpO1xuXG4gICAgcmV0dXJuIHVwZGF0ZWQgfHwgbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxldGUgY2FyZSBoaXN0b3J5IGVudHJ5XG4gICAqL1xuICBzdGF0aWMgYXN5bmMgZGVsZXRlQ2FyZUhpc3RvcnkoaWQ6IG51bWJlciwgdXNlcklkOiBudW1iZXIpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAvLyBGaXJzdCBjaGVjayBpZiByZWNvcmQgZXhpc3RzIGFuZCBiZWxvbmdzIHRvIHVzZXJcbiAgICBjb25zdCBleGlzdGluZyA9IGF3YWl0IGRiXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5mcm9tKGNhcmVIaXN0b3J5KVxuICAgICAgLndoZXJlKFxuICAgICAgICBhbmQoXG4gICAgICAgICAgZXEoY2FyZUhpc3RvcnkuaWQsIGlkKSxcbiAgICAgICAgICBlcShjYXJlSGlzdG9yeS51c2VySWQsIHVzZXJJZClcbiAgICAgICAgKVxuICAgICAgKVxuICAgICAgLmxpbWl0KDEpO1xuICAgIFxuICAgIGlmIChleGlzdGluZy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBmYWxzZTsgLy8gUmVjb3JkIGRvZXNuJ3QgZXhpc3Qgb3IgZG9lc24ndCBiZWxvbmcgdG8gdXNlclxuICAgIH1cbiAgICBcbiAgICAvLyBQZXJmb3JtIHRoZSBkZWxldGVcbiAgICBhd2FpdCBkYlxuICAgICAgLmRlbGV0ZShjYXJlSGlzdG9yeSlcbiAgICAgIC53aGVyZShcbiAgICAgICAgYW5kKFxuICAgICAgICAgIGVxKGNhcmVIaXN0b3J5LmlkLCBpZCksXG4gICAgICAgICAgZXEoY2FyZUhpc3RvcnkudXNlcklkLCB1c2VySWQpXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgXG4gICAgLy8gVmVyaWZ5IGRlbGV0aW9uIGJ5IGNoZWNraW5nIGlmIHJlY29yZCBzdGlsbCBleGlzdHNcbiAgICBjb25zdCBzdGlsbEV4aXN0cyA9IGF3YWl0IGRiXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5mcm9tKGNhcmVIaXN0b3J5KVxuICAgICAgLndoZXJlKGVxKGNhcmVIaXN0b3J5LmlkLCBpZCkpXG4gICAgICAubGltaXQoMSk7XG4gICAgICAgIFxuICAgIHJldHVybiBzdGlsbEV4aXN0cy5sZW5ndGggPT09IDA7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGNhcmUgc3RhdGlzdGljcyBmb3IgYSBwbGFudCBpbnN0YW5jZVxuICAgKi9cbiAgc3RhdGljIGFzeW5jIGdldFBsYW50Q2FyZVN0YXRpc3RpY3MoXG4gICAgcGxhbnRJbnN0YW5jZUlkOiBudW1iZXIsXG4gICAgdXNlcklkOiBudW1iZXJcbiAgKTogUHJvbWlzZTxQbGFudENhcmVTdGF0aXN0aWNzIHwgbnVsbD4ge1xuICAgIC8vIEdldCBwbGFudCBpbnN0YW5jZVxuICAgIGNvbnN0IFtwbGFudEluc3RhbmNlXSA9IGF3YWl0IGRiXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5mcm9tKHBsYW50SW5zdGFuY2VzKVxuICAgICAgLndoZXJlKFxuICAgICAgICBhbmQoXG4gICAgICAgICAgZXEocGxhbnRJbnN0YW5jZXMuaWQsIHBsYW50SW5zdGFuY2VJZCksXG4gICAgICAgICAgZXEocGxhbnRJbnN0YW5jZXMudXNlcklkLCB1c2VySWQpXG4gICAgICAgIClcbiAgICAgIClcbiAgICAgIC5saW1pdCgxKTtcblxuICAgIGlmICghcGxhbnRJbnN0YW5jZSkgcmV0dXJuIG51bGw7XG5cbiAgICAvLyBHZXQgY2FyZSBoaXN0b3J5XG4gICAgY29uc3QgY2FyZUhpc3RvcnlEYXRhID0gYXdhaXQgZGJcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLmZyb20oY2FyZUhpc3RvcnkpXG4gICAgICAud2hlcmUoXG4gICAgICAgIGFuZChcbiAgICAgICAgICBlcShjYXJlSGlzdG9yeS5wbGFudEluc3RhbmNlSWQsIHBsYW50SW5zdGFuY2VJZCksXG4gICAgICAgICAgZXEoY2FyZUhpc3RvcnkudXNlcklkLCB1c2VySWQpXG4gICAgICAgIClcbiAgICAgIClcbiAgICAgIC5vcmRlckJ5KGFzYyhjYXJlSGlzdG9yeS5jYXJlRGF0ZSkpO1xuXG4gICAgcmV0dXJuIENhcmVDYWxjdWxhdG9yLmNhbGN1bGF0ZVBsYW50Q2FyZVN0YXRpc3RpY3MocGxhbnRJbnN0YW5jZSwgY2FyZUhpc3RvcnlEYXRhKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY2FyZSBzdGF0aXN0aWNzIGZvciBtdWx0aXBsZSBwbGFudHNcbiAgICovXG4gIHN0YXRpYyBhc3luYyBnZXRCdWxrQ2FyZVN0YXRpc3RpY3MoXG4gICAgcGxhbnRJbnN0YW5jZUlkczogbnVtYmVyW10sXG4gICAgdXNlcklkOiBudW1iZXJcbiAgKTogUHJvbWlzZTxQbGFudENhcmVTdGF0aXN0aWNzW10+IHtcbiAgICBpZiAocGxhbnRJbnN0YW5jZUlkcy5sZW5ndGggPT09IDApIHJldHVybiBbXTtcblxuICAgIC8vIEdldCBwbGFudCBpbnN0YW5jZXNcbiAgICBjb25zdCBwbGFudEluc3RhbmNlc0RhdGEgPSBhd2FpdCBkYlxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuZnJvbShwbGFudEluc3RhbmNlcylcbiAgICAgIC53aGVyZShcbiAgICAgICAgYW5kKFxuICAgICAgICAgIGluQXJyYXkocGxhbnRJbnN0YW5jZXMuaWQsIHBsYW50SW5zdGFuY2VJZHMpLFxuICAgICAgICAgIGVxKHBsYW50SW5zdGFuY2VzLnVzZXJJZCwgdXNlcklkKVxuICAgICAgICApXG4gICAgICApO1xuXG4gICAgLy8gR2V0IGNhcmUgaGlzdG9yeSBmb3IgYWxsIHBsYW50c1xuICAgIGNvbnN0IGNhcmVIaXN0b3J5RGF0YSA9IGF3YWl0IGRiXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5mcm9tKGNhcmVIaXN0b3J5KVxuICAgICAgLndoZXJlKFxuICAgICAgICBhbmQoXG4gICAgICAgICAgaW5BcnJheShjYXJlSGlzdG9yeS5wbGFudEluc3RhbmNlSWQsIHBsYW50SW5zdGFuY2VJZHMpLFxuICAgICAgICAgIGVxKGNhcmVIaXN0b3J5LnVzZXJJZCwgdXNlcklkKVxuICAgICAgICApXG4gICAgICApXG4gICAgICAub3JkZXJCeShhc2MoY2FyZUhpc3RvcnkuY2FyZURhdGUpKTtcblxuICAgIC8vIEdyb3VwIGNhcmUgaGlzdG9yeSBieSBwbGFudCBpbnN0YW5jZVxuICAgIGNvbnN0IGNhcmVIaXN0b3J5QnlQbGFudCA9IGNhcmVIaXN0b3J5RGF0YS5yZWR1Y2UoKGFjYywgY2FyZSkgPT4ge1xuICAgICAgaWYgKCFhY2NbY2FyZS5wbGFudEluc3RhbmNlSWRdKSB7XG4gICAgICAgIGFjY1tjYXJlLnBsYW50SW5zdGFuY2VJZF0gPSBbXTtcbiAgICAgIH1cbiAgICAgIGFjY1tjYXJlLnBsYW50SW5zdGFuY2VJZF0ucHVzaChjYXJlKTtcbiAgICAgIHJldHVybiBhY2M7XG4gICAgfSwge30gYXMgUmVjb3JkPG51bWJlciwgQ2FyZUhpc3RvcnlbXT4pO1xuXG4gICAgLy8gQ2FsY3VsYXRlIHN0YXRpc3RpY3MgZm9yIGVhY2ggcGxhbnRcbiAgICByZXR1cm4gcGxhbnRJbnN0YW5jZXNEYXRhLm1hcChwbGFudEluc3RhbmNlID0+IFxuICAgICAgQ2FyZUNhbGN1bGF0b3IuY2FsY3VsYXRlUGxhbnRDYXJlU3RhdGlzdGljcyhcbiAgICAgICAgcGxhbnRJbnN0YW5jZSwgXG4gICAgICAgIGNhcmVIaXN0b3J5QnlQbGFudFtwbGFudEluc3RhbmNlLmlkXSB8fCBbXVxuICAgICAgKVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGNhcmUgZGFzaGJvYXJkIGRhdGFcbiAgICovXG4gIHN0YXRpYyBhc3luYyBnZXRDYXJlRGFzaGJvYXJkRGF0YShcbiAgICB1c2VySWQ6IG51bWJlcixcbiAgICBvcHRpb25zOiBQYXJ0aWFsPENhcmVEYXNoYm9hcmRRdWVyeUlucHV0PiA9IHt9XG4gICk6IFByb21pc2U8Q2FyZURhc2hib2FyZERhdGE+IHtcbiAgICBjb25zdCB7IGluY2x1ZGVJbmFjdGl2ZSA9IGZhbHNlLCBkYXlzQWhlYWQgPSA3IH0gPSBvcHRpb25zO1xuXG4gICAgLy8gR2V0IGFsbCBwbGFudCBpbnN0YW5jZXMgZm9yIHRoZSB1c2VyXG4gICAgY29uc3QgcGxhbnRJbnN0YW5jZXNEYXRhID0gYXdhaXQgZGJcbiAgICAgIC5zZWxlY3Qoe1xuICAgICAgICBwbGFudEluc3RhbmNlOiBwbGFudEluc3RhbmNlcyxcbiAgICAgICAgcGxhbnQ6IHBsYW50cyxcbiAgICAgIH0pXG4gICAgICAuZnJvbShwbGFudEluc3RhbmNlcylcbiAgICAgIC5sZWZ0Sm9pbihwbGFudHMsIGVxKHBsYW50SW5zdGFuY2VzLnBsYW50SWQsIHBsYW50cy5pZCkpXG4gICAgICAud2hlcmUoXG4gICAgICAgIGluY2x1ZGVJbmFjdGl2ZSBcbiAgICAgICAgICA/IGVxKHBsYW50SW5zdGFuY2VzLnVzZXJJZCwgdXNlcklkKVxuICAgICAgICAgIDogYW5kKFxuICAgICAgICAgICAgICBlcShwbGFudEluc3RhbmNlcy51c2VySWQsIHVzZXJJZCksXG4gICAgICAgICAgICAgIGVxKHBsYW50SW5zdGFuY2VzLmlzQWN0aXZlLCB0cnVlKVxuICAgICAgICAgICAgKVxuICAgICAgKTtcblxuICAgIC8vIEdldCByZWNlbnQgY2FyZSBoaXN0b3J5IGZvciBzdGF0aXN0aWNzXG4gICAgY29uc3Qgb25lV2Vla0FnbyA9IG5ldyBEYXRlKCk7XG4gICAgb25lV2Vla0Fnby5zZXREYXRlKG9uZVdlZWtBZ28uZ2V0RGF0ZSgpIC0gNyk7XG5cbiAgICBjb25zdCByZWNlbnRDYXJlSGlzdG9yeSA9IGF3YWl0IGRiXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5mcm9tKGNhcmVIaXN0b3J5KVxuICAgICAgLndoZXJlKFxuICAgICAgICBhbmQoXG4gICAgICAgICAgZXEoY2FyZUhpc3RvcnkudXNlcklkLCB1c2VySWQpLFxuICAgICAgICAgIGd0ZShjYXJlSGlzdG9yeS5jYXJlRGF0ZSwgb25lV2Vla0FnbylcbiAgICAgICAgKVxuICAgICAgKTtcblxuICAgIC8vIEVuaGFuY2UgcGxhbnQgaW5zdGFuY2VzIHdpdGggY2FyZSBjYWxjdWxhdGlvbnNcbiAgICBjb25zdCBlbmhhbmNlZFBsYW50cyA9IHBsYW50SW5zdGFuY2VzRGF0YS5tYXAoKHsgcGxhbnRJbnN0YW5jZSwgcGxhbnQgfSkgPT4ge1xuICAgICAgaWYgKCFwbGFudCkgcmV0dXJuIG51bGw7XG4gICAgICBcbiAgICAgIGNvbnN0IGNhcmVTdGF0dXMgPSBDYXJlQ2FsY3VsYXRvci5jYWxjdWxhdGVDYXJlU3RhdHVzKHBsYW50SW5zdGFuY2UuZmVydGlsaXplckR1ZSk7XG4gICAgICBjb25zdCBjYXJlVXJnZW5jeSA9IENhcmVDYWxjdWxhdG9yLmNhbGN1bGF0ZUNhcmVVcmdlbmN5KHBsYW50SW5zdGFuY2UuZmVydGlsaXplckR1ZSk7XG4gICAgICBjb25zdCBkYXlzVW50aWxGZXJ0aWxpemVyRHVlID0gQ2FyZUNhbGN1bGF0b3IuY2FsY3VsYXRlRGF5c1VudGlsRmVydGlsaXplckR1ZShwbGFudEluc3RhbmNlLmZlcnRpbGl6ZXJEdWUpO1xuICAgICAgY29uc3QgZGF5c1NpbmNlTGFzdEZlcnRpbGl6ZWQgPSBDYXJlQ2FsY3VsYXRvci5jYWxjdWxhdGVEYXlzU2luY2VMYXN0RmVydGlsaXplZChwbGFudEluc3RhbmNlLmxhc3RGZXJ0aWxpemVkKTtcbiAgICAgIGNvbnN0IGRheXNTaW5jZUxhc3RSZXBvdCA9IENhcmVDYWxjdWxhdG9yLmNhbGN1bGF0ZURheXNTaW5jZUxhc3RSZXBvdChwbGFudEluc3RhbmNlLmxhc3RSZXBvdCk7XG4gICAgICBjb25zdCBkaXNwbGF5TmFtZSA9IHBsYW50SW5zdGFuY2Uubmlja25hbWUgfHwgcGxhbnQuY29tbW9uTmFtZTtcbiAgICAgIGNvbnN0IHByaW1hcnlJbWFnZSA9IHBsYW50SW5zdGFuY2UuaW1hZ2VzPy5bMF0gfHwgcGxhbnQuZGVmYXVsdEltYWdlIHx8IG51bGw7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnBsYW50SW5zdGFuY2UsXG4gICAgICAgIHBsYW50LFxuICAgICAgICBjYXJlU3RhdHVzLFxuICAgICAgICBjYXJlVXJnZW5jeSxcbiAgICAgICAgZGF5c1VudGlsRmVydGlsaXplckR1ZSxcbiAgICAgICAgZGF5c1NpbmNlTGFzdEZlcnRpbGl6ZWQsXG4gICAgICAgIGRheXNTaW5jZUxhc3RSZXBvdCxcbiAgICAgICAgZGlzcGxheU5hbWUsXG4gICAgICAgIHByaW1hcnlJbWFnZSxcbiAgICAgIH07XG4gICAgfSkuZmlsdGVyKChwbGFudCk6IHBsYW50IGlzIEVuaGFuY2VkUGxhbnRJbnN0YW5jZSA9PiBwbGFudCAhPT0gbnVsbCk7XG5cbiAgICAvLyBDYXRlZ29yaXplIHBsYW50cyBieSBjYXJlIHN0YXR1c1xuICAgIGNvbnN0IG92ZXJkdWUgPSBlbmhhbmNlZFBsYW50cy5maWx0ZXIocCA9PiBwLmNhcmVTdGF0dXMgPT09ICdvdmVyZHVlJyk7XG4gICAgY29uc3QgZHVlVG9kYXkgPSBlbmhhbmNlZFBsYW50cy5maWx0ZXIocCA9PiBwLmNhcmVTdGF0dXMgPT09ICdkdWVfdG9kYXknKTtcbiAgICBjb25zdCBkdWVTb29uID0gZW5oYW5jZWRQbGFudHMuZmlsdGVyKHAgPT4gcC5jYXJlU3RhdHVzID09PSAnZHVlX3Nvb24nKTtcbiAgICBcbiAgICAvLyBHZXQgcmVjZW50bHkgY2FyZWQgcGxhbnRzIChmZXJ0aWxpemVkIGluIGxhc3QgMyBkYXlzKVxuICAgIGNvbnN0IHRocmVlRGF5c0FnbyA9IG5ldyBEYXRlKCk7XG4gICAgdGhyZWVEYXlzQWdvLnNldERhdGUodGhyZWVEYXlzQWdvLmdldERhdGUoKSAtIDMpO1xuICAgIGNvbnN0IHJlY2VudGx5Q2FyZWQgPSBlbmhhbmNlZFBsYW50cy5maWx0ZXIocCA9PiBcbiAgICAgIHAubGFzdEZlcnRpbGl6ZWQgJiYgcC5sYXN0RmVydGlsaXplZCA+PSB0aHJlZURheXNBZ29cbiAgICApO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGNhcmUgc3RyZWFrIChjb25zZWN1dGl2ZSBkYXlzIHdpdGggcHJvcGVyIGNhcmUpXG4gICAgY29uc3QgY2FyZVN0cmVha0RheXMgPSB0aGlzLmNhbGN1bGF0ZVVzZXJDYXJlU3RyZWFrKHVzZXJJZCwgcmVjZW50Q2FyZUhpc3RvcnkpO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGF2ZXJhZ2UgY2FyZSBjb25zaXN0ZW5jeSBhY3Jvc3MgYWxsIHBsYW50c1xuICAgIGNvbnN0IGF2ZXJhZ2VDYXJlQ29uc2lzdGVuY3kgPSBlbmhhbmNlZFBsYW50cy5sZW5ndGggPiAwXG4gICAgICA/IGVuaGFuY2VkUGxhbnRzLnJlZHVjZSgoc3VtLCBwbGFudCkgPT4ge1xuICAgICAgICAgIC8vIFNpbXBsaWZpZWQgY29uc2lzdGVuY3kgY2FsY3VsYXRpb24gZm9yIGRhc2hib2FyZFxuICAgICAgICAgIGNvbnN0IGRheXNTaW5jZSA9IHBsYW50LmRheXNTaW5jZUxhc3RGZXJ0aWxpemVkIHx8IDA7XG4gICAgICAgICAgY29uc3Qgc2NoZWR1bGVEYXlzID0gY2FyZUhlbHBlcnMucGFyc2VGZXJ0aWxpemVyU2NoZWR1bGUocGxhbnQuZmVydGlsaXplclNjaGVkdWxlKTtcbiAgICAgICAgICBjb25zdCBjb25zaXN0ZW5jeSA9IE1hdGgubWF4KDAsIDEwMCAtIChkYXlzU2luY2UgLyBzY2hlZHVsZURheXMpICogNTApO1xuICAgICAgICAgIHJldHVybiBzdW0gKyBjb25zaXN0ZW5jeTtcbiAgICAgICAgfSwgMCkgLyBlbmhhbmNlZFBsYW50cy5sZW5ndGhcbiAgICAgIDogMDtcblxuICAgIHJldHVybiB7XG4gICAgICBvdmVyZHVlLFxuICAgICAgZHVlVG9kYXksXG4gICAgICBkdWVTb29uLFxuICAgICAgcmVjZW50bHlDYXJlZCxcbiAgICAgIHN0YXRpc3RpY3M6IHtcbiAgICAgICAgdG90YWxBY3RpdmVQbGFudHM6IGVuaGFuY2VkUGxhbnRzLmxlbmd0aCxcbiAgICAgICAgb3ZlcmR1ZUNvdW50OiBvdmVyZHVlLmxlbmd0aCxcbiAgICAgICAgZHVlVG9kYXlDb3VudDogZHVlVG9kYXkubGVuZ3RoLFxuICAgICAgICBkdWVTb29uQ291bnQ6IGR1ZVNvb24ubGVuZ3RoLFxuICAgICAgICBjYXJlU3RyZWFrRGF5cyxcbiAgICAgICAgdG90YWxDYXJlRXZlbnRzVGhpc1dlZWs6IHJlY2VudENhcmVIaXN0b3J5Lmxlbmd0aCxcbiAgICAgICAgYXZlcmFnZUNhcmVDb25zaXN0ZW5jeTogTWF0aC5yb3VuZChhdmVyYWdlQ2FyZUNvbnNpc3RlbmN5KSxcbiAgICAgIH0sXG4gICAgICBxdWlja0FjdGlvbnM6IGNhcmVIZWxwZXJzLmdldERlZmF1bHRRdWlja0NhcmVBY3Rpb25zKCksXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY2FyZSBoaXN0b3J5IGNvdW50IGZvciBhIHBsYW50IGluc3RhbmNlXG4gICAqL1xuICBzdGF0aWMgYXN5bmMgZ2V0Q2FyZUhpc3RvcnlDb3VudChcbiAgICBwbGFudEluc3RhbmNlSWQ6IG51bWJlcixcbiAgICB1c2VySWQ6IG51bWJlcixcbiAgICBjYXJlVHlwZT86IENhcmVUeXBlXG4gICk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgY29uc3QgY29uZGl0aW9ucyA9IFtcbiAgICAgIGVxKGNhcmVIaXN0b3J5LnBsYW50SW5zdGFuY2VJZCwgcGxhbnRJbnN0YW5jZUlkKSxcbiAgICAgIGVxKGNhcmVIaXN0b3J5LnVzZXJJZCwgdXNlcklkKVxuICAgIF07XG5cbiAgICBpZiAoY2FyZVR5cGUpIHtcbiAgICAgIGNvbmRpdGlvbnMucHVzaChlcShjYXJlSGlzdG9yeS5jYXJlVHlwZSwgY2FyZVR5cGUpKTtcbiAgICB9XG5cbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiXG4gICAgICAuc2VsZWN0KHsgY291bnQ6IGNvdW50KCkgfSlcbiAgICAgIC5mcm9tKGNhcmVIaXN0b3J5KVxuICAgICAgLndoZXJlKGFuZCguLi5jb25kaXRpb25zKSk7XG5cbiAgICByZXR1cm4gcmVzdWx0LmNvdW50O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBsYXN0IGNhcmUgZGF0ZSBmb3IgYSBzcGVjaWZpYyBjYXJlIHR5cGVcbiAgICovXG4gIHN0YXRpYyBhc3luYyBnZXRMYXN0Q2FyZURhdGUoXG4gICAgcGxhbnRJbnN0YW5jZUlkOiBudW1iZXIsXG4gICAgdXNlcklkOiBudW1iZXIsXG4gICAgY2FyZVR5cGU6IENhcmVUeXBlXG4gICk6IFByb21pc2U8RGF0ZSB8IG51bGw+IHtcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiXG4gICAgICAuc2VsZWN0KHsgY2FyZURhdGU6IGNhcmVIaXN0b3J5LmNhcmVEYXRlIH0pXG4gICAgICAuZnJvbShjYXJlSGlzdG9yeSlcbiAgICAgIC53aGVyZShcbiAgICAgICAgYW5kKFxuICAgICAgICAgIGVxKGNhcmVIaXN0b3J5LnBsYW50SW5zdGFuY2VJZCwgcGxhbnRJbnN0YW5jZUlkKSxcbiAgICAgICAgICBlcShjYXJlSGlzdG9yeS51c2VySWQsIHVzZXJJZCksXG4gICAgICAgICAgZXEoY2FyZUhpc3RvcnkuY2FyZVR5cGUsIGNhcmVUeXBlKVxuICAgICAgICApXG4gICAgICApXG4gICAgICAub3JkZXJCeShkZXNjKGNhcmVIaXN0b3J5LmNhcmVEYXRlKSlcbiAgICAgIC5saW1pdCgxKTtcblxuICAgIHJldHVybiByZXN1bHQ/LmNhcmVEYXRlIHx8IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogQnVsayBjcmVhdGUgY2FyZSBoaXN0b3J5IGVudHJpZXNcbiAgICovXG4gIHN0YXRpYyBhc3luYyBidWxrQ3JlYXRlQ2FyZUhpc3RvcnkoZW50cmllczogTmV3Q2FyZUhpc3RvcnlbXSk6IFByb21pc2U8Q2FyZUhpc3RvcnlbXT4ge1xuICAgIGlmIChlbnRyaWVzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIFtdO1xuXG4gICAgY29uc3QgZW50cmllc1dpdGhUaW1lc3RhbXBzID0gZW50cmllcy5tYXAoZW50cnkgPT4gKHtcbiAgICAgIC4uLmVudHJ5LFxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgIH0pKTtcblxuICAgIHJldHVybiBhd2FpdCBkYlxuICAgICAgLmluc2VydChjYXJlSGlzdG9yeSlcbiAgICAgIC52YWx1ZXMoZW50cmllc1dpdGhUaW1lc3RhbXBzKVxuICAgICAgLnJldHVybmluZygpO1xuICB9XG5cbiAgLyoqXG4gICAqIFByaXZhdGUgaGVscGVyIHRvIGVuaGFuY2UgY2FyZSBoaXN0b3J5IHdpdGggY29tcHV0ZWQgcHJvcGVydGllc1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgZW5oYW5jZUNhcmVIaXN0b3J5KFxuICAgIGNhcmU6IENhcmVIaXN0b3J5LFxuICAgIHBsYW50SW5zdGFuY2U/OiBQbGFudEluc3RhbmNlIHwgbnVsbCxcbiAgICBwbGFudD86IFBsYW50IHwgbnVsbFxuICApOiBFbmhhbmNlZENhcmVIaXN0b3J5IHtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGRheXNTaW5jZUNhcmUgPSBNYXRoLmZsb29yKChub3cuZ2V0VGltZSgpIC0gY2FyZS5jYXJlRGF0ZS5nZXRUaW1lKCkpIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpKTtcbiAgICBjb25zdCBmb3JtYXR0ZWREYXRlID0gY2FyZUhlbHBlcnMuZm9ybWF0Q2FyZURhdGUoY2FyZS5jYXJlRGF0ZSk7XG4gICAgY29uc3QgY2FyZVR5cGVEaXNwbGF5ID0gY2FyZUhlbHBlcnMuZ2V0Q2FyZVR5cGVEaXNwbGF5KGNhcmUuY2FyZVR5cGUgYXMgQ2FyZVR5cGUpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLmNhcmUsXG4gICAgICBwbGFudEluc3RhbmNlOiBwbGFudEluc3RhbmNlICYmIHBsYW50ID8geyAuLi5wbGFudEluc3RhbmNlLCBwbGFudCB9IDogdW5kZWZpbmVkLFxuICAgICAgZGF5c1NpbmNlQ2FyZSxcbiAgICAgIGZvcm1hdHRlZERhdGUsXG4gICAgICBjYXJlVHlwZURpc3BsYXksXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQcml2YXRlIGhlbHBlciB0byBjYWxjdWxhdGUgdXNlciBjYXJlIHN0cmVha1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgY2FsY3VsYXRlVXNlckNhcmVTdHJlYWsoXG4gICAgdXNlcklkOiBudW1iZXIsXG4gICAgcmVjZW50Q2FyZUhpc3Rvcnk6IENhcmVIaXN0b3J5W11cbiAgKTogbnVtYmVyIHtcbiAgICAvLyBTaW1wbGlmaWVkIGNhcmUgc3RyZWFrIGNhbGN1bGF0aW9uXG4gICAgLy8gQ291bnQgY29uc2VjdXRpdmUgZGF5cyB3aXRoIGF0IGxlYXN0IG9uZSBjYXJlIGV2ZW50XG4gICAgY29uc3QgY2FyZUJ5RGF0ZSA9IHJlY2VudENhcmVIaXN0b3J5LnJlZHVjZSgoYWNjLCBjYXJlKSA9PiB7XG4gICAgICBjb25zdCBkYXRlS2V5ID0gY2FyZS5jYXJlRGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XG4gICAgICBhY2NbZGF0ZUtleV0gPSB0cnVlO1xuICAgICAgcmV0dXJuIGFjYztcbiAgICB9LCB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPik7XG5cbiAgICBsZXQgc3RyZWFrID0gMDtcbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7XG4gICAgXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAzMDsgaSsrKSB7IC8vIENoZWNrIGxhc3QgMzAgZGF5c1xuICAgICAgY29uc3QgY2hlY2tEYXRlID0gbmV3IERhdGUodG9kYXkpO1xuICAgICAgY2hlY2tEYXRlLnNldERhdGUoY2hlY2tEYXRlLmdldERhdGUoKSAtIGkpO1xuICAgICAgY29uc3QgZGF0ZUtleSA9IGNoZWNrRGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XG4gICAgICBcbiAgICAgIGlmIChjYXJlQnlEYXRlW2RhdGVLZXldKSB7XG4gICAgICAgIHN0cmVhaysrO1xuICAgICAgfSBlbHNlIGlmIChpID4gMCkgeyAvLyBEb24ndCBicmVhayBvbiBmaXJzdCBkYXkgKHRvZGF5KSBpZiBubyBjYXJlXG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBzdHJlYWs7XG4gIH1cbn0iXSwibmFtZXMiOlsiQ2FyZUhpc3RvcnlRdWVyaWVzIiwiY3JlYXRlQ2FyZUhpc3RvcnkiLCJkYXRhIiwiY2FyZUVudHJ5IiwiZGIiLCJpbnNlcnQiLCJjYXJlSGlzdG9yeSIsInZhbHVlcyIsImNyZWF0ZWRBdCIsIkRhdGUiLCJ1cGRhdGVkQXQiLCJyZXR1cm5pbmciLCJnZXRDYXJlSGlzdG9yeUJ5SWQiLCJpZCIsInNlbGVjdCIsImZyb20iLCJ3aGVyZSIsImVxIiwibGltaXQiLCJnZXRDYXJlSGlzdG9yeUZvclBsYW50IiwicGxhbnRJbnN0YW5jZUlkIiwidXNlcklkIiwiZmlsdGVycyIsImNvbmRpdGlvbnMiLCJjYXJlVHlwZSIsInB1c2giLCJzdGFydERhdGUiLCJndGUiLCJjYXJlRGF0ZSIsImVuZERhdGUiLCJsdGUiLCJzb3J0RmllbGQiLCJzb3J0QnkiLCJzb3J0T3JkZXIiLCJhc2MiLCJkZXNjIiwicXVlcnkiLCJwbGFudEluc3RhbmNlIiwicGxhbnRJbnN0YW5jZXMiLCJwbGFudCIsInBsYW50cyIsImxlZnRKb2luIiwicGxhbnRJZCIsImFuZCIsIm9yZGVyQnkiLCJvZmZzZXQiLCJyZXN1bHRzIiwibWFwIiwicmVzdWx0IiwiZW5oYW5jZUNhcmVIaXN0b3J5IiwiZ2V0Q2FyZUhpc3RvcnlGb3JQbGFudHMiLCJwbGFudEluc3RhbmNlSWRzIiwibGVuZ3RoIiwiaW5BcnJheSIsImdldFJlY2VudENhcmVIaXN0b3J5IiwidXBkYXRlQ2FyZUhpc3RvcnkiLCJ1cGRhdGVzIiwidXBkYXRlZCIsInVwZGF0ZSIsInNldCIsImRlbGV0ZUNhcmVIaXN0b3J5IiwiZXhpc3RpbmciLCJkZWxldGUiLCJzdGlsbEV4aXN0cyIsImdldFBsYW50Q2FyZVN0YXRpc3RpY3MiLCJjYXJlSGlzdG9yeURhdGEiLCJDYXJlQ2FsY3VsYXRvciIsImNhbGN1bGF0ZVBsYW50Q2FyZVN0YXRpc3RpY3MiLCJnZXRCdWxrQ2FyZVN0YXRpc3RpY3MiLCJwbGFudEluc3RhbmNlc0RhdGEiLCJjYXJlSGlzdG9yeUJ5UGxhbnQiLCJyZWR1Y2UiLCJhY2MiLCJjYXJlIiwiZ2V0Q2FyZURhc2hib2FyZERhdGEiLCJvcHRpb25zIiwiaW5jbHVkZUluYWN0aXZlIiwiZGF5c0FoZWFkIiwiaXNBY3RpdmUiLCJvbmVXZWVrQWdvIiwic2V0RGF0ZSIsImdldERhdGUiLCJyZWNlbnRDYXJlSGlzdG9yeSIsImVuaGFuY2VkUGxhbnRzIiwiY2FyZVN0YXR1cyIsImNhbGN1bGF0ZUNhcmVTdGF0dXMiLCJmZXJ0aWxpemVyRHVlIiwiY2FyZVVyZ2VuY3kiLCJjYWxjdWxhdGVDYXJlVXJnZW5jeSIsImRheXNVbnRpbEZlcnRpbGl6ZXJEdWUiLCJjYWxjdWxhdGVEYXlzVW50aWxGZXJ0aWxpemVyRHVlIiwiZGF5c1NpbmNlTGFzdEZlcnRpbGl6ZWQiLCJjYWxjdWxhdGVEYXlzU2luY2VMYXN0RmVydGlsaXplZCIsImxhc3RGZXJ0aWxpemVkIiwiZGF5c1NpbmNlTGFzdFJlcG90IiwiY2FsY3VsYXRlRGF5c1NpbmNlTGFzdFJlcG90IiwibGFzdFJlcG90IiwiZGlzcGxheU5hbWUiLCJuaWNrbmFtZSIsImNvbW1vbk5hbWUiLCJwcmltYXJ5SW1hZ2UiLCJpbWFnZXMiLCJkZWZhdWx0SW1hZ2UiLCJmaWx0ZXIiLCJvdmVyZHVlIiwicCIsImR1ZVRvZGF5IiwiZHVlU29vbiIsInRocmVlRGF5c0FnbyIsInJlY2VudGx5Q2FyZWQiLCJjYXJlU3RyZWFrRGF5cyIsImNhbGN1bGF0ZVVzZXJDYXJlU3RyZWFrIiwiYXZlcmFnZUNhcmVDb25zaXN0ZW5jeSIsInN1bSIsImRheXNTaW5jZSIsInNjaGVkdWxlRGF5cyIsImNhcmVIZWxwZXJzIiwicGFyc2VGZXJ0aWxpemVyU2NoZWR1bGUiLCJmZXJ0aWxpemVyU2NoZWR1bGUiLCJjb25zaXN0ZW5jeSIsIk1hdGgiLCJtYXgiLCJzdGF0aXN0aWNzIiwidG90YWxBY3RpdmVQbGFudHMiLCJvdmVyZHVlQ291bnQiLCJkdWVUb2RheUNvdW50IiwiZHVlU29vbkNvdW50IiwidG90YWxDYXJlRXZlbnRzVGhpc1dlZWsiLCJyb3VuZCIsInF1aWNrQWN0aW9ucyIsImdldERlZmF1bHRRdWlja0NhcmVBY3Rpb25zIiwiZ2V0Q2FyZUhpc3RvcnlDb3VudCIsImNvdW50IiwiZ2V0TGFzdENhcmVEYXRlIiwiYnVsa0NyZWF0ZUNhcmVIaXN0b3J5IiwiZW50cmllcyIsImVudHJpZXNXaXRoVGltZXN0YW1wcyIsImVudHJ5Iiwibm93IiwiZGF5c1NpbmNlQ2FyZSIsImZsb29yIiwiZ2V0VGltZSIsImZvcm1hdHRlZERhdGUiLCJmb3JtYXRDYXJlRGF0ZSIsImNhcmVUeXBlRGlzcGxheSIsImdldENhcmVUeXBlRGlzcGxheSIsInVuZGVmaW5lZCIsImNhcmVCeURhdGUiLCJkYXRlS2V5IiwidG9JU09TdHJpbmciLCJzcGxpdCIsInN0cmVhayIsInRvZGF5IiwiaSIsImNoZWNrRGF0ZSJdLCJtYXBwaW5ncyI6Ijs7OzsrQkEyQmFBOzs7ZUFBQUE7OztvQkEzQk07d0JBQ2lDOzRCQUNjO2dDQW1CbkM7MkJBQ0g7QUFLckIsTUFBTUE7SUFDWDs7R0FFQyxHQUNELGFBQWFDLGtCQUFrQkMsSUFBb0IsRUFBd0I7UUFDekUsTUFBTSxDQUFDQyxVQUFVLEdBQUcsTUFBTUMsTUFBRSxDQUN6QkMsTUFBTSxDQUFDQyxtQkFBVyxFQUNsQkMsTUFBTSxDQUFDO1lBQ04sR0FBR0wsSUFBSTtZQUNQTSxXQUFXLElBQUlDO1lBQ2ZDLFdBQVcsSUFBSUQ7UUFDakIsR0FDQ0UsU0FBUztRQUVaLE9B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