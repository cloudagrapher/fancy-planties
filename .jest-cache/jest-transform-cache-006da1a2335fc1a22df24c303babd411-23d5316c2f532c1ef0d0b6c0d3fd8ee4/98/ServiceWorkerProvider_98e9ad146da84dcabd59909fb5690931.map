{"version":3,"names":["cov_8dvjtxb50","actualCoverage","s","ServiceWorkerProvider","children","f","register","skipWaiting","cacheOfflineData","_serviceworker","useServiceWorker","cacheData","_useOffline","useOffline","updateAvailable","setUpdateAvailable","_react","useState","showUpdatePrompt","setShowUpdatePrompt","useEffect","handleUpdateAvailable","handleSyncComplete","event","console","log","detail","window","addEventListener","removeEventListener","handleUpdateApp","location","reload","dismissUpdate","_jsxruntime","jsxs","Fragment","b","jsx","className","fill","viewBox","fillRule","d","clipRule","onClick"],"sources":["/Users/stefanbekker/projects/fancy-planties/src/components/shared/ServiceWorkerProvider.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useServiceWorker } from '@/lib/utils/service-worker';\nimport { useOffline } from '@/hooks/useOffline';\n\n/**\n * Service Worker Provider Component\n * Handles service worker registration and update notifications\n */\nexport function ServiceWorkerProvider({ children }: { children: React.ReactNode }) {\n  const { register, skipWaiting, cacheOfflineData } = useServiceWorker();\n  const { cacheOfflineData: cacheData } = useOffline();\n  const [updateAvailable, setUpdateAvailable] = useState(false);\n  const [showUpdatePrompt, setShowUpdatePrompt] = useState(false);\n\n  useEffect(() => {\n    // Register service worker on mount\n    register();\n\n    // Listen for update available\n    const handleUpdateAvailable = () => {\n      setUpdateAvailable(true);\n      setShowUpdatePrompt(true);\n    };\n\n    // Listen for sync complete\n    const handleSyncComplete = (event: CustomEvent) => {\n      console.log('Sync completed:', event.detail);\n      // Refresh cached data after sync\n      cacheData();\n    };\n\n    window.addEventListener('sw-update-available', handleUpdateAvailable);\n    window.addEventListener('sw-sync-complete', handleSyncComplete as EventListener);\n\n    return () => {\n      window.removeEventListener('sw-update-available', handleUpdateAvailable);\n      window.removeEventListener('sw-sync-complete', handleSyncComplete as EventListener);\n    };\n  }, [register, cacheData]);\n\n  const handleUpdateApp = () => {\n    skipWaiting();\n    setShowUpdatePrompt(false);\n    // Reload the page to get the new version\n    window.location.reload();\n  };\n\n  const dismissUpdate = () => {\n    setShowUpdatePrompt(false);\n  };\n\n  return (\n    <>\n      {children}\n      \n      {/* Update Available Notification */}\n      {showUpdatePrompt && (\n        <div className=\"fixed bottom-4 left-4 right-4 z-50 md:left-auto md:right-4 md:w-96\">\n          <div className=\"bg-white border border-gray-200 rounded-lg shadow-lg p-4\">\n            <div className=\"flex items-start gap-3\">\n              <div className=\"flex-shrink-0\">\n                <div className=\"w-8 h-8 bg-primary-200 rounded-full flex items-center justify-center\">\n                  <svg className=\"w-4 h-4 text-primary-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fillRule=\"evenodd\" d=\"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z\" clipRule=\"evenodd\" />\n                  </svg>\n                </div>\n              </div>\n              \n              <div className=\"flex-1 min-w-0\">\n                <h3 className=\"text-sm font-medium text-gray-900\">\n                  App Update Available\n                </h3>\n                <p className=\"text-sm text-gray-600 mt-1\">\n                  A new version of Fancy Planties is available with improvements and bug fixes.\n                </p>\n                \n                <div className=\"flex gap-2 mt-3\">\n                  <button\n                    onClick={handleUpdateApp}\n                    className=\"px-3 py-1.5 bg-primary-200 text-primary-800 text-sm font-medium rounded-md hover:bg-primary-300 transition-colors\"\n                  >\n                    Update Now\n                  </button>\n                  <button\n                    onClick={dismissUpdate}\n                    className=\"px-3 py-1.5 text-gray-600 text-sm font-medium rounded-md hover:bg-gray-100 transition-colors\"\n                  >\n                    Later\n                  </button>\n                </div>\n              </div>\n              \n              <button\n                onClick={dismissUpdate}\n                className=\"flex-shrink-0 p-1 text-gray-400 hover:text-gray-600 transition-colors\"\n              >\n                <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                  <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n                </svg>\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n}"],"mappings":"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","ignoreList":[]}