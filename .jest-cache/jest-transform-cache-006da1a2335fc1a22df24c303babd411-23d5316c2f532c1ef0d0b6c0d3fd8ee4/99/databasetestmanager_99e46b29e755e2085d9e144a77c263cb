2369fef54bb282db16a2a408eb8079dd
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get createDatabaseTestManager () {
        return createDatabaseTestManager;
    },
    get default () {
        return _default;
    },
    get globalDatabaseTestManager () {
        return globalDatabaseTestManager;
    }
});
require("server-only");
const _db = require("../../lib/db");
const _schema = require("../../lib/db/schema");
const _drizzleorm = require("drizzle-orm");
/**
 * Database Test Manager
 * Provides isolated database operations for testing with proper cleanup
 */ class DatabaseTestManager {
    constructor(){
        this.createdUsers = [];
        this.createdSessions = [];
        this.createdEmailCodes = [];
        this.createdPlants = [];
        this.createdPlantInstances = [];
        this.createdPropagations = [];
        this.createdCareHistory = [];
    }
    /**
   * Create a test user in the database
   * @param {Object} userData - User data to insert
   * @returns {Promise<Object>} Created user
   */ async createTestUser(userData) {
        const [user] = await _db.db.insert(_schema.users).values(userData).returning();
        this.createdUsers.push(user.id);
        return user;
    }
    /**
   * Create a test session in the database
   * @param {Object} sessionData - Session data to insert
   * @returns {Promise<Object>} Created session
   */ async createTestSession(sessionData) {
        const [session] = await _db.db.insert(_schema.sessions).values(sessionData).returning();
        this.createdSessions.push(session.id);
        return session;
    }
    /**
   * Create a test email verification code in the database
   * @param {Object} codeData - Email verification code data to insert
   * @returns {Promise<Object>} Created email verification code
   */ async createTestEmailCode(codeData) {
        const [code] = await _db.db.insert(_schema.emailVerificationCodes).values(codeData).returning();
        this.createdEmailCodes.push(code.id);
        return code;
    }
    /**
   * Create a test plant in the database
   * @param {Object} plantData - Plant data to insert
   * @returns {Promise<Object>} Created plant
   */ async createTestPlant(plantData) {
        const [plant] = await _db.db.insert(_schema.plants).values(plantData).returning();
        this.createdPlants.push(plant.id);
        return plant;
    }
    /**
   * Create a test plant instance in the database
   * @param {Object} instanceData - Plant instance data to insert
   * @returns {Promise<Object>} Created plant instance
   */ async createTestPlantInstance(instanceData) {
        const [instance] = await _db.db.insert(_schema.plantInstances).values(instanceData).returning();
        this.createdPlantInstances.push(instance.id);
        return instance;
    }
    /**
   * Create a test propagation in the database
   * @param {Object} propagationData - Propagation data to insert
   * @returns {Promise<Object>} Created propagation
   */ async createTestPropagation(propagationData) {
        const [propagation] = await _db.db.insert(_schema.propagations).values(propagationData).returning();
        this.createdPropagations.push(propagation.id);
        return propagation;
    }
    /**
   * Create a test care history record in the database
   * @param {Object} careData - Care history data to insert
   * @returns {Promise<Object>} Created care history record
   */ async createTestCareHistory(careData) {
        const [care] = await _db.db.insert(_schema.careHistory).values(careData).returning();
        this.createdCareHistory.push(care.id);
        return care;
    }
    /**
   * Get a user by ID from the database
   * @param {number} userId - User ID to retrieve
   * @returns {Promise<Object|null>} User or null if not found
   */ async getUserById(userId) {
        const [user] = await _db.db.select().from(_schema.users).where((0, _drizzleorm.eq)(_schema.users.id, userId));
        return user || null;
    }
    /**
   * Get a user by email from the database
   * @param {string} email - Email to search for
   * @returns {Promise<Object|null>} User or null if not found
   */ async getUserByEmail(email) {
        const [user] = await _db.db.select().from(_schema.users).where((0, _drizzleorm.eq)(_schema.users.email, email.toLowerCase()));
        return user || null;
    }
    /**
   * Get a session by ID from the database
   * @param {string} sessionId - Session ID to retrieve
   * @returns {Promise<Object|null>} Session or null if not found
   */ async getSessionById(sessionId) {
        const [session] = await _db.db.select().from(_schema.sessions).where((0, _drizzleorm.eq)(_schema.sessions.id, sessionId));
        return session || null;
    }
    /**
   * Get sessions for a user from the database
   * @param {number} userId - User ID to get sessions for
   * @returns {Promise<Array>} Array of sessions
   */ async getSessionsByUserId(userId) {
        return await _db.db.select().from(_schema.sessions).where((0, _drizzleorm.eq)(_schema.sessions.userId, userId));
    }
    /**
   * Get email verification codes for a user
   * @param {number} userId - User ID to get codes for
   * @returns {Promise<Array>} Array of email verification codes
   */ async getEmailCodesByUserId(userId) {
        return await _db.db.select().from(_schema.emailVerificationCodes).where((0, _drizzleorm.eq)(_schema.emailVerificationCodes.userId, userId));
    }
    /**
   * Update a user in the database
   * @param {number} userId - User ID to update
   * @param {Object} updates - Updates to apply
   * @returns {Promise<Object>} Updated user
   */ async updateUser(userId, updates) {
        const [user] = await _db.db.update(_schema.users).set({
            ...updates,
            updatedAt: new Date()
        }).where((0, _drizzleorm.eq)(_schema.users.id, userId)).returning();
        return user;
    }
    /**
   * Delete a user from the database
   * @param {number} userId - User ID to delete
   * @returns {Promise<void>}
   */ async deleteUser(userId) {
        await _db.db.delete(_schema.users).where((0, _drizzleorm.eq)(_schema.users.id, userId));
        // Remove from tracking
        this.createdUsers = this.createdUsers.filter((id)=>id !== userId);
    }
    /**
   * Delete a session from the database
   * @param {string} sessionId - Session ID to delete
   * @returns {Promise<void>}
   */ async deleteSession(sessionId) {
        await _db.db.delete(_schema.sessions).where((0, _drizzleorm.eq)(_schema.sessions.id, sessionId));
        // Remove from tracking
        this.createdSessions = this.createdSessions.filter((id)=>id !== sessionId);
    }
    /**
   * Delete an email verification code from the database
   * @param {number} codeId - Code ID to delete
   * @returns {Promise<void>}
   */ async deleteEmailCode(codeId) {
        await _db.db.delete(_schema.emailVerificationCodes).where((0, _drizzleorm.eq)(_schema.emailVerificationCodes.id, codeId));
        // Remove from tracking
        this.createdEmailCodes = this.createdEmailCodes.filter((id)=>id !== codeId);
    }
    /**
   * Clean up all test data created by this manager
   * @returns {Promise<void>}
   */ async cleanup() {
        try {
            // Clean up in reverse order of dependencies to respect foreign key constraints
            // 1. Care history (references plant instances and users)
            for (const careId of this.createdCareHistory){
                await _db.db.delete(_schema.careHistory).where((0, _drizzleorm.eq)(_schema.careHistory.id, careId));
            }
            // 2. Propagations (references plant instances, plants, and users)
            for (const propagationId of this.createdPropagations){
                await _db.db.delete(_schema.propagations).where((0, _drizzleorm.eq)(_schema.propagations.id, propagationId));
            }
            // 3. Plant instances (references plants and users)
            for (const instanceId of this.createdPlantInstances){
                await _db.db.delete(_schema.plantInstances).where((0, _drizzleorm.eq)(_schema.plantInstances.id, instanceId));
            }
            // 4. Plants (references users)
            for (const plantId of this.createdPlants){
                await _db.db.delete(_schema.plants).where((0, _drizzleorm.eq)(_schema.plants.id, plantId));
            }
            // 5. Email verification codes (references users)
            for (const codeId of this.createdEmailCodes){
                await _db.db.delete(_schema.emailVerificationCodes).where((0, _drizzleorm.eq)(_schema.emailVerificationCodes.id, codeId));
            }
            // 6. Sessions (references users)
            for (const sessionId of this.createdSessions){
                await _db.db.delete(_schema.sessions).where((0, _drizzleorm.eq)(_schema.sessions.id, sessionId));
            }
            // 7. Users (no dependencies)
            for (const userId of this.createdUsers){
                await _db.db.delete(_schema.users).where((0, _drizzleorm.eq)(_schema.users.id, userId));
            }
            // Reset tracking arrays
            this.createdUsers = [];
            this.createdSessions = [];
            this.createdEmailCodes = [];
            this.createdPlants = [];
            this.createdPlantInstances = [];
            this.createdPropagations = [];
            this.createdCareHistory = [];
        } catch (error) {
            console.error('Database cleanup error:', error);
            // Reset tracking arrays even if cleanup fails
            this.createdUsers = [];
            this.createdSessions = [];
            this.createdEmailCodes = [];
            this.createdPlants = [];
            this.createdPlantInstances = [];
            this.createdPropagations = [];
            this.createdCareHistory = [];
        }
    }
    /**
   * Check if the database connection is working
   * @returns {Promise<boolean>} True if connection is working
   */ async isConnected() {
        try {
            // Simple query to test connection
            await _db.db.select().from(_schema.users).limit(1);
            return true;
        } catch (error) {
            console.error('Database connection test failed:', error);
            return false;
        }
    }
}
const createDatabaseTestManager = ()=>{
    return new DatabaseTestManager();
};
const globalDatabaseTestManager = new DatabaseTestManager();
const _default = DatabaseTestManager;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdGVmYW5iZWtrZXIvcHJvamVjdHMvZmFuY3ktcGxhbnRpZXMvc3JjL3Rlc3QtdXRpbHMvc2V0dXAvZGF0YWJhc2UtdGVzdC1tYW5hZ2VyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAnc2VydmVyLW9ubHknO1xuXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uL2xpYi9kYic7XG5pbXBvcnQgeyB1c2Vycywgc2Vzc2lvbnMsIGVtYWlsVmVyaWZpY2F0aW9uQ29kZXMsIHBsYW50cywgcGxhbnRJbnN0YW5jZXMsIHByb3BhZ2F0aW9ucywgY2FyZUhpc3RvcnkgfSBmcm9tICcuLi8uLi9saWIvZGIvc2NoZW1hJztcbmltcG9ydCB7IGVxIH0gZnJvbSAnZHJpenpsZS1vcm0nO1xuXG4vKipcbiAqIERhdGFiYXNlIFRlc3QgTWFuYWdlclxuICogUHJvdmlkZXMgaXNvbGF0ZWQgZGF0YWJhc2Ugb3BlcmF0aW9ucyBmb3IgdGVzdGluZyB3aXRoIHByb3BlciBjbGVhbnVwXG4gKi9cbmNsYXNzIERhdGFiYXNlVGVzdE1hbmFnZXIge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmNyZWF0ZWRVc2VycyA9IFtdO1xuICAgIHRoaXMuY3JlYXRlZFNlc3Npb25zID0gW107XG4gICAgdGhpcy5jcmVhdGVkRW1haWxDb2RlcyA9IFtdO1xuICAgIHRoaXMuY3JlYXRlZFBsYW50cyA9IFtdO1xuICAgIHRoaXMuY3JlYXRlZFBsYW50SW5zdGFuY2VzID0gW107XG4gICAgdGhpcy5jcmVhdGVkUHJvcGFnYXRpb25zID0gW107XG4gICAgdGhpcy5jcmVhdGVkQ2FyZUhpc3RvcnkgPSBbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSB0ZXN0IHVzZXIgaW4gdGhlIGRhdGFiYXNlXG4gICAqIEBwYXJhbSB7T2JqZWN0fSB1c2VyRGF0YSAtIFVzZXIgZGF0YSB0byBpbnNlcnRcbiAgICogQHJldHVybnMge1Byb21pc2U8T2JqZWN0Pn0gQ3JlYXRlZCB1c2VyXG4gICAqL1xuICBhc3luYyBjcmVhdGVUZXN0VXNlcih1c2VyRGF0YSkge1xuICAgIGNvbnN0IFt1c2VyXSA9IGF3YWl0IGRiLmluc2VydCh1c2VycykudmFsdWVzKHVzZXJEYXRhKS5yZXR1cm5pbmcoKTtcbiAgICB0aGlzLmNyZWF0ZWRVc2Vycy5wdXNoKHVzZXIuaWQpO1xuICAgIHJldHVybiB1c2VyO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBhIHRlc3Qgc2Vzc2lvbiBpbiB0aGUgZGF0YWJhc2VcbiAgICogQHBhcmFtIHtPYmplY3R9IHNlc3Npb25EYXRhIC0gU2Vzc2lvbiBkYXRhIHRvIGluc2VydFxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxPYmplY3Q+fSBDcmVhdGVkIHNlc3Npb25cbiAgICovXG4gIGFzeW5jIGNyZWF0ZVRlc3RTZXNzaW9uKHNlc3Npb25EYXRhKSB7XG4gICAgY29uc3QgW3Nlc3Npb25dID0gYXdhaXQgZGIuaW5zZXJ0KHNlc3Npb25zKS52YWx1ZXMoc2Vzc2lvbkRhdGEpLnJldHVybmluZygpO1xuICAgIHRoaXMuY3JlYXRlZFNlc3Npb25zLnB1c2goc2Vzc2lvbi5pZCk7XG4gICAgcmV0dXJuIHNlc3Npb247XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGEgdGVzdCBlbWFpbCB2ZXJpZmljYXRpb24gY29kZSBpbiB0aGUgZGF0YWJhc2VcbiAgICogQHBhcmFtIHtPYmplY3R9IGNvZGVEYXRhIC0gRW1haWwgdmVyaWZpY2F0aW9uIGNvZGUgZGF0YSB0byBpbnNlcnRcbiAgICogQHJldHVybnMge1Byb21pc2U8T2JqZWN0Pn0gQ3JlYXRlZCBlbWFpbCB2ZXJpZmljYXRpb24gY29kZVxuICAgKi9cbiAgYXN5bmMgY3JlYXRlVGVzdEVtYWlsQ29kZShjb2RlRGF0YSkge1xuICAgIGNvbnN0IFtjb2RlXSA9IGF3YWl0IGRiLmluc2VydChlbWFpbFZlcmlmaWNhdGlvbkNvZGVzKS52YWx1ZXMoY29kZURhdGEpLnJldHVybmluZygpO1xuICAgIHRoaXMuY3JlYXRlZEVtYWlsQ29kZXMucHVzaChjb2RlLmlkKTtcbiAgICByZXR1cm4gY29kZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSB0ZXN0IHBsYW50IGluIHRoZSBkYXRhYmFzZVxuICAgKiBAcGFyYW0ge09iamVjdH0gcGxhbnREYXRhIC0gUGxhbnQgZGF0YSB0byBpbnNlcnRcbiAgICogQHJldHVybnMge1Byb21pc2U8T2JqZWN0Pn0gQ3JlYXRlZCBwbGFudFxuICAgKi9cbiAgYXN5bmMgY3JlYXRlVGVzdFBsYW50KHBsYW50RGF0YSkge1xuICAgIGNvbnN0IFtwbGFudF0gPSBhd2FpdCBkYi5pbnNlcnQocGxhbnRzKS52YWx1ZXMocGxhbnREYXRhKS5yZXR1cm5pbmcoKTtcbiAgICB0aGlzLmNyZWF0ZWRQbGFudHMucHVzaChwbGFudC5pZCk7XG4gICAgcmV0dXJuIHBsYW50O1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBhIHRlc3QgcGxhbnQgaW5zdGFuY2UgaW4gdGhlIGRhdGFiYXNlXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBpbnN0YW5jZURhdGEgLSBQbGFudCBpbnN0YW5jZSBkYXRhIHRvIGluc2VydFxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxPYmplY3Q+fSBDcmVhdGVkIHBsYW50IGluc3RhbmNlXG4gICAqL1xuICBhc3luYyBjcmVhdGVUZXN0UGxhbnRJbnN0YW5jZShpbnN0YW5jZURhdGEpIHtcbiAgICBjb25zdCBbaW5zdGFuY2VdID0gYXdhaXQgZGIuaW5zZXJ0KHBsYW50SW5zdGFuY2VzKS52YWx1ZXMoaW5zdGFuY2VEYXRhKS5yZXR1cm5pbmcoKTtcbiAgICB0aGlzLmNyZWF0ZWRQbGFudEluc3RhbmNlcy5wdXNoKGluc3RhbmNlLmlkKTtcbiAgICByZXR1cm4gaW5zdGFuY2U7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGEgdGVzdCBwcm9wYWdhdGlvbiBpbiB0aGUgZGF0YWJhc2VcbiAgICogQHBhcmFtIHtPYmplY3R9IHByb3BhZ2F0aW9uRGF0YSAtIFByb3BhZ2F0aW9uIGRhdGEgdG8gaW5zZXJ0XG4gICAqIEByZXR1cm5zIHtQcm9taXNlPE9iamVjdD59IENyZWF0ZWQgcHJvcGFnYXRpb25cbiAgICovXG4gIGFzeW5jIGNyZWF0ZVRlc3RQcm9wYWdhdGlvbihwcm9wYWdhdGlvbkRhdGEpIHtcbiAgICBjb25zdCBbcHJvcGFnYXRpb25dID0gYXdhaXQgZGIuaW5zZXJ0KHByb3BhZ2F0aW9ucykudmFsdWVzKHByb3BhZ2F0aW9uRGF0YSkucmV0dXJuaW5nKCk7XG4gICAgdGhpcy5jcmVhdGVkUHJvcGFnYXRpb25zLnB1c2gocHJvcGFnYXRpb24uaWQpO1xuICAgIHJldHVybiBwcm9wYWdhdGlvbjtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSB0ZXN0IGNhcmUgaGlzdG9yeSByZWNvcmQgaW4gdGhlIGRhdGFiYXNlXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBjYXJlRGF0YSAtIENhcmUgaGlzdG9yeSBkYXRhIHRvIGluc2VydFxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxPYmplY3Q+fSBDcmVhdGVkIGNhcmUgaGlzdG9yeSByZWNvcmRcbiAgICovXG4gIGFzeW5jIGNyZWF0ZVRlc3RDYXJlSGlzdG9yeShjYXJlRGF0YSkge1xuICAgIGNvbnN0IFtjYXJlXSA9IGF3YWl0IGRiLmluc2VydChjYXJlSGlzdG9yeSkudmFsdWVzKGNhcmVEYXRhKS5yZXR1cm5pbmcoKTtcbiAgICB0aGlzLmNyZWF0ZWRDYXJlSGlzdG9yeS5wdXNoKGNhcmUuaWQpO1xuICAgIHJldHVybiBjYXJlO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhIHVzZXIgYnkgSUQgZnJvbSB0aGUgZGF0YWJhc2VcbiAgICogQHBhcmFtIHtudW1iZXJ9IHVzZXJJZCAtIFVzZXIgSUQgdG8gcmV0cmlldmVcbiAgICogQHJldHVybnMge1Byb21pc2U8T2JqZWN0fG51bGw+fSBVc2VyIG9yIG51bGwgaWYgbm90IGZvdW5kXG4gICAqL1xuICBhc3luYyBnZXRVc2VyQnlJZCh1c2VySWQpIHtcbiAgICBjb25zdCBbdXNlcl0gPSBhd2FpdCBkYi5zZWxlY3QoKS5mcm9tKHVzZXJzKS53aGVyZShlcSh1c2Vycy5pZCwgdXNlcklkKSk7XG4gICAgcmV0dXJuIHVzZXIgfHwgbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYSB1c2VyIGJ5IGVtYWlsIGZyb20gdGhlIGRhdGFiYXNlXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBlbWFpbCAtIEVtYWlsIHRvIHNlYXJjaCBmb3JcbiAgICogQHJldHVybnMge1Byb21pc2U8T2JqZWN0fG51bGw+fSBVc2VyIG9yIG51bGwgaWYgbm90IGZvdW5kXG4gICAqL1xuICBhc3luYyBnZXRVc2VyQnlFbWFpbChlbWFpbCkge1xuICAgIGNvbnN0IFt1c2VyXSA9IGF3YWl0IGRiLnNlbGVjdCgpLmZyb20odXNlcnMpLndoZXJlKGVxKHVzZXJzLmVtYWlsLCBlbWFpbC50b0xvd2VyQ2FzZSgpKSk7XG4gICAgcmV0dXJuIHVzZXIgfHwgbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYSBzZXNzaW9uIGJ5IElEIGZyb20gdGhlIGRhdGFiYXNlXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzZXNzaW9uSWQgLSBTZXNzaW9uIElEIHRvIHJldHJpZXZlXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPE9iamVjdHxudWxsPn0gU2Vzc2lvbiBvciBudWxsIGlmIG5vdCBmb3VuZFxuICAgKi9cbiAgYXN5bmMgZ2V0U2Vzc2lvbkJ5SWQoc2Vzc2lvbklkKSB7XG4gICAgY29uc3QgW3Nlc3Npb25dID0gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbShzZXNzaW9ucykud2hlcmUoZXEoc2Vzc2lvbnMuaWQsIHNlc3Npb25JZCkpO1xuICAgIHJldHVybiBzZXNzaW9uIHx8IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHNlc3Npb25zIGZvciBhIHVzZXIgZnJvbSB0aGUgZGF0YWJhc2VcbiAgICogQHBhcmFtIHtudW1iZXJ9IHVzZXJJZCAtIFVzZXIgSUQgdG8gZ2V0IHNlc3Npb25zIGZvclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxBcnJheT59IEFycmF5IG9mIHNlc3Npb25zXG4gICAqL1xuICBhc3luYyBnZXRTZXNzaW9uc0J5VXNlcklkKHVzZXJJZCkge1xuICAgIHJldHVybiBhd2FpdCBkYi5zZWxlY3QoKS5mcm9tKHNlc3Npb25zKS53aGVyZShlcShzZXNzaW9ucy51c2VySWQsIHVzZXJJZCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBlbWFpbCB2ZXJpZmljYXRpb24gY29kZXMgZm9yIGEgdXNlclxuICAgKiBAcGFyYW0ge251bWJlcn0gdXNlcklkIC0gVXNlciBJRCB0byBnZXQgY29kZXMgZm9yXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPEFycmF5Pn0gQXJyYXkgb2YgZW1haWwgdmVyaWZpY2F0aW9uIGNvZGVzXG4gICAqL1xuICBhc3luYyBnZXRFbWFpbENvZGVzQnlVc2VySWQodXNlcklkKSB7XG4gICAgcmV0dXJuIGF3YWl0IGRiLnNlbGVjdCgpLmZyb20oZW1haWxWZXJpZmljYXRpb25Db2Rlcykud2hlcmUoZXEoZW1haWxWZXJpZmljYXRpb25Db2Rlcy51c2VySWQsIHVzZXJJZCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBhIHVzZXIgaW4gdGhlIGRhdGFiYXNlXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB1c2VySWQgLSBVc2VyIElEIHRvIHVwZGF0ZVxuICAgKiBAcGFyYW0ge09iamVjdH0gdXBkYXRlcyAtIFVwZGF0ZXMgdG8gYXBwbHlcbiAgICogQHJldHVybnMge1Byb21pc2U8T2JqZWN0Pn0gVXBkYXRlZCB1c2VyXG4gICAqL1xuICBhc3luYyB1cGRhdGVVc2VyKHVzZXJJZCwgdXBkYXRlcykge1xuICAgIGNvbnN0IFt1c2VyXSA9IGF3YWl0IGRiLnVwZGF0ZSh1c2VycylcbiAgICAgIC5zZXQoeyAuLi51cGRhdGVzLCB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkgfSlcbiAgICAgIC53aGVyZShlcSh1c2Vycy5pZCwgdXNlcklkKSlcbiAgICAgIC5yZXR1cm5pbmcoKTtcbiAgICByZXR1cm4gdXNlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxldGUgYSB1c2VyIGZyb20gdGhlIGRhdGFiYXNlXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB1c2VySWQgLSBVc2VyIElEIHRvIGRlbGV0ZVxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn1cbiAgICovXG4gIGFzeW5jIGRlbGV0ZVVzZXIodXNlcklkKSB7XG4gICAgYXdhaXQgZGIuZGVsZXRlKHVzZXJzKS53aGVyZShlcSh1c2Vycy5pZCwgdXNlcklkKSk7XG4gICAgLy8gUmVtb3ZlIGZyb20gdHJhY2tpbmdcbiAgICB0aGlzLmNyZWF0ZWRVc2VycyA9IHRoaXMuY3JlYXRlZFVzZXJzLmZpbHRlcihpZCA9PiBpZCAhPT0gdXNlcklkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxldGUgYSBzZXNzaW9uIGZyb20gdGhlIGRhdGFiYXNlXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzZXNzaW9uSWQgLSBTZXNzaW9uIElEIHRvIGRlbGV0ZVxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn1cbiAgICovXG4gIGFzeW5jIGRlbGV0ZVNlc3Npb24oc2Vzc2lvbklkKSB7XG4gICAgYXdhaXQgZGIuZGVsZXRlKHNlc3Npb25zKS53aGVyZShlcShzZXNzaW9ucy5pZCwgc2Vzc2lvbklkKSk7XG4gICAgLy8gUmVtb3ZlIGZyb20gdHJhY2tpbmdcbiAgICB0aGlzLmNyZWF0ZWRTZXNzaW9ucyA9IHRoaXMuY3JlYXRlZFNlc3Npb25zLmZpbHRlcihpZCA9PiBpZCAhPT0gc2Vzc2lvbklkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxldGUgYW4gZW1haWwgdmVyaWZpY2F0aW9uIGNvZGUgZnJvbSB0aGUgZGF0YWJhc2VcbiAgICogQHBhcmFtIHtudW1iZXJ9IGNvZGVJZCAtIENvZGUgSUQgdG8gZGVsZXRlXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fVxuICAgKi9cbiAgYXN5bmMgZGVsZXRlRW1haWxDb2RlKGNvZGVJZCkge1xuICAgIGF3YWl0IGRiLmRlbGV0ZShlbWFpbFZlcmlmaWNhdGlvbkNvZGVzKS53aGVyZShlcShlbWFpbFZlcmlmaWNhdGlvbkNvZGVzLmlkLCBjb2RlSWQpKTtcbiAgICAvLyBSZW1vdmUgZnJvbSB0cmFja2luZ1xuICAgIHRoaXMuY3JlYXRlZEVtYWlsQ29kZXMgPSB0aGlzLmNyZWF0ZWRFbWFpbENvZGVzLmZpbHRlcihpZCA9PiBpZCAhPT0gY29kZUlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbiB1cCBhbGwgdGVzdCBkYXRhIGNyZWF0ZWQgYnkgdGhpcyBtYW5hZ2VyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fVxuICAgKi9cbiAgYXN5bmMgY2xlYW51cCgpIHtcbiAgICB0cnkge1xuICAgICAgLy8gQ2xlYW4gdXAgaW4gcmV2ZXJzZSBvcmRlciBvZiBkZXBlbmRlbmNpZXMgdG8gcmVzcGVjdCBmb3JlaWduIGtleSBjb25zdHJhaW50c1xuICAgICAgXG4gICAgICAvLyAxLiBDYXJlIGhpc3RvcnkgKHJlZmVyZW5jZXMgcGxhbnQgaW5zdGFuY2VzIGFuZCB1c2VycylcbiAgICAgIGZvciAoY29uc3QgY2FyZUlkIG9mIHRoaXMuY3JlYXRlZENhcmVIaXN0b3J5KSB7XG4gICAgICAgIGF3YWl0IGRiLmRlbGV0ZShjYXJlSGlzdG9yeSkud2hlcmUoZXEoY2FyZUhpc3RvcnkuaWQsIGNhcmVJZCkpO1xuICAgICAgfVxuXG4gICAgICAvLyAyLiBQcm9wYWdhdGlvbnMgKHJlZmVyZW5jZXMgcGxhbnQgaW5zdGFuY2VzLCBwbGFudHMsIGFuZCB1c2VycylcbiAgICAgIGZvciAoY29uc3QgcHJvcGFnYXRpb25JZCBvZiB0aGlzLmNyZWF0ZWRQcm9wYWdhdGlvbnMpIHtcbiAgICAgICAgYXdhaXQgZGIuZGVsZXRlKHByb3BhZ2F0aW9ucykud2hlcmUoZXEocHJvcGFnYXRpb25zLmlkLCBwcm9wYWdhdGlvbklkKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIDMuIFBsYW50IGluc3RhbmNlcyAocmVmZXJlbmNlcyBwbGFudHMgYW5kIHVzZXJzKVxuICAgICAgZm9yIChjb25zdCBpbnN0YW5jZUlkIG9mIHRoaXMuY3JlYXRlZFBsYW50SW5zdGFuY2VzKSB7XG4gICAgICAgIGF3YWl0IGRiLmRlbGV0ZShwbGFudEluc3RhbmNlcykud2hlcmUoZXEocGxhbnRJbnN0YW5jZXMuaWQsIGluc3RhbmNlSWQpKTtcbiAgICAgIH1cblxuICAgICAgLy8gNC4gUGxhbnRzIChyZWZlcmVuY2VzIHVzZXJzKVxuICAgICAgZm9yIChjb25zdCBwbGFudElkIG9mIHRoaXMuY3JlYXRlZFBsYW50cykge1xuICAgICAgICBhd2FpdCBkYi5kZWxldGUocGxhbnRzKS53aGVyZShlcShwbGFudHMuaWQsIHBsYW50SWQpKTtcbiAgICAgIH1cblxuICAgICAgLy8gNS4gRW1haWwgdmVyaWZpY2F0aW9uIGNvZGVzIChyZWZlcmVuY2VzIHVzZXJzKVxuICAgICAgZm9yIChjb25zdCBjb2RlSWQgb2YgdGhpcy5jcmVhdGVkRW1haWxDb2Rlcykge1xuICAgICAgICBhd2FpdCBkYi5kZWxldGUoZW1haWxWZXJpZmljYXRpb25Db2Rlcykud2hlcmUoZXEoZW1haWxWZXJpZmljYXRpb25Db2Rlcy5pZCwgY29kZUlkKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIDYuIFNlc3Npb25zIChyZWZlcmVuY2VzIHVzZXJzKVxuICAgICAgZm9yIChjb25zdCBzZXNzaW9uSWQgb2YgdGhpcy5jcmVhdGVkU2Vzc2lvbnMpIHtcbiAgICAgICAgYXdhaXQgZGIuZGVsZXRlKHNlc3Npb25zKS53aGVyZShlcShzZXNzaW9ucy5pZCwgc2Vzc2lvbklkKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIDcuIFVzZXJzIChubyBkZXBlbmRlbmNpZXMpXG4gICAgICBmb3IgKGNvbnN0IHVzZXJJZCBvZiB0aGlzLmNyZWF0ZWRVc2Vycykge1xuICAgICAgICBhd2FpdCBkYi5kZWxldGUodXNlcnMpLndoZXJlKGVxKHVzZXJzLmlkLCB1c2VySWQpKTtcbiAgICAgIH1cblxuICAgICAgLy8gUmVzZXQgdHJhY2tpbmcgYXJyYXlzXG4gICAgICB0aGlzLmNyZWF0ZWRVc2VycyA9IFtdO1xuICAgICAgdGhpcy5jcmVhdGVkU2Vzc2lvbnMgPSBbXTtcbiAgICAgIHRoaXMuY3JlYXRlZEVtYWlsQ29kZXMgPSBbXTtcbiAgICAgIHRoaXMuY3JlYXRlZFBsYW50cyA9IFtdO1xuICAgICAgdGhpcy5jcmVhdGVkUGxhbnRJbnN0YW5jZXMgPSBbXTtcbiAgICAgIHRoaXMuY3JlYXRlZFByb3BhZ2F0aW9ucyA9IFtdO1xuICAgICAgdGhpcy5jcmVhdGVkQ2FyZUhpc3RvcnkgPSBbXTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgY2xlYW51cCBlcnJvcjonLCBlcnJvcik7XG4gICAgICAvLyBSZXNldCB0cmFja2luZyBhcnJheXMgZXZlbiBpZiBjbGVhbnVwIGZhaWxzXG4gICAgICB0aGlzLmNyZWF0ZWRVc2VycyA9IFtdO1xuICAgICAgdGhpcy5jcmVhdGVkU2Vzc2lvbnMgPSBbXTtcbiAgICAgIHRoaXMuY3JlYXRlZEVtYWlsQ29kZXMgPSBbXTtcbiAgICAgIHRoaXMuY3JlYXRlZFBsYW50cyA9IFtdO1xuICAgICAgdGhpcy5jcmVhdGVkUGxhbnRJbnN0YW5jZXMgPSBbXTtcbiAgICAgIHRoaXMuY3JlYXRlZFByb3BhZ2F0aW9ucyA9IFtdO1xuICAgICAgdGhpcy5jcmVhdGVkQ2FyZUhpc3RvcnkgPSBbXTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgdGhlIGRhdGFiYXNlIGNvbm5lY3Rpb24gaXMgd29ya2luZ1xuICAgKiBAcmV0dXJucyB7UHJvbWlzZTxib29sZWFuPn0gVHJ1ZSBpZiBjb25uZWN0aW9uIGlzIHdvcmtpbmdcbiAgICovXG4gIGFzeW5jIGlzQ29ubmVjdGVkKCkge1xuICAgIHRyeSB7XG4gICAgICAvLyBTaW1wbGUgcXVlcnkgdG8gdGVzdCBjb25uZWN0aW9uXG4gICAgICBhd2FpdCBkYi5zZWxlY3QoKS5mcm9tKHVzZXJzKS5saW1pdCgxKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIHRlc3QgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBuZXcgZGF0YWJhc2UgdGVzdCBtYW5hZ2VyIGluc3RhbmNlXG4gKiBAcmV0dXJucyB7RGF0YWJhc2VUZXN0TWFuYWdlcn0gTmV3IGRhdGFiYXNlIHRlc3QgbWFuYWdlclxuICovXG5leHBvcnQgY29uc3QgY3JlYXRlRGF0YWJhc2VUZXN0TWFuYWdlciA9ICgpID0+IHtcbiAgcmV0dXJuIG5ldyBEYXRhYmFzZVRlc3RNYW5hZ2VyKCk7XG59O1xuXG4vKipcbiAqIEdsb2JhbCBkYXRhYmFzZSB0ZXN0IG1hbmFnZXIgZm9yIHNoYXJlZCB1c2VcbiAqL1xuZXhwb3J0IGNvbnN0IGdsb2JhbERhdGFiYXNlVGVzdE1hbmFnZXIgPSBuZXcgRGF0YWJhc2VUZXN0TWFuYWdlcigpO1xuXG5leHBvcnQgZGVmYXVsdCBEYXRhYmFzZVRlc3RNYW5hZ2VyOyJdLCJuYW1lcyI6WyJjcmVhdGVEYXRhYmFzZVRlc3RNYW5hZ2VyIiwiZ2xvYmFsRGF0YWJhc2VUZXN0TWFuYWdlciIsIkRhdGFiYXNlVGVzdE1hbmFnZXIiLCJjcmVhdGVkVXNlcnMiLCJjcmVhdGVkU2Vzc2lvbnMiLCJjcmVhdGVkRW1haWxDb2RlcyIsImNyZWF0ZWRQbGFudHMiLCJjcmVhdGVkUGxhbnRJbnN0YW5jZXMiLCJjcmVhdGVkUHJvcGFnYXRpb25zIiwiY3JlYXRlZENhcmVIaXN0b3J5IiwiY3JlYXRlVGVzdFVzZXIiLCJ1c2VyRGF0YSIsInVzZXIiLCJkYiIsImluc2VydCIsInVzZXJzIiwidmFsdWVzIiwicmV0dXJuaW5nIiwicHVzaCIsImlkIiwiY3JlYXRlVGVzdFNlc3Npb24iLCJzZXNzaW9uRGF0YSIsInNlc3Npb24iLCJzZXNzaW9ucyIsImNyZWF0ZVRlc3RFbWFpbENvZGUiLCJjb2RlRGF0YSIsImNvZGUiLCJlbWFpbFZlcmlmaWNhdGlvbkNvZGVzIiwiY3JlYXRlVGVzdFBsYW50IiwicGxhbnREYXRhIiwicGxhbnQiLCJwbGFudHMiLCJjcmVhdGVUZXN0UGxhbnRJbnN0YW5jZSIsImluc3RhbmNlRGF0YSIsImluc3RhbmNlIiwicGxhbnRJbnN0YW5jZXMiLCJjcmVhdGVUZXN0UHJvcGFnYXRpb24iLCJwcm9wYWdhdGlvbkRhdGEiLCJwcm9wYWdhdGlvbiIsInByb3BhZ2F0aW9ucyIsImNyZWF0ZVRlc3RDYXJlSGlzdG9yeSIsImNhcmVEYXRhIiwiY2FyZSIsImNhcmVIaXN0b3J5IiwiZ2V0VXNlckJ5SWQiLCJ1c2VySWQiLCJzZWxlY3QiLCJmcm9tIiwid2hlcmUiLCJlcSIsImdldFVzZXJCeUVtYWlsIiwiZW1haWwiLCJ0b0xvd2VyQ2FzZSIsImdldFNlc3Npb25CeUlkIiwic2Vzc2lvbklkIiwiZ2V0U2Vzc2lvbnNCeVVzZXJJZCIsImdldEVtYWlsQ29kZXNCeVVzZXJJZCIsInVwZGF0ZVVzZXIiLCJ1cGRhdGVzIiwidXBkYXRlIiwic2V0IiwidXBkYXRlZEF0IiwiRGF0ZSIsImRlbGV0ZVVzZXIiLCJkZWxldGUiLCJmaWx0ZXIiLCJkZWxldGVTZXNzaW9uIiwiZGVsZXRlRW1haWxDb2RlIiwiY29kZUlkIiwiY2xlYW51cCIsImNhcmVJZCIsInByb3BhZ2F0aW9uSWQiLCJpbnN0YW5jZUlkIiwicGxhbnRJZCIsImVycm9yIiwiY29uc29sZSIsImlzQ29ubmVjdGVkIiwibGltaXQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O1FBcVJhQTtlQUFBQTs7UUFTYjtlQUFBOztRQUZhQztlQUFBQTs7O1FBNVJOO29CQUVZO3dCQUN3Rjs0QkFDeEY7QUFFbkI7OztDQUdDLEdBQ0QsTUFBTUM7SUFDSixhQUFjO1FBQ1osSUFBSSxDQUFDQyxZQUFZLEdBQUcsRUFBRTtRQUN0QixJQUFJ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