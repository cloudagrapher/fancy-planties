{"version":3,"sources":["/Users/stefanbekker/projects/fancy-planties/src/__tests__/integration/email-verification-error-scenarios.test.ts"],"sourcesContent":["/**\n * Email Verification Error Scenario Tests\n * Tests email service failure handling, retry logic, expired code scenarios, \n * cleanup processes, and concurrent verification attempts\n * Requirements: 1.4, 3.1, 7.3, 7.4\n */\n\nimport { createDatabaseTestManager } from '@/test-utils/setup/database-test-manager';\nimport { emailVerificationCodeService } from '@/lib/services/email-verification-code-service';\nimport { createEmailService } from '@/lib/services/resend-email-service';\nimport { EmailServiceError } from '@/lib/services/email-service';\n\n// Mock email service and related modules\njest.mock('@/lib/services/resend-email-service');\njest.mock('@/lib/services/email-service');\n\nconst mockEmailService = {\n  sendVerificationEmail: jest.fn(),\n};\n\nconst mockCreateEmailService = createEmailService as jest.MockedFunction<typeof createEmailService>;\nconst mockSendEmailWithRetry = require('@/lib/services/email-service').sendEmailWithRetry as jest.MockedFunction<any>;\n\n// Mock environment variables\nconst originalEnv = process.env;\n\nbeforeAll(() => {\n  process.env = {\n    ...originalEnv,\n    RESEND_API_KEY: 'test-api-key',\n    FROM_EMAIL: 'test@example.com',\n    FROM_NAME: 'Test App',\n    VERIFICATION_CODE_EXPIRY_MINUTES: '10',\n    MAX_VERIFICATION_ATTEMPTS: '5',\n    RESEND_COOLDOWN_SECONDS: '60',\n    MAX_RESEND_PER_HOUR: '5',\n    NODE_ENV: 'test',\n  };\n});\n\nafterAll(() => {\n  process.env = originalEnv;\n});\n\ndescribe('Email Verification Error Scenario Tests', () => {\n  let dbManager: any;\n\n  beforeEach(async () => {\n    jest.clearAllMocks();\n    dbManager = createDatabaseTestManager();\n    \n    // Default to successful email service\n    mockCreateEmailService.mockReturnValue(mockEmailService);\n    mockSendEmailWithRetry.mockResolvedValue(true);\n    mockEmailService.sendVerificationEmail.mockResolvedValue(true);\n  });\n\n  afterEach(async () => {\n    await dbManager.cleanup();\n  });\n\n  describe('Email Service Failure Handling and Retry Logic', () => {\n    it('should handle quota exceeded error with appropriate response', async () => {\n      // Mock quota exceeded error\n      const quotaError = new EmailServiceError('Quota exceeded', 'QUOTA_EXCEEDED');\n      mockSendEmailWithRetry.mockRejectedValue(quotaError);\n\n      const signupRequest = new NextRequest('http://localhost/api/auth/signup', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n          password: 'SecurePass123!',\n          name: 'Test User',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const signupResponse = await signupHandler(signupRequest);\n      const signupData = await signupResponse.json();\n\n      // Assert user is created but email error is reported\n      expect(signupResponse.status).toBe(200);\n      expect(signupData.success).toBe(true);\n      expect(signupData.requiresVerification).toBe(true);\n      expect(signupData.emailError).toContain('Email service quota exceeded');\n\n      // Verify user was created in database\n      const user = await dbManager.getUserByEmail('test@example.com');\n      expect(user).toBeTruthy();\n      expect(user.isEmailVerified).toBe(false);\n\n      // Verify verification code was still generated\n      const emailCodes = await dbManager.getEmailCodesByUserId(user.id);\n      expect(emailCodes).toHaveLength(1);\n    });\n\n    it('should handle API error with retry logic', async () => {\n      // Mock API error that should trigger retry\n      const apiError = new EmailServiceError('API error', 'API_ERROR');\n      mockSendEmailWithRetry.mockRejectedValue(apiError);\n\n      const user = await dbManager.createTestUser({\n        email: 'test@example.com',\n        name: 'Test User',\n        passwordHash: 'hashed_password',\n        isEmailVerified: false,\n      });\n\n      const resendRequest = new NextRequest('http://localhost/api/auth/resend-verification', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const resendResponse = await resendVerificationHandler(resendRequest);\n      const resendData = await resendResponse.json();\n\n      // Assert appropriate error response\n      expect(resendResponse.status).toBe(500);\n      expect(resendData.error).toContain('Email service error');\n\n      // Verify retry logic was attempted (sendEmailWithRetry should handle retries internally)\n      expect(mockSendEmailWithRetry).toHaveBeenCalledTimes(1);\n    });\n\n    it('should handle network error with appropriate user message', async () => {\n      // Mock network error\n      const networkError = new EmailServiceError('Network timeout', 'NETWORK_ERROR');\n      mockSendEmailWithRetry.mockRejectedValue(networkError);\n\n      const user = await dbManager.createTestUser({\n        email: 'test@example.com',\n        name: 'Test User',\n        passwordHash: 'hashed_password',\n        isEmailVerified: false,\n      });\n\n      const resendRequest = new NextRequest('http://localhost/api/auth/resend-verification', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const resendResponse = await resendVerificationHandler(resendRequest);\n      const resendData = await resendResponse.json();\n\n      // Assert network error response\n      expect(resendResponse.status).toBe(500);\n      expect(resendData.error).toContain('Network error');\n      expect(resendData.error).toContain('check your connection');\n    });\n\n    it('should handle invalid email error from service', async () => {\n      // Mock invalid email error\n      const invalidEmailError = new EmailServiceError('Invalid email', 'INVALID_EMAIL');\n      mockSendEmailWithRetry.mockRejectedValue(invalidEmailError);\n\n      const user = await dbManager.createTestUser({\n        email: 'test@example.com',\n        name: 'Test User',\n        passwordHash: 'hashed_password',\n        isEmailVerified: false,\n      });\n\n      const resendRequest = new NextRequest('http://localhost/api/auth/resend-verification', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const resendResponse = await resendVerificationHandler(resendRequest);\n      const resendData = await resendResponse.json();\n\n      // Assert invalid email error response\n      expect(resendResponse.status).toBe(400);\n      expect(resendData.error).toContain('Invalid email address');\n    });\n\n    it('should handle unknown email service errors gracefully', async () => {\n      // Mock unknown error (not EmailServiceError)\n      mockSendEmailWithRetry.mockRejectedValue(new Error('Unknown error'));\n\n      const signupRequest = new NextRequest('http://localhost/api/auth/signup', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n          password: 'SecurePass123!',\n          name: 'Test User',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const signupResponse = await signupHandler(signupRequest);\n      const signupData = await signupResponse.json();\n\n      // Assert graceful handling of unknown error\n      expect(signupResponse.status).toBe(200);\n      expect(signupData.success).toBe(true);\n      expect(signupData.emailError).toContain('Failed to send verification email');\n      expect(signupData.emailError).toContain('try resending');\n    });\n\n    it('should handle service unavailable scenario during resend', async () => {\n      // Mock quota exceeded error during resend\n      const quotaError = new EmailServiceError('Service quota exceeded', 'QUOTA_EXCEEDED');\n      mockSendEmailWithRetry.mockRejectedValue(quotaError);\n\n      const user = await dbManager.createTestUser({\n        email: 'test@example.com',\n        name: 'Test User',\n        passwordHash: 'hashed_password',\n        isEmailVerified: false,\n      });\n\n      const resendRequest = new NextRequest('http://localhost/api/auth/resend-verification', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const resendResponse = await resendVerificationHandler(resendRequest);\n      const resendData = await resendResponse.json();\n\n      // Assert service unavailable response\n      expect(resendResponse.status).toBe(503);\n      expect(resendData.error).toContain('Email service quota exceeded');\n      expect(resendData.error).toContain('try again later');\n    });\n  });\n\n  describe('Expired Code Scenarios and Cleanup Processes', () => {\n    it('should handle expired verification codes properly', async () => {\n      // Create user with expired verification code\n      const user = await dbManager.createTestUser({\n        email: 'test@example.com',\n        name: 'Test User',\n        passwordHash: 'hashed_password',\n        isEmailVerified: false,\n      });\n\n      const expiredCode = await dbManager.createTestEmailCode({\n        userId: user.id,\n        code: '123456',\n        expiresAt: new Date(Date.now() - 60000), // Expired 1 minute ago\n        attemptsUsed: 0,\n      });\n\n      // Try to verify with expired code\n      const verifyRequest = new NextRequest('http://localhost/api/auth/verify-email', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n          code: '123456',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const verifyResponse = await verifyEmailHandler(verifyRequest);\n      const verifyData = await verifyResponse.json();\n\n      // Assert expired code error\n      expect(verifyResponse.status).toBe(400);\n      expect(verifyData.error).toContain('Verification code has expired');\n      expect(verifyData.error).toContain('request a new one');\n\n      // Verify user is still not verified\n      const unverifiedUser = await dbManager.getUserById(user.id);\n      expect(unverifiedUser.isEmailVerified).toBe(false);\n    });\n\n    it('should clean up expired codes during verification service operations', async () => {\n      // Create user with multiple codes, some expired\n      const user = await dbManager.createTestUser({\n        email: 'test@example.com',\n        name: 'Test User',\n        passwordHash: 'hashed_password',\n        isEmailVerified: false,\n      });\n\n      // Create expired code\n      await dbManager.createTestEmailCode({\n        userId: user.id,\n        code: '111111',\n        expiresAt: new Date(Date.now() - 60000), // Expired\n        attemptsUsed: 0,\n      });\n\n      // Create valid code\n      await dbManager.createTestEmailCode({\n        userId: user.id,\n        code: '222222',\n        expiresAt: new Date(Date.now() + 600000), // Valid for 10 minutes\n        attemptsUsed: 0,\n      });\n\n      // Trigger cleanup by calling the service method\n      await emailVerificationCodeService.cleanupExpiredCodes();\n\n      // Verify expired code was cleaned up\n      const remainingCodes = await dbManager.getEmailCodesByUserId(user.id);\n      expect(remainingCodes).toHaveLength(1);\n      expect(remainingCodes[0].code).toBe('222222');\n    });\n\n    it('should handle cleanup when user is deleted', async () => {\n      // Create user with verification codes\n      const user = await dbManager.createTestUser({\n        email: 'test@example.com',\n        name: 'Test User',\n        passwordHash: 'hashed_password',\n        isEmailVerified: false,\n      });\n\n      await dbManager.createTestEmailCode({\n        userId: user.id,\n        code: '123456',\n        expiresAt: new Date(Date.now() + 600000),\n        attemptsUsed: 0,\n      });\n\n      // Verify code exists\n      let emailCodes = await dbManager.getEmailCodesByUserId(user.id);\n      expect(emailCodes).toHaveLength(1);\n\n      // Delete user (should cascade delete codes due to foreign key constraint)\n      await dbManager.deleteUser(user.id);\n\n      // Verify codes were cleaned up\n      emailCodes = await dbManager.getEmailCodesByUserId(user.id);\n      expect(emailCodes).toHaveLength(0);\n    });\n\n    it('should handle multiple expired codes for same user', async () => {\n      // Create user with multiple expired codes\n      const user = await dbManager.createTestUser({\n        email: 'test@example.com',\n        name: 'Test User',\n        passwordHash: 'hashed_password',\n        isEmailVerified: false,\n      });\n\n      // Create multiple expired codes\n      await dbManager.createTestEmailCode({\n        userId: user.id,\n        code: '111111',\n        expiresAt: new Date(Date.now() - 120000), // Expired 2 minutes ago\n        attemptsUsed: 0,\n      });\n\n      await dbManager.createTestEmailCode({\n        userId: user.id,\n        code: '222222',\n        expiresAt: new Date(Date.now() - 60000), // Expired 1 minute ago\n        attemptsUsed: 0,\n      });\n\n      // Try to verify with one of the expired codes\n      const verifyRequest = new NextRequest('http://localhost/api/auth/verify-email', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n          code: '111111',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const verifyResponse = await verifyEmailHandler(verifyRequest);\n      const verifyData = await verifyResponse.json();\n\n      // Assert expired code error\n      expect(verifyResponse.status).toBe(400);\n      expect(verifyData.error).toContain('Verification code has expired');\n\n      // Cleanup expired codes\n      await emailVerificationCodeService.cleanupExpiredCodes();\n\n      // Verify all expired codes were cleaned up\n      const remainingCodes = await dbManager.getEmailCodesByUserId(user.id);\n      expect(remainingCodes).toHaveLength(0);\n    });\n  });\n\n  describe('Concurrent Verification Attempts and Race Conditions', () => {\n    it('should handle concurrent verification attempts safely', async () => {\n      // Create user with verification code\n      const user = await dbManager.createTestUser({\n        email: 'test@example.com',\n        name: 'Test User',\n        passwordHash: 'hashed_password',\n        isEmailVerified: false,\n      });\n\n      await dbManager.createTestEmailCode({\n        userId: user.id,\n        code: '123456',\n        expiresAt: new Date(Date.now() + 600000),\n        attemptsUsed: 0,\n      });\n\n      // Create multiple concurrent verification requests\n      const verifyRequest1 = new NextRequest('http://localhost/api/auth/verify-email', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n          code: '123456',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const verifyRequest2 = new NextRequest('http://localhost/api/auth/verify-email', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n          code: '123456',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      // Execute concurrent requests\n      const [response1, response2] = await Promise.all([\n        verifyEmailHandler(verifyRequest1),\n        verifyEmailHandler(verifyRequest2),\n      ]);\n\n      const data1 = await response1.json();\n      const data2 = await response2.json();\n\n      // One should succeed, one should fail (code already used)\n      const responses = [\n        { status: response1.status, data: data1 },\n        { status: response2.status, data: data2 },\n      ];\n\n      const successResponses = responses.filter(r => r.status === 200);\n      const failureResponses = responses.filter(r => r.status !== 200);\n\n      expect(successResponses).toHaveLength(1);\n      expect(failureResponses).toHaveLength(1);\n\n      // Verify user is verified only once\n      const verifiedUser = await dbManager.getUserById(user.id);\n      expect(verifiedUser.isEmailVerified).toBe(true);\n\n      // Verify code was deleted\n      const remainingCodes = await dbManager.getEmailCodesByUserId(user.id);\n      expect(remainingCodes).toHaveLength(0);\n    });\n\n    it('should handle concurrent resend requests safely', async () => {\n      // Create user\n      const user = await dbManager.createTestUser({\n        email: 'test@example.com',\n        name: 'Test User',\n        passwordHash: 'hashed_password',\n        isEmailVerified: false,\n      });\n\n      // Create multiple concurrent resend requests\n      const resendRequest1 = new NextRequest('http://localhost/api/auth/resend-verification', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const resendRequest2 = new NextRequest('http://localhost/api/auth/resend-verification', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      // Execute concurrent requests\n      const [response1, response2] = await Promise.all([\n        resendVerificationHandler(resendRequest1),\n        resendVerificationHandler(resendRequest2),\n      ]);\n\n      // Both should succeed (rate limiting is handled by middleware)\n      expect(response1.status).toBe(200);\n      expect(response2.status).toBe(200);\n\n      // Verify only one code exists (latest one)\n      const emailCodes = await dbManager.getEmailCodesByUserId(user.id);\n      expect(emailCodes).toHaveLength(1);\n\n      // Verify email service was called (possibly multiple times due to concurrency)\n      expect(mockSendEmailWithRetry).toHaveBeenCalled();\n    });\n\n    it('should handle race condition between verification and code expiration', async () => {\n      // Create user with code that expires very soon\n      const user = await dbManager.createTestUser({\n        email: 'test@example.com',\n        name: 'Test User',\n        passwordHash: 'hashed_password',\n        isEmailVerified: false,\n      });\n\n      await dbManager.createTestEmailCode({\n        userId: user.id,\n        code: '123456',\n        expiresAt: new Date(Date.now() + 100), // Expires in 100ms\n        attemptsUsed: 0,\n      });\n\n      // Wait for code to expire\n      await new Promise(resolve => setTimeout(resolve, 150));\n\n      // Try to verify with expired code\n      const verifyRequest = new NextRequest('http://localhost/api/auth/verify-email', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n          code: '123456',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const verifyResponse = await verifyEmailHandler(verifyRequest);\n      const verifyData = await verifyResponse.json();\n\n      // Should handle expired code gracefully\n      expect(verifyResponse.status).toBe(400);\n      expect(verifyData.error).toContain('expired');\n\n      // User should remain unverified\n      const unverifiedUser = await dbManager.getUserById(user.id);\n      expect(unverifiedUser.isEmailVerified).toBe(false);\n    });\n\n    it('should handle concurrent signup attempts with same email', async () => {\n      // Create concurrent signup requests with same email\n      const signupRequest1 = new NextRequest('http://localhost/api/auth/signup', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n          password: 'SecurePass123!',\n          name: 'Test User 1',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const signupRequest2 = new NextRequest('http://localhost/api/auth/signup', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n          password: 'AnotherPass123!',\n          name: 'Test User 2',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      // Execute concurrent requests\n      const [response1, response2] = await Promise.all([\n        signupHandler(signupRequest1),\n        signupHandler(signupRequest2),\n      ]);\n\n      const data1 = await response1.json();\n      const data2 = await response2.json();\n\n      // One should succeed, one should fail with duplicate email error\n      const responses = [\n        { status: response1.status, data: data1 },\n        { status: response2.status, data: data2 },\n      ];\n\n      const successResponses = responses.filter(r => r.status === 200);\n      const conflictResponses = responses.filter(r => r.status === 409);\n\n      expect(successResponses).toHaveLength(1);\n      expect(conflictResponses).toHaveLength(1);\n\n      // Verify only one user was created\n      const user = await dbManager.getUserByEmail('test@example.com');\n      expect(user).toBeTruthy();\n\n      // Verify only one set of verification codes exists\n      const emailCodes = await dbManager.getEmailCodesByUserId(user.id);\n      expect(emailCodes).toHaveLength(1);\n    });\n  });\n\n  describe('Database Error Scenarios', () => {\n    it('should handle database connection failures gracefully', async () => {\n      // Mock database connection failure\n      const originalDb = require('@/lib/db').db;\n      \n      // Mock database to throw connection error\n      jest.doMock('@/lib/db', () => ({\n        db: {\n          select: jest.fn().mockRejectedValue(new Error('Database connection failed')),\n          insert: jest.fn().mockRejectedValue(new Error('Database connection failed')),\n          update: jest.fn().mockRejectedValue(new Error('Database connection failed')),\n          delete: jest.fn().mockRejectedValue(new Error('Database connection failed')),\n        },\n      }));\n\n      const verifyRequest = new NextRequest('http://localhost/api/auth/verify-email', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n          code: '123456',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const verifyResponse = await verifyEmailHandler(verifyRequest);\n      const verifyData = await verifyResponse.json();\n\n      // Should handle database error gracefully\n      expect(verifyResponse.status).toBe(500);\n      expect(verifyData.error).toBe('Internal server error');\n\n      // Restore original database\n      jest.doMock('@/lib/db', () => ({ db: originalDb }));\n    });\n\n    it('should handle transaction rollback scenarios', async () => {\n      // This test would require more complex database transaction mocking\n      // For now, we'll test that the service handles errors during code validation\n      \n      const user = await dbManager.createTestUser({\n        email: 'test@example.com',\n        name: 'Test User',\n        passwordHash: 'hashed_password',\n        isEmailVerified: false,\n      });\n\n      // Create code with maximum attempts reached\n      await dbManager.createTestEmailCode({\n        userId: user.id,\n        code: '123456',\n        expiresAt: new Date(Date.now() + 600000),\n        attemptsUsed: 5, // Maximum attempts reached\n      });\n\n      const verifyRequest = new NextRequest('http://localhost/api/auth/verify-email', {\n        method: 'POST',\n        body: JSON.stringify({\n          email: 'test@example.com',\n          code: '123456',\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const verifyResponse = await verifyEmailHandler(verifyRequest);\n      const verifyData = await verifyResponse.json();\n\n      // Should handle too many attempts error\n      expect(verifyResponse.status).toBe(429);\n      expect(verifyData.error).toContain('Too many verification attempts');\n\n      // User should remain unverified\n      const unverifiedUser = await dbManager.getUserById(user.id);\n      expect(unverifiedUser.isEmailVerified).toBe(false);\n    });\n  });\n});"],"names":["jest","mock","mockEmailService","sendVerificationEmail","fn","mockCreateEmailService","createEmailService","mockSendEmailWithRetry","require","sendEmailWithRetry","originalEnv","process","env","beforeAll","RESEND_API_KEY","FROM_EMAIL","FROM_NAME","VERIFICATION_CODE_EXPIRY_MINUTES","MAX_VERIFICATION_ATTEMPTS","RESEND_COOLDOWN_SECONDS","MAX_RESEND_PER_HOUR","NODE_ENV","afterAll","describe","dbManager","beforeEach","clearAllMocks","createDatabaseTestManager","mockReturnValue","mockResolvedValue","afterEach","cleanup","it","quotaError","EmailServiceError","mockRejectedValue","signupRequest","NextRequest","method","body","JSON","stringify","email","password","name","headers","signupResponse","signupHandler","signupData","json","expect","status","toBe","success","requiresVerification","emailError","toContain","user","getUserByEmail","toBeTruthy","isEmailVerified","emailCodes","getEmailCodesByUserId","id","toHaveLength","apiError","createTestUser","passwordHash","resendRequest","resendResponse","resendVerificationHandler","resendData","error","toHaveBeenCalledTimes","networkError","invalidEmailError","Error","expiredCode","createTestEmailCode","userId","code","expiresAt","Date","now","attemptsUsed","verifyRequest","verifyResponse","verifyEmailHandler","verifyData","unverifiedUser","getUserById","emailVerificationCodeService","cleanupExpiredCodes","remainingCodes","deleteUser","verifyRequest1","verifyRequest2","response1","response2","Promise","all","data1","data2","responses","data","successResponses","filter","r","failureResponses","verifiedUser","resendRequest1","resendRequest2","toHaveBeenCalled","resolve","setTimeout","signupRequest1","signupRequest2","conflictResponses","originalDb","db","doMock","select","insert","update","delete"],"mappings":"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"}