71e52de51ca16ae9f8a0a238ac41008a
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get EmailServiceMonitor () {
        return EmailServiceMonitor;
    },
    get emailServiceMonitor () {
        return emailServiceMonitor;
    }
});
require("server-only");
class EmailServiceMonitor {
    constructor(){
        this.recentEvents = [];
        this.maxEvents = 1000; // Keep last 1000 events
        this.resetInterval = 24 * 60 * 60 * 1000; // 24 hours
        this.stats = {
            totalSent: 0,
            totalFailed: 0,
            quotaUsed: 0,
            quotaLimit: this.getQuotaLimit(),
            errorsByType: {},
            successRate: 100,
            averageResponseTime: 0,
            lastResetTime: Date.now()
        };
    }
    /**
   * Record a successful email send
   */ recordSuccess(responseTime) {
        this.stats.totalSent++;
        if (this.stats.quotaLimit > 0) {
            this.stats.quotaUsed++;
        }
        const event = {
            type: 'success',
            timestamp: Date.now(),
            responseTime
        };
        this.addEvent(event);
        this.updateStats();
        // Log success in development
        if (process.env.NODE_ENV === 'development') {
            console.log(`[EMAIL_MONITOR] Email sent successfully (${responseTime}ms)`);
        }
    }
    /**
   * Record a failed email send
   */ recordFailure(error, responseTime) {
        this.stats.totalFailed++;
        // Update error counts by type
        this.stats.errorsByType[error.code] = (this.stats.errorsByType[error.code] || 0) + 1;
        // Update last error
        this.stats.lastError = {
            message: error.message,
            code: error.code,
            timestamp: Date.now()
        };
        const event = {
            type: 'error',
            timestamp: Date.now(),
            responseTime,
            error
        };
        this.addEvent(event);
        this.updateStats();
        // Log error
        console.error(`[EMAIL_MONITOR] Email send failed: ${error.code} - ${error.message} (${responseTime}ms)`);
        // Check for quota issues
        if (error.code === 'QUOTA_EXCEEDED') {
            this.handleQuotaExceeded();
        }
    }
    /**
   * Get current statistics
   */ getStats() {
        this.checkForReset();
        return {
            ...this.stats
        };
    }
    /**
   * Get recent events (last N events)
   */ getRecentEvents(limit = 100) {
        return this.recentEvents.slice(-limit);
    }
    /**
   * Get error summary
   */ getErrorSummary() {
        const recentErrors = this.recentEvents.filter((event)=>event.type === 'error').slice(-50);
        const criticalErrors = this.recentEvents.filter((event)=>event.type === 'error' && event.error?.code === 'QUOTA_EXCEEDED').slice(-10);
        return {
            totalErrors: this.stats.totalFailed,
            errorsByType: {
                ...this.stats.errorsByType
            },
            recentErrors,
            criticalErrors
        };
    }
    /**
   * Check if quota is approaching limit
   */ isQuotaNearLimit(threshold = 0.8) {
        if (this.stats.quotaLimit === 0) return false;
        return this.stats.quotaUsed / this.stats.quotaLimit >= threshold;
    }
    /**
   * Get quota usage percentage
   */ getQuotaUsagePercentage() {
        if (this.stats.quotaLimit === 0) return 0;
        return Math.round(this.stats.quotaUsed / this.stats.quotaLimit * 100);
    }
    /**
   * Reset daily statistics (called automatically)
   */ resetDailyStats() {
        console.log('[EMAIL_MONITOR] Resetting daily statistics');
        this.stats.totalSent = 0;
        this.stats.totalFailed = 0;
        this.stats.quotaUsed = 0;
        this.stats.errorsByType = {};
        this.stats.lastResetTime = Date.now();
        // Keep only recent events (last 100)
        this.recentEvents = this.recentEvents.slice(-100);
        this.updateStats();
    }
    /**
   * Force reset statistics (for testing or manual reset)
   */ forceReset() {
        console.log('[EMAIL_MONITOR] Force resetting statistics');
        this.resetDailyStats();
    }
    /**
   * Get health status
   */ getHealthStatus() {
        const issues = [];
        const recommendations = [];
        let status = 'healthy';
        // Check success rate
        if (this.stats.successRate < 95) {
            status = 'warning';
            issues.push(`Low success rate: ${this.stats.successRate.toFixed(1)}%`);
            recommendations.push('Check email service configuration and network connectivity');
        }
        if (this.stats.successRate < 80) {
            status = 'critical';
        }
        // Check quota usage
        if (this.isQuotaNearLimit(0.9)) {
            status = status === 'critical' ? 'critical' : 'warning';
            issues.push(`High quota usage: ${this.getQuotaUsagePercentage()}%`);
            recommendations.push('Consider upgrading email service plan or implementing email throttling');
        }
        if (this.isQuotaNearLimit(0.95)) {
            status = 'critical';
        }
        // Check for recent critical errors
        const recentCriticalErrors = this.recentEvents.filter((event)=>event.type === 'error' && event.error?.code === 'QUOTA_EXCEEDED' && Date.now() - event.timestamp < 60 * 60 * 1000 // Last hour
        );
        if (recentCriticalErrors.length > 0) {
            status = 'critical';
            issues.push('Quota exceeded errors in the last hour');
            recommendations.push('Immediate attention required - email service quota exceeded');
        }
        // Check average response time
        if (this.stats.averageResponseTime > 5000) {
            status = status === 'critical' ? 'critical' : 'warning';
            issues.push(`High response time: ${this.stats.averageResponseTime}ms`);
            recommendations.push('Check email service performance and network latency');
        }
        return {
            status,
            issues,
            recommendations
        };
    }
    addEvent(event) {
        this.recentEvents.push(event);
        // Keep only the most recent events
        if (this.recentEvents.length > this.maxEvents) {
            this.recentEvents = this.recentEvents.slice(-this.maxEvents);
        }
    }
    updateStats() {
        const total = this.stats.totalSent + this.stats.totalFailed;
        this.stats.successRate = total > 0 ? this.stats.totalSent / total * 100 : 100;
        // Calculate average response time from recent events
        const recentEvents = this.recentEvents.slice(-100);
        if (recentEvents.length > 0) {
            const totalTime = recentEvents.reduce((sum, event)=>sum + event.responseTime, 0);
            this.stats.averageResponseTime = Math.round(totalTime / recentEvents.length);
        }
    }
    checkForReset() {
        const now = Date.now();
        if (now - this.stats.lastResetTime >= this.resetInterval) {
            this.resetDailyStats();
        }
    }
    getQuotaLimit() {
        // Default Resend free tier limits
        // This could be made configurable via environment variables
        const dailyLimit = parseInt(process.env.EMAIL_DAILY_QUOTA || '100', 10);
        return dailyLimit;
    }
    handleQuotaExceeded() {
        console.error('[EMAIL_MONITOR] CRITICAL: Email quota exceeded!');
        // In a production system, you might want to:
        // - Send alerts to administrators
        // - Temporarily disable email sending
        // - Switch to a backup email service
        // - Log to external monitoring system
        if (process.env.NODE_ENV === 'production') {
            // Log critical error for external monitoring
            console.error('[EMAIL_MONITOR] ALERT: Email service quota exceeded - immediate attention required');
        }
    }
}
const emailServiceMonitor = new EmailServiceMonitor();
// Schedule daily reset
if (process.env.NODE_ENV === 'production') {
    // Reset at midnight UTC
    const now = new Date();
    const tomorrow = new Date(now);
    tomorrow.setUTCDate(tomorrow.getUTCDate() + 1);
    tomorrow.setUTCHours(0, 0, 0, 0);
    const msUntilMidnight = tomorrow.getTime() - now.getTime();
    setTimeout(()=>{
        emailServiceMonitor.resetDailyStats();
        // Then reset every 24 hours
        setInterval(()=>{
            emailServiceMonitor.resetDailyStats();
        }, 24 * 60 * 60 * 1000);
    }, msUntilMidnight);
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdGVmYW5iZWtrZXIvcHJvamVjdHMvZmFuY3ktcGxhbnRpZXMvc3JjL2xpYi9zZXJ2aWNlcy9lbWFpbC1zZXJ2aWNlLW1vbml0b3IudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICdzZXJ2ZXItb25seSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1haWxTZXJ2aWNlU3RhdHMge1xuICB0b3RhbFNlbnQ6IG51bWJlcjtcbiAgdG90YWxGYWlsZWQ6IG51bWJlcjtcbiAgcXVvdGFVc2VkOiBudW1iZXI7XG4gIHF1b3RhTGltaXQ6IG51bWJlcjtcbiAgbGFzdEVycm9yPzoge1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICBjb2RlOiBzdHJpbmc7XG4gICAgdGltZXN0YW1wOiBudW1iZXI7XG4gIH07XG4gIGVycm9yc0J5VHlwZTogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgc3VjY2Vzc1JhdGU6IG51bWJlcjtcbiAgYXZlcmFnZVJlc3BvbnNlVGltZTogbnVtYmVyO1xuICBsYXN0UmVzZXRUaW1lOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1haWxTZXJ2aWNlRXZlbnQge1xuICB0eXBlOiAnc3VjY2VzcycgfCAnZXJyb3InO1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbiAgcmVzcG9uc2VUaW1lOiBudW1iZXI7XG4gIGVycm9yPzoge1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICBjb2RlOiBzdHJpbmc7XG4gIH07XG59XG5cbmV4cG9ydCBjbGFzcyBFbWFpbFNlcnZpY2VNb25pdG9yIHtcbiAgcHJpdmF0ZSBzdGF0czogRW1haWxTZXJ2aWNlU3RhdHM7XG4gIHByaXZhdGUgcmVjZW50RXZlbnRzOiBFbWFpbFNlcnZpY2VFdmVudFtdID0gW107XG4gIHByaXZhdGUgcmVhZG9ubHkgbWF4RXZlbnRzID0gMTAwMDsgLy8gS2VlcCBsYXN0IDEwMDAgZXZlbnRzXG4gIHByaXZhdGUgcmVhZG9ubHkgcmVzZXRJbnRlcnZhbCA9IDI0ICogNjAgKiA2MCAqIDEwMDA7IC8vIDI0IGhvdXJzXG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5zdGF0cyA9IHtcbiAgICAgIHRvdGFsU2VudDogMCxcbiAgICAgIHRvdGFsRmFpbGVkOiAwLFxuICAgICAgcXVvdGFVc2VkOiAwLFxuICAgICAgcXVvdGFMaW1pdDogdGhpcy5nZXRRdW90YUxpbWl0KCksXG4gICAgICBlcnJvcnNCeVR5cGU6IHt9LFxuICAgICAgc3VjY2Vzc1JhdGU6IDEwMCxcbiAgICAgIGF2ZXJhZ2VSZXNwb25zZVRpbWU6IDAsXG4gICAgICBsYXN0UmVzZXRUaW1lOiBEYXRlLm5vdygpLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUmVjb3JkIGEgc3VjY2Vzc2Z1bCBlbWFpbCBzZW5kXG4gICAqL1xuICByZWNvcmRTdWNjZXNzKHJlc3BvbnNlVGltZTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5zdGF0cy50b3RhbFNlbnQrKztcbiAgICBpZiAodGhpcy5zdGF0cy5xdW90YUxpbWl0ID4gMCkge1xuICAgICAgdGhpcy5zdGF0cy5xdW90YVVzZWQrKztcbiAgICB9XG4gICAgXG4gICAgY29uc3QgZXZlbnQ6IEVtYWlsU2VydmljZUV2ZW50ID0ge1xuICAgICAgdHlwZTogJ3N1Y2Nlc3MnLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgcmVzcG9uc2VUaW1lLFxuICAgIH07XG4gICAgXG4gICAgdGhpcy5hZGRFdmVudChldmVudCk7XG4gICAgdGhpcy51cGRhdGVTdGF0cygpO1xuICAgIFxuICAgIC8vIExvZyBzdWNjZXNzIGluIGRldmVsb3BtZW50XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnKSB7XG4gICAgICBjb25zb2xlLmxvZyhgW0VNQUlMX01PTklUT1JdIEVtYWlsIHNlbnQgc3VjY2Vzc2Z1bGx5ICgke3Jlc3BvbnNlVGltZX1tcylgKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVjb3JkIGEgZmFpbGVkIGVtYWlsIHNlbmRcbiAgICovXG4gIHJlY29yZEZhaWx1cmUoZXJyb3I6IHsgbWVzc2FnZTogc3RyaW5nOyBjb2RlOiBzdHJpbmcgfSwgcmVzcG9uc2VUaW1lOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnN0YXRzLnRvdGFsRmFpbGVkKys7XG4gICAgXG4gICAgLy8gVXBkYXRlIGVycm9yIGNvdW50cyBieSB0eXBlXG4gICAgdGhpcy5zdGF0cy5lcnJvcnNCeVR5cGVbZXJyb3IuY29kZV0gPSAodGhpcy5zdGF0cy5lcnJvcnNCeVR5cGVbZXJyb3IuY29kZV0gfHwgMCkgKyAxO1xuICAgIFxuICAgIC8vIFVwZGF0ZSBsYXN0IGVycm9yXG4gICAgdGhpcy5zdGF0cy5sYXN0RXJyb3IgPSB7XG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgY29kZTogZXJyb3IuY29kZSxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICB9O1xuICAgIFxuICAgIGNvbnN0IGV2ZW50OiBFbWFpbFNlcnZpY2VFdmVudCA9IHtcbiAgICAgIHR5cGU6ICdlcnJvcicsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICByZXNwb25zZVRpbWUsXG4gICAgICBlcnJvcixcbiAgICB9O1xuICAgIFxuICAgIHRoaXMuYWRkRXZlbnQoZXZlbnQpO1xuICAgIHRoaXMudXBkYXRlU3RhdHMoKTtcbiAgICBcbiAgICAvLyBMb2cgZXJyb3JcbiAgICBjb25zb2xlLmVycm9yKGBbRU1BSUxfTU9OSVRPUl0gRW1haWwgc2VuZCBmYWlsZWQ6ICR7ZXJyb3IuY29kZX0gLSAke2Vycm9yLm1lc3NhZ2V9ICgke3Jlc3BvbnNlVGltZX1tcylgKTtcbiAgICBcbiAgICAvLyBDaGVjayBmb3IgcXVvdGEgaXNzdWVzXG4gICAgaWYgKGVycm9yLmNvZGUgPT09ICdRVU9UQV9FWENFRURFRCcpIHtcbiAgICAgIHRoaXMuaGFuZGxlUXVvdGFFeGNlZWRlZCgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY3VycmVudCBzdGF0aXN0aWNzXG4gICAqL1xuICBnZXRTdGF0cygpOiBFbWFpbFNlcnZpY2VTdGF0cyB7XG4gICAgdGhpcy5jaGVja0ZvclJlc2V0KCk7XG4gICAgcmV0dXJuIHsgLi4udGhpcy5zdGF0cyB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCByZWNlbnQgZXZlbnRzIChsYXN0IE4gZXZlbnRzKVxuICAgKi9cbiAgZ2V0UmVjZW50RXZlbnRzKGxpbWl0OiBudW1iZXIgPSAxMDApOiBFbWFpbFNlcnZpY2VFdmVudFtdIHtcbiAgICByZXR1cm4gdGhpcy5yZWNlbnRFdmVudHMuc2xpY2UoLWxpbWl0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZXJyb3Igc3VtbWFyeVxuICAgKi9cbiAgZ2V0RXJyb3JTdW1tYXJ5KCk6IHtcbiAgICB0b3RhbEVycm9yczogbnVtYmVyO1xuICAgIGVycm9yc0J5VHlwZTogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgICByZWNlbnRFcnJvcnM6IEVtYWlsU2VydmljZUV2ZW50W107XG4gICAgY3JpdGljYWxFcnJvcnM6IEVtYWlsU2VydmljZUV2ZW50W107XG4gIH0ge1xuICAgIGNvbnN0IHJlY2VudEVycm9ycyA9IHRoaXMucmVjZW50RXZlbnRzXG4gICAgICAuZmlsdGVyKGV2ZW50ID0+IGV2ZW50LnR5cGUgPT09ICdlcnJvcicpXG4gICAgICAuc2xpY2UoLTUwKTtcbiAgICBcbiAgICBjb25zdCBjcml0aWNhbEVycm9ycyA9IHRoaXMucmVjZW50RXZlbnRzXG4gICAgICAuZmlsdGVyKGV2ZW50ID0+IFxuICAgICAgICBldmVudC50eXBlID09PSAnZXJyb3InICYmIFxuICAgICAgICBldmVudC5lcnJvcj8uY29kZSA9PT0gJ1FVT1RBX0VYQ0VFREVEJ1xuICAgICAgKVxuICAgICAgLnNsaWNlKC0xMCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxFcnJvcnM6IHRoaXMuc3RhdHMudG90YWxGYWlsZWQsXG4gICAgICBlcnJvcnNCeVR5cGU6IHsgLi4udGhpcy5zdGF0cy5lcnJvcnNCeVR5cGUgfSxcbiAgICAgIHJlY2VudEVycm9ycyxcbiAgICAgIGNyaXRpY2FsRXJyb3JzLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgcXVvdGEgaXMgYXBwcm9hY2hpbmcgbGltaXRcbiAgICovXG4gIGlzUXVvdGFOZWFyTGltaXQodGhyZXNob2xkOiBudW1iZXIgPSAwLjgpOiBib29sZWFuIHtcbiAgICBpZiAodGhpcy5zdGF0cy5xdW90YUxpbWl0ID09PSAwKSByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuICh0aGlzLnN0YXRzLnF1b3RhVXNlZCAvIHRoaXMuc3RhdHMucXVvdGFMaW1pdCkgPj0gdGhyZXNob2xkO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBxdW90YSB1c2FnZSBwZXJjZW50YWdlXG4gICAqL1xuICBnZXRRdW90YVVzYWdlUGVyY2VudGFnZSgpOiBudW1iZXIge1xuICAgIGlmICh0aGlzLnN0YXRzLnF1b3RhTGltaXQgPT09IDApIHJldHVybiAwO1xuICAgIHJldHVybiBNYXRoLnJvdW5kKCh0aGlzLnN0YXRzLnF1b3RhVXNlZCAvIHRoaXMuc3RhdHMucXVvdGFMaW1pdCkgKiAxMDApO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc2V0IGRhaWx5IHN0YXRpc3RpY3MgKGNhbGxlZCBhdXRvbWF0aWNhbGx5KVxuICAgKi9cbiAgcmVzZXREYWlseVN0YXRzKCk6IHZvaWQge1xuICAgIGNvbnNvbGUubG9nKCdbRU1BSUxfTU9OSVRPUl0gUmVzZXR0aW5nIGRhaWx5IHN0YXRpc3RpY3MnKTtcbiAgICBcbiAgICB0aGlzLnN0YXRzLnRvdGFsU2VudCA9IDA7XG4gICAgdGhpcy5zdGF0cy50b3RhbEZhaWxlZCA9IDA7XG4gICAgdGhpcy5zdGF0cy5xdW90YVVzZWQgPSAwO1xuICAgIHRoaXMuc3RhdHMuZXJyb3JzQnlUeXBlID0ge307XG4gICAgdGhpcy5zdGF0cy5sYXN0UmVzZXRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICBcbiAgICAvLyBLZWVwIG9ubHkgcmVjZW50IGV2ZW50cyAobGFzdCAxMDApXG4gICAgdGhpcy5yZWNlbnRFdmVudHMgPSB0aGlzLnJlY2VudEV2ZW50cy5zbGljZSgtMTAwKTtcbiAgICBcbiAgICB0aGlzLnVwZGF0ZVN0YXRzKCk7XG4gIH1cblxuICAvKipcbiAgICogRm9yY2UgcmVzZXQgc3RhdGlzdGljcyAoZm9yIHRlc3Rpbmcgb3IgbWFudWFsIHJlc2V0KVxuICAgKi9cbiAgZm9yY2VSZXNldCgpOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZygnW0VNQUlMX01PTklUT1JdIEZvcmNlIHJlc2V0dGluZyBzdGF0aXN0aWNzJyk7XG4gICAgdGhpcy5yZXNldERhaWx5U3RhdHMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgaGVhbHRoIHN0YXR1c1xuICAgKi9cbiAgZ2V0SGVhbHRoU3RhdHVzKCk6IHtcbiAgICBzdGF0dXM6ICdoZWFsdGh5JyB8ICd3YXJuaW5nJyB8ICdjcml0aWNhbCc7XG4gICAgaXNzdWVzOiBzdHJpbmdbXTtcbiAgICByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdO1xuICB9IHtcbiAgICBjb25zdCBpc3N1ZXM6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgIGxldCBzdGF0dXM6ICdoZWFsdGh5JyB8ICd3YXJuaW5nJyB8ICdjcml0aWNhbCcgPSAnaGVhbHRoeSc7XG5cbiAgICAvLyBDaGVjayBzdWNjZXNzIHJhdGVcbiAgICBpZiAodGhpcy5zdGF0cy5zdWNjZXNzUmF0ZSA8IDk1KSB7XG4gICAgICBzdGF0dXMgPSAnd2FybmluZyc7XG4gICAgICBpc3N1ZXMucHVzaChgTG93IHN1Y2Nlc3MgcmF0ZTogJHt0aGlzLnN0YXRzLnN1Y2Nlc3NSYXRlLnRvRml4ZWQoMSl9JWApO1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0NoZWNrIGVtYWlsIHNlcnZpY2UgY29uZmlndXJhdGlvbiBhbmQgbmV0d29yayBjb25uZWN0aXZpdHknKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zdGF0cy5zdWNjZXNzUmF0ZSA8IDgwKSB7XG4gICAgICBzdGF0dXMgPSAnY3JpdGljYWwnO1xuICAgIH1cblxuICAgIC8vIENoZWNrIHF1b3RhIHVzYWdlXG4gICAgaWYgKHRoaXMuaXNRdW90YU5lYXJMaW1pdCgwLjkpKSB7XG4gICAgICBzdGF0dXMgPSBzdGF0dXMgPT09ICdjcml0aWNhbCcgPyAnY3JpdGljYWwnIDogJ3dhcm5pbmcnO1xuICAgICAgaXNzdWVzLnB1c2goYEhpZ2ggcXVvdGEgdXNhZ2U6ICR7dGhpcy5nZXRRdW90YVVzYWdlUGVyY2VudGFnZSgpfSVgKTtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdDb25zaWRlciB1cGdyYWRpbmcgZW1haWwgc2VydmljZSBwbGFuIG9yIGltcGxlbWVudGluZyBlbWFpbCB0aHJvdHRsaW5nJyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNRdW90YU5lYXJMaW1pdCgwLjk1KSkge1xuICAgICAgc3RhdHVzID0gJ2NyaXRpY2FsJztcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3IgcmVjZW50IGNyaXRpY2FsIGVycm9yc1xuICAgIGNvbnN0IHJlY2VudENyaXRpY2FsRXJyb3JzID0gdGhpcy5yZWNlbnRFdmVudHNcbiAgICAgIC5maWx0ZXIoZXZlbnQgPT4gXG4gICAgICAgIGV2ZW50LnR5cGUgPT09ICdlcnJvcicgJiYgXG4gICAgICAgIGV2ZW50LmVycm9yPy5jb2RlID09PSAnUVVPVEFfRVhDRUVERUQnICYmXG4gICAgICAgIERhdGUubm93KCkgLSBldmVudC50aW1lc3RhbXAgPCA2MCAqIDYwICogMTAwMCAvLyBMYXN0IGhvdXJcbiAgICAgICk7XG5cbiAgICBpZiAocmVjZW50Q3JpdGljYWxFcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgc3RhdHVzID0gJ2NyaXRpY2FsJztcbiAgICAgIGlzc3Vlcy5wdXNoKCdRdW90YSBleGNlZWRlZCBlcnJvcnMgaW4gdGhlIGxhc3QgaG91cicpO1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0ltbWVkaWF0ZSBhdHRlbnRpb24gcmVxdWlyZWQgLSBlbWFpbCBzZXJ2aWNlIHF1b3RhIGV4Y2VlZGVkJyk7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgYXZlcmFnZSByZXNwb25zZSB0aW1lXG4gICAgaWYgKHRoaXMuc3RhdHMuYXZlcmFnZVJlc3BvbnNlVGltZSA+IDUwMDApIHtcbiAgICAgIHN0YXR1cyA9IHN0YXR1cyA9PT0gJ2NyaXRpY2FsJyA/ICdjcml0aWNhbCcgOiAnd2FybmluZyc7XG4gICAgICBpc3N1ZXMucHVzaChgSGlnaCByZXNwb25zZSB0aW1lOiAke3RoaXMuc3RhdHMuYXZlcmFnZVJlc3BvbnNlVGltZX1tc2ApO1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0NoZWNrIGVtYWlsIHNlcnZpY2UgcGVyZm9ybWFuY2UgYW5kIG5ldHdvcmsgbGF0ZW5jeScpO1xuICAgIH1cblxuICAgIHJldHVybiB7IHN0YXR1cywgaXNzdWVzLCByZWNvbW1lbmRhdGlvbnMgfTtcbiAgfVxuXG4gIHByaXZhdGUgYWRkRXZlbnQoZXZlbnQ6IEVtYWlsU2VydmljZUV2ZW50KTogdm9pZCB7XG4gICAgdGhpcy5yZWNlbnRFdmVudHMucHVzaChldmVudCk7XG4gICAgXG4gICAgLy8gS2VlcCBvbmx5IHRoZSBtb3N0IHJlY2VudCBldmVudHNcbiAgICBpZiAodGhpcy5yZWNlbnRFdmVudHMubGVuZ3RoID4gdGhpcy5tYXhFdmVudHMpIHtcbiAgICAgIHRoaXMucmVjZW50RXZlbnRzID0gdGhpcy5yZWNlbnRFdmVudHMuc2xpY2UoLXRoaXMubWF4RXZlbnRzKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZVN0YXRzKCk6IHZvaWQge1xuICAgIGNvbnN0IHRvdGFsID0gdGhpcy5zdGF0cy50b3RhbFNlbnQgKyB0aGlzLnN0YXRzLnRvdGFsRmFpbGVkO1xuICAgIHRoaXMuc3RhdHMuc3VjY2Vzc1JhdGUgPSB0b3RhbCA+IDAgPyAodGhpcy5zdGF0cy50b3RhbFNlbnQgLyB0b3RhbCkgKiAxMDAgOiAxMDA7XG4gICAgXG4gICAgLy8gQ2FsY3VsYXRlIGF2ZXJhZ2UgcmVzcG9uc2UgdGltZSBmcm9tIHJlY2VudCBldmVudHNcbiAgICBjb25zdCByZWNlbnRFdmVudHMgPSB0aGlzLnJlY2VudEV2ZW50cy5zbGljZSgtMTAwKTtcbiAgICBpZiAocmVjZW50RXZlbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IHRvdGFsVGltZSA9IHJlY2VudEV2ZW50cy5yZWR1Y2UoKHN1bSwgZXZlbnQpID0+IHN1bSArIGV2ZW50LnJlc3BvbnNlVGltZSwgMCk7XG4gICAgICB0aGlzLnN0YXRzLmF2ZXJhZ2VSZXNwb25zZVRpbWUgPSBNYXRoLnJvdW5kKHRvdGFsVGltZSAvIHJlY2VudEV2ZW50cy5sZW5ndGgpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY2hlY2tGb3JSZXNldCgpOiB2b2lkIHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGlmIChub3cgLSB0aGlzLnN0YXRzLmxhc3RSZXNldFRpbWUgPj0gdGhpcy5yZXNldEludGVydmFsKSB7XG4gICAgICB0aGlzLnJlc2V0RGFpbHlTdGF0cygpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0UXVvdGFMaW1pdCgpOiBudW1iZXIge1xuICAgIC8vIERlZmF1bHQgUmVzZW5kIGZyZWUgdGllciBsaW1pdHNcbiAgICAvLyBUaGlzIGNvdWxkIGJlIG1hZGUgY29uZmlndXJhYmxlIHZpYSBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbiAgICBjb25zdCBkYWlseUxpbWl0ID0gcGFyc2VJbnQocHJvY2Vzcy5lbnYuRU1BSUxfREFJTFlfUVVPVEEgfHwgJzEwMCcsIDEwKTtcbiAgICByZXR1cm4gZGFpbHlMaW1pdDtcbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlUXVvdGFFeGNlZWRlZCgpOiB2b2lkIHtcbiAgICBjb25zb2xlLmVycm9yKCdbRU1BSUxfTU9OSVRPUl0gQ1JJVElDQUw6IEVtYWlsIHF1b3RhIGV4Y2VlZGVkIScpO1xuICAgIFxuICAgIC8vIEluIGEgcHJvZHVjdGlvbiBzeXN0ZW0sIHlvdSBtaWdodCB3YW50IHRvOlxuICAgIC8vIC0gU2VuZCBhbGVydHMgdG8gYWRtaW5pc3RyYXRvcnNcbiAgICAvLyAtIFRlbXBvcmFyaWx5IGRpc2FibGUgZW1haWwgc2VuZGluZ1xuICAgIC8vIC0gU3dpdGNoIHRvIGEgYmFja3VwIGVtYWlsIHNlcnZpY2VcbiAgICAvLyAtIExvZyB0byBleHRlcm5hbCBtb25pdG9yaW5nIHN5c3RlbVxuICAgIFxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAvLyBMb2cgY3JpdGljYWwgZXJyb3IgZm9yIGV4dGVybmFsIG1vbml0b3JpbmdcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tFTUFJTF9NT05JVE9SXSBBTEVSVDogRW1haWwgc2VydmljZSBxdW90YSBleGNlZWRlZCAtIGltbWVkaWF0ZSBhdHRlbnRpb24gcmVxdWlyZWQnKTtcbiAgICB9XG4gIH1cbn1cblxuLy8gRXhwb3J0IHNpbmdsZXRvbiBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IGVtYWlsU2VydmljZU1vbml0b3IgPSBuZXcgRW1haWxTZXJ2aWNlTW9uaXRvcigpO1xuXG4vLyBTY2hlZHVsZSBkYWlseSByZXNldFxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicpIHtcbiAgLy8gUmVzZXQgYXQgbWlkbmlnaHQgVVRDXG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gIGNvbnN0IHRvbW9ycm93ID0gbmV3IERhdGUobm93KTtcbiAgdG9tb3Jyb3cuc2V0VVRDRGF0ZSh0b21vcnJvdy5nZXRVVENEYXRlKCkgKyAxKTtcbiAgdG9tb3Jyb3cuc2V0VVRDSG91cnMoMCwgMCwgMCwgMCk7XG4gIFxuICBjb25zdCBtc1VudGlsTWlkbmlnaHQgPSB0b21vcnJvdy5nZXRUaW1lKCkgLSBub3cuZ2V0VGltZSgpO1xuICBcbiAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgZW1haWxTZXJ2aWNlTW9uaXRvci5yZXNldERhaWx5U3RhdHMoKTtcbiAgICBcbiAgICAvLyBUaGVuIHJlc2V0IGV2ZXJ5IDI0IGhvdXJzXG4gICAgc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgZW1haWxTZXJ2aWNlTW9uaXRvci5yZXNldERhaWx5U3RhdHMoKTtcbiAgICB9LCAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgfSwgbXNVbnRpbE1pZG5pZ2h0KTtcbn0iXSwibmFtZXMiOlsiRW1haWxTZXJ2aWNlTW9uaXRvciIsImVtYWlsU2VydmljZU1vbml0b3IiLCJyZWNlbnRFdmVudHMiLCJtYXhFdmVudHMiLCJyZXNldEludGVydmFsIiwic3RhdHMiLCJ0b3RhbFNlbnQiLCJ0b3RhbEZhaWxlZCIsInF1b3RhVXNlZCIsInF1b3RhTGltaXQiLCJnZXRRdW90YUxpbWl0IiwiZXJyb3JzQnlUeXBlIiwic3VjY2Vzc1JhdGUiLCJhdmVyYWdlUmVzcG9uc2VUaW1lIiwibGFzdFJlc2V0VGltZSIsIkRhdGUiLCJub3ciLCJyZWNvcmRTdWNjZXNzIiwicmVzcG9uc2VUaW1lIiwiZXZlbnQiLCJ0eXBlIiwidGltZXN0YW1wIiwiYWRkRXZlbnQiLCJ1cGRhdGVTdGF0cyIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsImNvbnNvbGUiLCJsb2ciLCJyZWNvcmRGYWlsdXJlIiwiZXJyb3IiLCJjb2RlIiwibGFzdEVycm9yIiwibWVzc2FnZSIsImhhbmRsZVF1b3RhRXhjZWVkZWQiLCJnZXRTdGF0cyIsImNoZWNrRm9yUmVzZXQiLCJnZXRSZWNlbnRFdmVudHMiLCJsaW1pdCIsInNsaWNlIiwiZ2V0RXJyb3JTdW1tYXJ5IiwicmVjZW50RXJyb3JzIiwiZmlsdGVyIiwiY3JpdGljYWxFcnJvcnMiLCJ0b3RhbEVycm9ycyIsImlzUXVvdGFOZWFyTGltaXQiLCJ0aHJlc2hvbGQiLCJnZXRRdW90YVVzYWdlUGVyY2VudGFnZSIsIk1hdGgiLCJyb3VuZCIsInJlc2V0RGFpbHlTdGF0cyIsImZvcmNlUmVzZXQiLCJnZXRIZWFsdGhTdGF0dXMiLCJpc3N1ZXMiLCJyZWNvbW1lbmRhdGlvbnMiLCJzdGF0dXMiLCJwdXNoIiwidG9GaXhlZCIsInJlY2VudENyaXRpY2FsRXJyb3JzIiwibGVuZ3RoIiwidG90YWwiLCJ0b3RhbFRpbWUiLCJyZWR1Y2UiLCJzdW0iLCJkYWlseUxpbWl0IiwicGFyc2VJbnQiLCJFTUFJTF9EQUlMWV9RVU9UQSIsInRvbW9ycm93Iiwic2V0VVRDRGF0ZSIsImdldFVUQ0RhdGUiLCJzZXRVVENIb3VycyIsIm1zVW50aWxNaWRuaWdodCIsImdldFRpbWUiLCJzZXRUaW1lb3V0Iiwic2V0SW50ZXJ2YWwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O1FBNEJhQTtlQUFBQTs7UUFpUkFDO2VBQUFBOzs7UUE3U047QUE0QkEsTUFBTUQ7SUFNWCxhQUFjO2FBSk5FLGVBQW9DLEVBQUU7YUFDN0JDLFlBQVksTUFBTSx3QkFBd0I7YUFDMUNDLGdCQUFnQixLQUFLLEtBQUssS0FBSyxNQUFNLFdBQVc7UUFHL0QsSUFBSSxDQUFDQyxLQUFLLEdBQUc7WUFDWEMsV0FBVztZQUNYQyxhQUFhO1lBQ2JDLFdBQVc7WUFDWEMsWUFBWSxJQUFJLENBQUNDLGFBQWE7WUFDOUJDLGNBQWMsQ0FBQztZQUNmQyxhQUFhO1lBQ2JDLHFCQUFxQjtZQUNyQkMsZUFBZUMsS0FBS0MsR0FBRztRQUN6QjtJQUNGO0lBRUE7O0dBRUMsR0FDREMsY0FBY0MsWUFBb0IsRUFBUTtRQUN4QyxJQUFJLENBQUNiLEtBQUssQ0FBQ0MsU0FBUztRQUNwQixJQUFJLElBQUksQ0FBQ0QsS0FBSyxDQUFDSSxVQUFVLEdBQUcsR0FBRztZQUM3QixJQUFJLENBQUNKLEtBQUssQ0FBQ0csU0FBUztRQUN0QjtRQUVBLE1BQU1XLFFBQTJCO1lBQy9CQyxNQUFNO1lBQ05DLFdBQVdOLEtBQUtDLEdBQUc7WUFDbkJFO1FBQ0Y7UUFF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