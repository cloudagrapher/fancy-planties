f16562265a6b1f229a950f6ffe730338
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get EmailServiceMonitor () {
        return EmailServiceMonitor;
    },
    get emailServiceMonitor () {
        return emailServiceMonitor;
    }
});
require("server-only");
class EmailServiceMonitor {
    constructor(){
        this.recentEvents = [];
        this.maxEvents = 1000; // Keep last 1000 events
        this.resetInterval = 24 * 60 * 60 * 1000; // 24 hours
        this.stats = {
            totalSent: 0,
            totalFailed: 0,
            quotaUsed: 0,
            quotaLimit: this.getQuotaLimit(),
            errorsByType: {},
            successRate: 100,
            averageResponseTime: 0,
            lastResetTime: Date.now()
        };
    }
    /**
   * Record a successful email send
   */ recordSuccess(responseTime) {
        this.stats.totalSent++;
        this.stats.quotaUsed++;
        const event = {
            type: 'success',
            timestamp: Date.now(),
            responseTime
        };
        this.addEvent(event);
        this.updateStats();
        // Log success in development
        if (process.env.NODE_ENV === 'development') {
            console.log(`[EMAIL_MONITOR] Email sent successfully (${responseTime}ms)`);
        }
    }
    /**
   * Record a failed email send
   */ recordFailure(error, responseTime) {
        this.stats.totalFailed++;
        // Update error counts by type
        this.stats.errorsByType[error.code] = (this.stats.errorsByType[error.code] || 0) + 1;
        // Update last error
        this.stats.lastError = {
            message: error.message,
            code: error.code,
            timestamp: Date.now()
        };
        const event = {
            type: 'error',
            timestamp: Date.now(),
            responseTime,
            error
        };
        this.addEvent(event);
        this.updateStats();
        // Log error
        console.error(`[EMAIL_MONITOR] Email send failed: ${error.code} - ${error.message} (${responseTime}ms)`);
        // Check for quota issues
        if (error.code === 'QUOTA_EXCEEDED') {
            this.handleQuotaExceeded();
        }
    }
    /**
   * Get current statistics
   */ getStats() {
        this.checkForReset();
        return {
            ...this.stats
        };
    }
    /**
   * Get recent events (last N events)
   */ getRecentEvents(limit = 100) {
        return this.recentEvents.slice(-limit);
    }
    /**
   * Get error summary
   */ getErrorSummary() {
        const recentErrors = this.recentEvents.filter((event)=>event.type === 'error').slice(-50);
        const criticalErrors = this.recentEvents.filter((event)=>event.type === 'error' && event.error?.code === 'QUOTA_EXCEEDED').slice(-10);
        return {
            totalErrors: this.stats.totalFailed,
            errorsByType: {
                ...this.stats.errorsByType
            },
            recentErrors,
            criticalErrors
        };
    }
    /**
   * Check if quota is approaching limit
   */ isQuotaNearLimit(threshold = 0.8) {
        if (this.stats.quotaLimit === 0) return false;
        return this.stats.quotaUsed / this.stats.quotaLimit >= threshold;
    }
    /**
   * Get quota usage percentage
   */ getQuotaUsagePercentage() {
        if (this.stats.quotaLimit === 0) return 0;
        return Math.round(this.stats.quotaUsed / this.stats.quotaLimit * 100);
    }
    /**
   * Reset daily statistics (called automatically)
   */ resetDailyStats() {
        console.log('[EMAIL_MONITOR] Resetting daily statistics');
        this.stats.totalSent = 0;
        this.stats.totalFailed = 0;
        this.stats.quotaUsed = 0;
        this.stats.errorsByType = {};
        this.stats.lastResetTime = Date.now();
        // Keep only recent events (last 100)
        this.recentEvents = this.recentEvents.slice(-100);
        this.updateStats();
    }
    /**
   * Force reset statistics (for testing or manual reset)
   */ forceReset() {
        console.log('[EMAIL_MONITOR] Force resetting statistics');
        this.resetDailyStats();
    }
    /**
   * Get health status
   */ getHealthStatus() {
        const issues = [];
        const recommendations = [];
        let status = 'healthy';
        // Check success rate
        if (this.stats.successRate < 95) {
            status = 'warning';
            issues.push(`Low success rate: ${this.stats.successRate.toFixed(1)}%`);
            recommendations.push('Check email service configuration and network connectivity');
        }
        if (this.stats.successRate < 80) {
            status = 'critical';
        }
        // Check quota usage
        if (this.isQuotaNearLimit(0.9)) {
            status = status === 'critical' ? 'critical' : 'warning';
            issues.push(`High quota usage: ${this.getQuotaUsagePercentage()}%`);
            recommendations.push('Consider upgrading email service plan or implementing email throttling');
        }
        if (this.isQuotaNearLimit(0.95)) {
            status = 'critical';
        }
        // Check for recent critical errors
        const recentCriticalErrors = this.recentEvents.filter((event)=>event.type === 'error' && event.error?.code === 'QUOTA_EXCEEDED' && Date.now() - event.timestamp < 60 * 60 * 1000 // Last hour
        );
        if (recentCriticalErrors.length > 0) {
            status = 'critical';
            issues.push('Quota exceeded errors in the last hour');
            recommendations.push('Immediate attention required - email service quota exceeded');
        }
        // Check average response time
        if (this.stats.averageResponseTime > 5000) {
            status = status === 'critical' ? 'critical' : 'warning';
            issues.push(`High response time: ${this.stats.averageResponseTime}ms`);
            recommendations.push('Check email service performance and network latency');
        }
        return {
            status,
            issues,
            recommendations
        };
    }
    addEvent(event) {
        this.recentEvents.push(event);
        // Keep only the most recent events
        if (this.recentEvents.length > this.maxEvents) {
            this.recentEvents = this.recentEvents.slice(-this.maxEvents);
        }
    }
    updateStats() {
        const total = this.stats.totalSent + this.stats.totalFailed;
        this.stats.successRate = total > 0 ? this.stats.totalSent / total * 100 : 100;
        // Calculate average response time from recent events
        const recentEvents = this.recentEvents.slice(-100);
        if (recentEvents.length > 0) {
            const totalTime = recentEvents.reduce((sum, event)=>sum + event.responseTime, 0);
            this.stats.averageResponseTime = Math.round(totalTime / recentEvents.length);
        }
    }
    checkForReset() {
        const now = Date.now();
        if (now - this.stats.lastResetTime >= this.resetInterval) {
            this.resetDailyStats();
        }
    }
    getQuotaLimit() {
        // Default Resend free tier limits
        // This could be made configurable via environment variables
        const dailyLimit = parseInt(process.env.EMAIL_DAILY_QUOTA || '100', 10);
        return dailyLimit;
    }
    handleQuotaExceeded() {
        console.error('[EMAIL_MONITOR] CRITICAL: Email quota exceeded!');
        // In a production system, you might want to:
        // - Send alerts to administrators
        // - Temporarily disable email sending
        // - Switch to a backup email service
        // - Log to external monitoring system
        if (process.env.NODE_ENV === 'production') {
            // Log critical error for external monitoring
            console.error('[EMAIL_MONITOR] ALERT: Email service quota exceeded - immediate attention required');
        }
    }
}
const emailServiceMonitor = new EmailServiceMonitor();
// Schedule daily reset
if (process.env.NODE_ENV === 'production') {
    // Reset at midnight UTC
    const now = new Date();
    const tomorrow = new Date(now);
    tomorrow.setUTCDate(tomorrow.getUTCDate() + 1);
    tomorrow.setUTCHours(0, 0, 0, 0);
    const msUntilMidnight = tomorrow.getTime() - now.getTime();
    setTimeout(()=>{
        emailServiceMonitor.resetDailyStats();
        // Then reset every 24 hours
        setInterval(()=>{
            emailServiceMonitor.resetDailyStats();
        }, 24 * 60 * 60 * 1000);
    }, msUntilMidnight);
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdGVmYW5iZWtrZXIvcHJvamVjdHMvZmFuY3ktcGxhbnRpZXMvc3JjL2xpYi9zZXJ2aWNlcy9lbWFpbC1zZXJ2aWNlLW1vbml0b3IudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICdzZXJ2ZXItb25seSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1haWxTZXJ2aWNlU3RhdHMge1xuICB0b3RhbFNlbnQ6IG51bWJlcjtcbiAgdG90YWxGYWlsZWQ6IG51bWJlcjtcbiAgcXVvdGFVc2VkOiBudW1iZXI7XG4gIHF1b3RhTGltaXQ6IG51bWJlcjtcbiAgbGFzdEVycm9yPzoge1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICBjb2RlOiBzdHJpbmc7XG4gICAgdGltZXN0YW1wOiBudW1iZXI7XG4gIH07XG4gIGVycm9yc0J5VHlwZTogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgc3VjY2Vzc1JhdGU6IG51bWJlcjtcbiAgYXZlcmFnZVJlc3BvbnNlVGltZTogbnVtYmVyO1xuICBsYXN0UmVzZXRUaW1lOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1haWxTZXJ2aWNlRXZlbnQge1xuICB0eXBlOiAnc3VjY2VzcycgfCAnZXJyb3InO1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbiAgcmVzcG9uc2VUaW1lOiBudW1iZXI7XG4gIGVycm9yPzoge1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICBjb2RlOiBzdHJpbmc7XG4gIH07XG59XG5cbmV4cG9ydCBjbGFzcyBFbWFpbFNlcnZpY2VNb25pdG9yIHtcbiAgcHJpdmF0ZSBzdGF0czogRW1haWxTZXJ2aWNlU3RhdHM7XG4gIHByaXZhdGUgcmVjZW50RXZlbnRzOiBFbWFpbFNlcnZpY2VFdmVudFtdID0gW107XG4gIHByaXZhdGUgcmVhZG9ubHkgbWF4RXZlbnRzID0gMTAwMDsgLy8gS2VlcCBsYXN0IDEwMDAgZXZlbnRzXG4gIHByaXZhdGUgcmVhZG9ubHkgcmVzZXRJbnRlcnZhbCA9IDI0ICogNjAgKiA2MCAqIDEwMDA7IC8vIDI0IGhvdXJzXG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5zdGF0cyA9IHtcbiAgICAgIHRvdGFsU2VudDogMCxcbiAgICAgIHRvdGFsRmFpbGVkOiAwLFxuICAgICAgcXVvdGFVc2VkOiAwLFxuICAgICAgcXVvdGFMaW1pdDogdGhpcy5nZXRRdW90YUxpbWl0KCksXG4gICAgICBlcnJvcnNCeVR5cGU6IHt9LFxuICAgICAgc3VjY2Vzc1JhdGU6IDEwMCxcbiAgICAgIGF2ZXJhZ2VSZXNwb25zZVRpbWU6IDAsXG4gICAgICBsYXN0UmVzZXRUaW1lOiBEYXRlLm5vdygpLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUmVjb3JkIGEgc3VjY2Vzc2Z1bCBlbWFpbCBzZW5kXG4gICAqL1xuICByZWNvcmRTdWNjZXNzKHJlc3BvbnNlVGltZTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5zdGF0cy50b3RhbFNlbnQrKztcbiAgICB0aGlzLnN0YXRzLnF1b3RhVXNlZCsrO1xuICAgIFxuICAgIGNvbnN0IGV2ZW50OiBFbWFpbFNlcnZpY2VFdmVudCA9IHtcbiAgICAgIHR5cGU6ICdzdWNjZXNzJyxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgIHJlc3BvbnNlVGltZSxcbiAgICB9O1xuICAgIFxuICAgIHRoaXMuYWRkRXZlbnQoZXZlbnQpO1xuICAgIHRoaXMudXBkYXRlU3RhdHMoKTtcbiAgICBcbiAgICAvLyBMb2cgc3VjY2VzcyBpbiBkZXZlbG9wbWVudFxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50Jykge1xuICAgICAgY29uc29sZS5sb2coYFtFTUFJTF9NT05JVE9SXSBFbWFpbCBzZW50IHN1Y2Nlc3NmdWxseSAoJHtyZXNwb25zZVRpbWV9bXMpYCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlY29yZCBhIGZhaWxlZCBlbWFpbCBzZW5kXG4gICAqL1xuICByZWNvcmRGYWlsdXJlKGVycm9yOiB7IG1lc3NhZ2U6IHN0cmluZzsgY29kZTogc3RyaW5nIH0sIHJlc3BvbnNlVGltZTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5zdGF0cy50b3RhbEZhaWxlZCsrO1xuICAgIFxuICAgIC8vIFVwZGF0ZSBlcnJvciBjb3VudHMgYnkgdHlwZVxuICAgIHRoaXMuc3RhdHMuZXJyb3JzQnlUeXBlW2Vycm9yLmNvZGVdID0gKHRoaXMuc3RhdHMuZXJyb3JzQnlUeXBlW2Vycm9yLmNvZGVdIHx8IDApICsgMTtcbiAgICBcbiAgICAvLyBVcGRhdGUgbGFzdCBlcnJvclxuICAgIHRoaXMuc3RhdHMubGFzdEVycm9yID0ge1xuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgIGNvZGU6IGVycm9yLmNvZGUsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgfTtcbiAgICBcbiAgICBjb25zdCBldmVudDogRW1haWxTZXJ2aWNlRXZlbnQgPSB7XG4gICAgICB0eXBlOiAnZXJyb3InLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgcmVzcG9uc2VUaW1lLFxuICAgICAgZXJyb3IsXG4gICAgfTtcbiAgICBcbiAgICB0aGlzLmFkZEV2ZW50KGV2ZW50KTtcbiAgICB0aGlzLnVwZGF0ZVN0YXRzKCk7XG4gICAgXG4gICAgLy8gTG9nIGVycm9yXG4gICAgY29uc29sZS5lcnJvcihgW0VNQUlMX01PTklUT1JdIEVtYWlsIHNlbmQgZmFpbGVkOiAke2Vycm9yLmNvZGV9IC0gJHtlcnJvci5tZXNzYWdlfSAoJHtyZXNwb25zZVRpbWV9bXMpYCk7XG4gICAgXG4gICAgLy8gQ2hlY2sgZm9yIHF1b3RhIGlzc3Vlc1xuICAgIGlmIChlcnJvci5jb2RlID09PSAnUVVPVEFfRVhDRUVERUQnKSB7XG4gICAgICB0aGlzLmhhbmRsZVF1b3RhRXhjZWVkZWQoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGN1cnJlbnQgc3RhdGlzdGljc1xuICAgKi9cbiAgZ2V0U3RhdHMoKTogRW1haWxTZXJ2aWNlU3RhdHMge1xuICAgIHRoaXMuY2hlY2tGb3JSZXNldCgpO1xuICAgIHJldHVybiB7IC4uLnRoaXMuc3RhdHMgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgcmVjZW50IGV2ZW50cyAobGFzdCBOIGV2ZW50cylcbiAgICovXG4gIGdldFJlY2VudEV2ZW50cyhsaW1pdDogbnVtYmVyID0gMTAwKTogRW1haWxTZXJ2aWNlRXZlbnRbXSB7XG4gICAgcmV0dXJuIHRoaXMucmVjZW50RXZlbnRzLnNsaWNlKC1saW1pdCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGVycm9yIHN1bW1hcnlcbiAgICovXG4gIGdldEVycm9yU3VtbWFyeSgpOiB7XG4gICAgdG90YWxFcnJvcnM6IG51bWJlcjtcbiAgICBlcnJvcnNCeVR5cGU6IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XG4gICAgcmVjZW50RXJyb3JzOiBFbWFpbFNlcnZpY2VFdmVudFtdO1xuICAgIGNyaXRpY2FsRXJyb3JzOiBFbWFpbFNlcnZpY2VFdmVudFtdO1xuICB9IHtcbiAgICBjb25zdCByZWNlbnRFcnJvcnMgPSB0aGlzLnJlY2VudEV2ZW50c1xuICAgICAgLmZpbHRlcihldmVudCA9PiBldmVudC50eXBlID09PSAnZXJyb3InKVxuICAgICAgLnNsaWNlKC01MCk7XG4gICAgXG4gICAgY29uc3QgY3JpdGljYWxFcnJvcnMgPSB0aGlzLnJlY2VudEV2ZW50c1xuICAgICAgLmZpbHRlcihldmVudCA9PiBcbiAgICAgICAgZXZlbnQudHlwZSA9PT0gJ2Vycm9yJyAmJiBcbiAgICAgICAgZXZlbnQuZXJyb3I/LmNvZGUgPT09ICdRVU9UQV9FWENFRURFRCdcbiAgICAgIClcbiAgICAgIC5zbGljZSgtMTApO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsRXJyb3JzOiB0aGlzLnN0YXRzLnRvdGFsRmFpbGVkLFxuICAgICAgZXJyb3JzQnlUeXBlOiB7IC4uLnRoaXMuc3RhdHMuZXJyb3JzQnlUeXBlIH0sXG4gICAgICByZWNlbnRFcnJvcnMsXG4gICAgICBjcml0aWNhbEVycm9ycyxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIHF1b3RhIGlzIGFwcHJvYWNoaW5nIGxpbWl0XG4gICAqL1xuICBpc1F1b3RhTmVhckxpbWl0KHRocmVzaG9sZDogbnVtYmVyID0gMC44KTogYm9vbGVhbiB7XG4gICAgaWYgKHRoaXMuc3RhdHMucXVvdGFMaW1pdCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiAodGhpcy5zdGF0cy5xdW90YVVzZWQgLyB0aGlzLnN0YXRzLnF1b3RhTGltaXQpID49IHRocmVzaG9sZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgcXVvdGEgdXNhZ2UgcGVyY2VudGFnZVxuICAgKi9cbiAgZ2V0UXVvdGFVc2FnZVBlcmNlbnRhZ2UoKTogbnVtYmVyIHtcbiAgICBpZiAodGhpcy5zdGF0cy5xdW90YUxpbWl0ID09PSAwKSByZXR1cm4gMDtcbiAgICByZXR1cm4gTWF0aC5yb3VuZCgodGhpcy5zdGF0cy5xdW90YVVzZWQgLyB0aGlzLnN0YXRzLnF1b3RhTGltaXQpICogMTAwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXNldCBkYWlseSBzdGF0aXN0aWNzIChjYWxsZWQgYXV0b21hdGljYWxseSlcbiAgICovXG4gIHJlc2V0RGFpbHlTdGF0cygpOiB2b2lkIHtcbiAgICBjb25zb2xlLmxvZygnW0VNQUlMX01PTklUT1JdIFJlc2V0dGluZyBkYWlseSBzdGF0aXN0aWNzJyk7XG4gICAgXG4gICAgdGhpcy5zdGF0cy50b3RhbFNlbnQgPSAwO1xuICAgIHRoaXMuc3RhdHMudG90YWxGYWlsZWQgPSAwO1xuICAgIHRoaXMuc3RhdHMucXVvdGFVc2VkID0gMDtcbiAgICB0aGlzLnN0YXRzLmVycm9yc0J5VHlwZSA9IHt9O1xuICAgIHRoaXMuc3RhdHMubGFzdFJlc2V0VGltZSA9IERhdGUubm93KCk7XG4gICAgXG4gICAgLy8gS2VlcCBvbmx5IHJlY2VudCBldmVudHMgKGxhc3QgMTAwKVxuICAgIHRoaXMucmVjZW50RXZlbnRzID0gdGhpcy5yZWNlbnRFdmVudHMuc2xpY2UoLTEwMCk7XG4gICAgXG4gICAgdGhpcy51cGRhdGVTdGF0cygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEZvcmNlIHJlc2V0IHN0YXRpc3RpY3MgKGZvciB0ZXN0aW5nIG9yIG1hbnVhbCByZXNldClcbiAgICovXG4gIGZvcmNlUmVzZXQoKTogdm9pZCB7XG4gICAgY29uc29sZS5sb2coJ1tFTUFJTF9NT05JVE9SXSBGb3JjZSByZXNldHRpbmcgc3RhdGlzdGljcycpO1xuICAgIHRoaXMucmVzZXREYWlseVN0YXRzKCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGhlYWx0aCBzdGF0dXNcbiAgICovXG4gIGdldEhlYWx0aFN0YXR1cygpOiB7XG4gICAgc3RhdHVzOiAnaGVhbHRoeScgfCAnd2FybmluZycgfCAnY3JpdGljYWwnO1xuICAgIGlzc3Vlczogc3RyaW5nW107XG4gICAgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXTtcbiAgfSB7XG4gICAgY29uc3QgaXNzdWVzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9uczogc3RyaW5nW10gPSBbXTtcbiAgICBsZXQgc3RhdHVzOiAnaGVhbHRoeScgfCAnd2FybmluZycgfCAnY3JpdGljYWwnID0gJ2hlYWx0aHknO1xuXG4gICAgLy8gQ2hlY2sgc3VjY2VzcyByYXRlXG4gICAgaWYgKHRoaXMuc3RhdHMuc3VjY2Vzc1JhdGUgPCA5NSkge1xuICAgICAgc3RhdHVzID0gJ3dhcm5pbmcnO1xuICAgICAgaXNzdWVzLnB1c2goYExvdyBzdWNjZXNzIHJhdGU6ICR7dGhpcy5zdGF0cy5zdWNjZXNzUmF0ZS50b0ZpeGVkKDEpfSVgKTtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdDaGVjayBlbWFpbCBzZXJ2aWNlIGNvbmZpZ3VyYXRpb24gYW5kIG5ldHdvcmsgY29ubmVjdGl2aXR5Jyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc3RhdHMuc3VjY2Vzc1JhdGUgPCA4MCkge1xuICAgICAgc3RhdHVzID0gJ2NyaXRpY2FsJztcbiAgICB9XG5cbiAgICAvLyBDaGVjayBxdW90YSB1c2FnZVxuICAgIGlmICh0aGlzLmlzUXVvdGFOZWFyTGltaXQoMC45KSkge1xuICAgICAgc3RhdHVzID0gc3RhdHVzID09PSAnY3JpdGljYWwnID8gJ2NyaXRpY2FsJyA6ICd3YXJuaW5nJztcbiAgICAgIGlzc3Vlcy5wdXNoKGBIaWdoIHF1b3RhIHVzYWdlOiAke3RoaXMuZ2V0UXVvdGFVc2FnZVBlcmNlbnRhZ2UoKX0lYCk7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnQ29uc2lkZXIgdXBncmFkaW5nIGVtYWlsIHNlcnZpY2UgcGxhbiBvciBpbXBsZW1lbnRpbmcgZW1haWwgdGhyb3R0bGluZycpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzUXVvdGFOZWFyTGltaXQoMC45NSkpIHtcbiAgICAgIHN0YXR1cyA9ICdjcml0aWNhbCc7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIHJlY2VudCBjcml0aWNhbCBlcnJvcnNcbiAgICBjb25zdCByZWNlbnRDcml0aWNhbEVycm9ycyA9IHRoaXMucmVjZW50RXZlbnRzXG4gICAgICAuZmlsdGVyKGV2ZW50ID0+IFxuICAgICAgICBldmVudC50eXBlID09PSAnZXJyb3InICYmIFxuICAgICAgICBldmVudC5lcnJvcj8uY29kZSA9PT0gJ1FVT1RBX0VYQ0VFREVEJyAmJlxuICAgICAgICBEYXRlLm5vdygpIC0gZXZlbnQudGltZXN0YW1wIDwgNjAgKiA2MCAqIDEwMDAgLy8gTGFzdCBob3VyXG4gICAgICApO1xuXG4gICAgaWYgKHJlY2VudENyaXRpY2FsRXJyb3JzLmxlbmd0aCA+IDApIHtcbiAgICAgIHN0YXR1cyA9ICdjcml0aWNhbCc7XG4gICAgICBpc3N1ZXMucHVzaCgnUXVvdGEgZXhjZWVkZWQgZXJyb3JzIGluIHRoZSBsYXN0IGhvdXInKTtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdJbW1lZGlhdGUgYXR0ZW50aW9uIHJlcXVpcmVkIC0gZW1haWwgc2VydmljZSBxdW90YSBleGNlZWRlZCcpO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGF2ZXJhZ2UgcmVzcG9uc2UgdGltZVxuICAgIGlmICh0aGlzLnN0YXRzLmF2ZXJhZ2VSZXNwb25zZVRpbWUgPiA1MDAwKSB7XG4gICAgICBzdGF0dXMgPSBzdGF0dXMgPT09ICdjcml0aWNhbCcgPyAnY3JpdGljYWwnIDogJ3dhcm5pbmcnO1xuICAgICAgaXNzdWVzLnB1c2goYEhpZ2ggcmVzcG9uc2UgdGltZTogJHt0aGlzLnN0YXRzLmF2ZXJhZ2VSZXNwb25zZVRpbWV9bXNgKTtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdDaGVjayBlbWFpbCBzZXJ2aWNlIHBlcmZvcm1hbmNlIGFuZCBuZXR3b3JrIGxhdGVuY3knKTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdGF0dXMsIGlzc3VlcywgcmVjb21tZW5kYXRpb25zIH07XG4gIH1cblxuICBwcml2YXRlIGFkZEV2ZW50KGV2ZW50OiBFbWFpbFNlcnZpY2VFdmVudCk6IHZvaWQge1xuICAgIHRoaXMucmVjZW50RXZlbnRzLnB1c2goZXZlbnQpO1xuICAgIFxuICAgIC8vIEtlZXAgb25seSB0aGUgbW9zdCByZWNlbnQgZXZlbnRzXG4gICAgaWYgKHRoaXMucmVjZW50RXZlbnRzLmxlbmd0aCA+IHRoaXMubWF4RXZlbnRzKSB7XG4gICAgICB0aGlzLnJlY2VudEV2ZW50cyA9IHRoaXMucmVjZW50RXZlbnRzLnNsaWNlKC10aGlzLm1heEV2ZW50cyk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVTdGF0cygpOiB2b2lkIHtcbiAgICBjb25zdCB0b3RhbCA9IHRoaXMuc3RhdHMudG90YWxTZW50ICsgdGhpcy5zdGF0cy50b3RhbEZhaWxlZDtcbiAgICB0aGlzLnN0YXRzLnN1Y2Nlc3NSYXRlID0gdG90YWwgPiAwID8gKHRoaXMuc3RhdHMudG90YWxTZW50IC8gdG90YWwpICogMTAwIDogMTAwO1xuICAgIFxuICAgIC8vIENhbGN1bGF0ZSBhdmVyYWdlIHJlc3BvbnNlIHRpbWUgZnJvbSByZWNlbnQgZXZlbnRzXG4gICAgY29uc3QgcmVjZW50RXZlbnRzID0gdGhpcy5yZWNlbnRFdmVudHMuc2xpY2UoLTEwMCk7XG4gICAgaWYgKHJlY2VudEV2ZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCB0b3RhbFRpbWUgPSByZWNlbnRFdmVudHMucmVkdWNlKChzdW0sIGV2ZW50KSA9PiBzdW0gKyBldmVudC5yZXNwb25zZVRpbWUsIDApO1xuICAgICAgdGhpcy5zdGF0cy5hdmVyYWdlUmVzcG9uc2VUaW1lID0gTWF0aC5yb3VuZCh0b3RhbFRpbWUgLyByZWNlbnRFdmVudHMubGVuZ3RoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGNoZWNrRm9yUmVzZXQoKTogdm9pZCB7XG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICBpZiAobm93IC0gdGhpcy5zdGF0cy5sYXN0UmVzZXRUaW1lID49IHRoaXMucmVzZXRJbnRlcnZhbCkge1xuICAgICAgdGhpcy5yZXNldERhaWx5U3RhdHMoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldFF1b3RhTGltaXQoKTogbnVtYmVyIHtcbiAgICAvLyBEZWZhdWx0IFJlc2VuZCBmcmVlIHRpZXIgbGltaXRzXG4gICAgLy8gVGhpcyBjb3VsZCBiZSBtYWRlIGNvbmZpZ3VyYWJsZSB2aWEgZW52aXJvbm1lbnQgdmFyaWFibGVzXG4gICAgY29uc3QgZGFpbHlMaW1pdCA9IHBhcnNlSW50KHByb2Nlc3MuZW52LkVNQUlMX0RBSUxZX1FVT1RBIHx8ICcxMDAnLCAxMCk7XG4gICAgcmV0dXJuIGRhaWx5TGltaXQ7XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZVF1b3RhRXhjZWVkZWQoKTogdm9pZCB7XG4gICAgY29uc29sZS5lcnJvcignW0VNQUlMX01PTklUT1JdIENSSVRJQ0FMOiBFbWFpbCBxdW90YSBleGNlZWRlZCEnKTtcbiAgICBcbiAgICAvLyBJbiBhIHByb2R1Y3Rpb24gc3lzdGVtLCB5b3UgbWlnaHQgd2FudCB0bzpcbiAgICAvLyAtIFNlbmQgYWxlcnRzIHRvIGFkbWluaXN0cmF0b3JzXG4gICAgLy8gLSBUZW1wb3JhcmlseSBkaXNhYmxlIGVtYWlsIHNlbmRpbmdcbiAgICAvLyAtIFN3aXRjaCB0byBhIGJhY2t1cCBlbWFpbCBzZXJ2aWNlXG4gICAgLy8gLSBMb2cgdG8gZXh0ZXJuYWwgbW9uaXRvcmluZyBzeXN0ZW1cbiAgICBcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgLy8gTG9nIGNyaXRpY2FsIGVycm9yIGZvciBleHRlcm5hbCBtb25pdG9yaW5nXG4gICAgICBjb25zb2xlLmVycm9yKCdbRU1BSUxfTU9OSVRPUl0gQUxFUlQ6IEVtYWlsIHNlcnZpY2UgcXVvdGEgZXhjZWVkZWQgLSBpbW1lZGlhdGUgYXR0ZW50aW9uIHJlcXVpcmVkJyk7XG4gICAgfVxuICB9XG59XG5cbi8vIEV4cG9ydCBzaW5nbGV0b24gaW5zdGFuY2VcbmV4cG9ydCBjb25zdCBlbWFpbFNlcnZpY2VNb25pdG9yID0gbmV3IEVtYWlsU2VydmljZU1vbml0b3IoKTtcblxuLy8gU2NoZWR1bGUgZGFpbHkgcmVzZXRcbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nKSB7XG4gIC8vIFJlc2V0IGF0IG1pZG5pZ2h0IFVUQ1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICBjb25zdCB0b21vcnJvdyA9IG5ldyBEYXRlKG5vdyk7XG4gIHRvbW9ycm93LnNldFVUQ0RhdGUodG9tb3Jyb3cuZ2V0VVRDRGF0ZSgpICsgMSk7XG4gIHRvbW9ycm93LnNldFVUQ0hvdXJzKDAsIDAsIDAsIDApO1xuICBcbiAgY29uc3QgbXNVbnRpbE1pZG5pZ2h0ID0gdG9tb3Jyb3cuZ2V0VGltZSgpIC0gbm93LmdldFRpbWUoKTtcbiAgXG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgIGVtYWlsU2VydmljZU1vbml0b3IucmVzZXREYWlseVN0YXRzKCk7XG4gICAgXG4gICAgLy8gVGhlbiByZXNldCBldmVyeSAyNCBob3Vyc1xuICAgIHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGVtYWlsU2VydmljZU1vbml0b3IucmVzZXREYWlseVN0YXRzKCk7XG4gICAgfSwgMjQgKiA2MCAqIDYwICogMTAwMCk7XG4gIH0sIG1zVW50aWxNaWRuaWdodCk7XG59Il0sIm5hbWVzIjpbIkVtYWlsU2VydmljZU1vbml0b3IiLCJlbWFpbFNlcnZpY2VNb25pdG9yIiwicmVjZW50RXZlbnRzIiwibWF4RXZlbnRzIiwicmVzZXRJbnRlcnZhbCIsInN0YXRzIiwidG90YWxTZW50IiwidG90YWxGYWlsZWQiLCJxdW90YVVzZWQiLCJxdW90YUxpbWl0IiwiZ2V0UXVvdGFMaW1pdCIsImVycm9yc0J5VHlwZSIsInN1Y2Nlc3NSYXRlIiwiYXZlcmFnZVJlc3BvbnNlVGltZSIsImxhc3RSZXNldFRpbWUiLCJEYXRlIiwibm93IiwicmVjb3JkU3VjY2VzcyIsInJlc3BvbnNlVGltZSIsImV2ZW50IiwidHlwZSIsInRpbWVzdGFtcCIsImFkZEV2ZW50IiwidXBkYXRlU3RhdHMiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJjb25zb2xlIiwibG9nIiwicmVjb3JkRmFpbHVyZSIsImVycm9yIiwiY29kZSIsImxhc3RFcnJvciIsIm1lc3NhZ2UiLCJoYW5kbGVRdW90YUV4Y2VlZGVkIiwiZ2V0U3RhdHMiLCJjaGVja0ZvclJlc2V0IiwiZ2V0UmVjZW50RXZlbnRzIiwibGltaXQiLCJzbGljZSIsImdldEVycm9yU3VtbWFyeSIsInJlY2VudEVycm9ycyIsImZpbHRlciIsImNyaXRpY2FsRXJyb3JzIiwidG90YWxFcnJvcnMiLCJpc1F1b3RhTmVhckxpbWl0IiwidGhyZXNob2xkIiwiZ2V0UXVvdGFVc2FnZVBlcmNlbnRhZ2UiLCJNYXRoIiwicm91bmQiLCJyZXNldERhaWx5U3RhdHMiLCJmb3JjZVJlc2V0IiwiZ2V0SGVhbHRoU3RhdHVzIiwiaXNzdWVzIiwicmVjb21tZW5kYXRpb25zIiwic3RhdHVzIiwicHVzaCIsInRvRml4ZWQiLCJyZWNlbnRDcml0aWNhbEVycm9ycyIsImxlbmd0aCIsInRvdGFsIiwidG90YWxUaW1lIiwicmVkdWNlIiwic3VtIiwiZGFpbHlMaW1pdCIsInBhcnNlSW50IiwiRU1BSUxfREFJTFlfUVVPVEEiLCJ0b21vcnJvdyIsInNldFVUQ0RhdGUiLCJnZXRVVENEYXRlIiwic2V0VVRDSG91cnMiLCJtc1VudGlsTWlkbmlnaHQiLCJnZXRUaW1lIiwic2V0VGltZW91dCIsInNldEludGVydmFsIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztRQTRCYUE7ZUFBQUE7O1FBK1FBQztlQUFBQTs7O1FBM1NOO0FBNEJBLE1BQU1EO0lBTVgsYUFBYzthQUpORSxlQUFvQyxFQUFFO2FBQzdCQyxZQUFZLE1BQU0sd0JBQXdCO2FBQzFDQyxnQkFBZ0IsS0FBSyxLQUFLLEtBQUssTUFBTSxXQUFXO1FBRy9ELElBQUksQ0FBQ0MsS0FBSyxHQUFHO1lBQ1hDLFdBQVc7WUFDWEMsYUFBYTtZQUNiQyxXQUFXO1lBQ1hDLFlBQVksSUFBSSxDQUFDQyxhQUFhO1lBQzlCQyxjQUFjLENBQUM7WUFDZkMsYUFBYTtZQUNiQyxxQkFBcUI7WUFDckJDLGVBQWVDLEtBQUtDLEdBQUc7UUFDekI7SUFDRjtJQUVBOztHQUVDLEdBQ0RDLGNBQWNDLFlBQW9CLEVBQVE7UUFDeEMsSUFBSSxDQUFDYixLQUFLLENBQUNDLFNBQVM7UUFDcEIsSUFBSSxDQUFDRCxLQUFLLENBQUNHLFNBQVM7UUFFcEIsTUFBTVcsUUFBMkI7WUFDL0JDLE1BQU07WUFDTkMsV0FBV04sS0FBS0MsR0FBRztZQUNuQkU7UUFDRjtRQUVBLElBQUksQ0FBQ0ksUUFBUSxDQUFDSDtRQUNkLElBQUksQ0FBQ0ksV0FBVztRQUVoQiw2QkFBNkI7UUFDN0IsSUFBSUMsUUFBUUMsR0FBRyxDQUFDQyxRQUFRLEtBQUssZUFB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