81b01a8aecfa22959480969337ca0835
'use client';
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return ImageUpload;
    }
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("react");
const _reactdropzone = require("react-dropzone");
function ImageUpload({ onImagesChange, onUpload, maxImages = 6, maxSizePerImage = 5 * 1024 * 1024, acceptedTypes = [
    'image/jpeg',
    'image/png',
    'image/webp'
], className = '', showUploadProgress = false }) {
    const [selectedFiles, setSelectedFiles] = (0, _react.useState)([]);
    const [previews, setPreviews] = (0, _react.useState)([]);
    const [errors, setErrors] = (0, _react.useState)([]);
    const [uploadProgress, setUploadProgress] = (0, _react.useState)({});
    const [isUploading, setIsUploading] = (0, _react.useState)(false);
    const fileInputRef = (0, _react.useRef)(null);
    // Manual click handler for better reliability
    const handleClick = (0, _react.useCallback)(()=>{
        if (fileInputRef.current && selectedFiles.length < maxImages) {
            fileInputRef.current.click();
        }
    }, [
        selectedFiles.length,
        maxImages
    ]);
    // Handle file selection
    const handleFiles = (0, _react.useCallback)((files)=>{
        const newErrors = [];
        const validFiles = [];
        const newPreviews = [];
        // Check if adding these files would exceed the limit
        if (selectedFiles.length + files.length > maxImages) {
            newErrors.push(`Maximum ${maxImages} images allowed`);
            return;
        }
        files.forEach((file)=>{
            // Check file type
            if (!acceptedTypes.includes(file.type)) {
                newErrors.push(`${file.name}: Invalid file type. Please use JPEG, PNG, or WebP.`);
                return;
            }
            // Check file size
            if (file.size > maxSizePerImage) {
                const maxSizeMB = Math.round(maxSizePerImage / (1024 * 1024));
                newErrors.push(`${file.name}: File too large. Maximum size is ${maxSizeMB}MB.`);
                return;
            }
            // Check for duplicates
            if (selectedFiles.some((existing)=>existing.name === file.name && existing.size === file.size)) {
                newErrors.push(`${file.name}: File already selected.`);
                return;
            }
            validFiles.push(file);
            // Create preview
            const reader = new FileReader();
            reader.onload = (e)=>{
                if (e.target?.result) {
                    newPreviews.push(e.target.result);
                    // Update previews when all files are processed
                    if (newPreviews.length === validFiles.length) {
                        setPreviews((prev)=>[
                                ...prev,
                                ...newPreviews
                            ]);
                    }
                }
            };
            reader.onerror = ()=>{
                newErrors.push(`${file.name}: Failed to read file.`);
                setErrors((prev)=>[
                        ...prev,
                        ...newErrors
                    ]);
            };
            reader.readAsDataURL(file);
        });
        if (validFiles.length > 0) {
            const updatedFiles = [
                ...selectedFiles,
                ...validFiles
            ];
            setSelectedFiles(updatedFiles);
            onImagesChange(updatedFiles);
        }
        setErrors(newErrors);
    }, [
        selectedFiles,
        maxImages,
        maxSizePerImage,
        acceptedTypes,
        onImagesChange
    ]);
    // Dropzone configuration
    const { getRootProps, getInputProps, isDragActive } = (0, _reactdropzone.useDropzone)({
        onDrop: handleFiles,
        accept: acceptedTypes.reduce((acc, type)=>({
                ...acc,
                [type]: []
            }), {}),
        maxFiles: maxImages - selectedFiles.length,
        disabled: selectedFiles.length >= maxImages
    });
    // Remove file
    const removeFile = (index)=>{
        const newFiles = selectedFiles.filter((_, i)=>i !== index);
        const newPreviews = previews.filter((_, i)=>i !== index);
        setSelectedFiles(newFiles);
        setPreviews(newPreviews);
        onImagesChange(newFiles);
        setErrors([]);
    };
    // Upload files
    const uploadFiles = async ()=>{
        if (!onUpload || selectedFiles.length === 0) return;
        setIsUploading(true);
        setErrors([]);
        try {
            // Simulate upload progress for each file
            selectedFiles.forEach((file, index)=>{
                const fileKey = `${file.name}-${index}`;
                setUploadProgress((prev)=>({
                        ...prev,
                        [fileKey]: 0
                    }));
                // Simulate progress
                const interval = setInterval(()=>{
                    setUploadProgress((prev)=>{
                        const currentProgress = prev[fileKey] || 0;
                        if (currentProgress >= 100) {
                            clearInterval(interval);
                            return prev;
                        }
                        return {
                            ...prev,
                            [fileKey]: Math.min(currentProgress + 10, 100)
                        };
                    });
                }, 100);
            });
            const uploadedUrls = await onUpload(selectedFiles);
            // Clear progress after successful upload
            setUploadProgress({});
        // Optionally clear files after upload
        // setSelectedFiles([]);
        // setPreviews([]);
        } catch (error) {
            setErrors([
                'Upload failed. Please try again.'
            ]);
        } finally{
            setIsUploading(false);
        }
    };
    // Clear all files
    const clearAll = ()=>{
        setSelectedFiles([]);
        setPreviews([]);
        onImagesChange([]);
        setErrors([]);
        setUploadProgress({});
        if (fileInputRef.current) {
            fileInputRef.current.value = '';
        }
    };
    // Format file size
    const formatFileSize = (bytes)=>{
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = [
            'Bytes',
            'KB',
            'MB',
            'GB'
        ];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    };
    return /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
        className: `space-y-4 ${className}`,
        children: [
            selectedFiles.length < maxImages && /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                ...getRootProps(),
                className: `border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors ${isDragActive ? 'border-primary-400 bg-primary-50' : 'border-gray-300 hover:border-gray-400 hover:bg-gray-50'}`,
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsx)("input", {
                        ...getInputProps(),
                        ref: fileInputRef
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                        className: "space-y-2",
                        children: [
                            /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                className: "text-4xl",
                                children: "\uD83D\uDCF7"
                            }),
                            isDragActive ? /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                                className: "text-primary-600 font-medium",
                                children: "Drop images here..."
                            }) : /*#__PURE__*/ (0, _jsxruntime.jsxs)(_jsxruntime.Fragment, {
                                children: [
                                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("p", {
                                        className: "text-gray-600",
                                        children: [
                                            /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                                                type: "button",
                                                onClick: handleClick,
                                                className: "font-medium text-primary-600 hover:text-primary-700 underline focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 rounded",
                                                "aria-label": "Click to select images for upload",
                                                title: "Select images to upload",
                                                children: "Click to upload"
                                            }),
                                            ' ',
                                            "or drag and drop"
                                        ]
                                    }),
                                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("p", {
                                        className: "text-sm text-gray-500",
                                        children: [
                                            "JPEG, PNG, or WebP up to ",
                                            Math.round(maxSizePerImage / (1024 * 1024)),
                                            "MB each"
                                        ]
                                    }),
                                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("p", {
                                        className: "text-xs text-gray-400",
                                        children: [
                                            selectedFiles.length,
                                            " of ",
                                            maxImages,
                                            " images selected"
                                        ]
                                    })
                                ]
                            })
                        ]
                    })
                ]
            }),
            errors.length > 0 && /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                className: "bg-red-50 border border-red-200 rounded-lg p-3",
                children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                    className: "flex items-start",
                    children: [
                        /*#__PURE__*/ (0, _jsxruntime.jsx)("svg", {
                            className: "w-5 h-5 text-red-400 mt-0.5 mr-2 flex-shrink-0",
                            fill: "currentColor",
                            viewBox: "0 0 20 20",
                            children: /*#__PURE__*/ (0, _jsxruntime.jsx)("path", {
                                fillRule: "evenodd",
                                d: "M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",
                                clipRule: "evenodd"
                            })
                        }),
                        /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                            className: "flex-1",
                            children: [
                                /*#__PURE__*/ (0, _jsxruntime.jsx)("h4", {
                                    className: "text-sm font-medium text-red-800 mb-1",
                                    children: "Upload Errors"
                                }),
                                /*#__PURE__*/ (0, _jsxruntime.jsx)("ul", {
                                    className: "text-sm text-red-700 space-y-1",
                                    children: errors.map((error, index)=>/*#__PURE__*/ (0, _jsxruntime.jsxs)("li", {
                                            children: [
                                                "â€¢ ",
                                                error
                                            ]
                                        }, index))
                                })
                            ]
                        })
                    ]
                })
            }),
            selectedFiles.length > 0 && /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                className: "space-y-3",
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                        className: "flex items-center justify-between",
                        children: [
                            /*#__PURE__*/ (0, _jsxruntime.jsxs)("h4", {
                                className: "text-sm font-medium text-gray-700",
                                children: [
                                    "Selected Images (",
                                    selectedFiles.length,
                                    ")"
                                ]
                            }),
                            /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                className: "flex items-center space-x-2",
                                children: [
                                    showUploadProgress && onUpload && selectedFiles.length > 0 && /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                                        type: "button",
                                        onClick: uploadFiles,
                                        disabled: isUploading,
                                        className: `px-3 py-1 text-sm rounded ${isUploading ? 'bg-gray-300 text-gray-500 cursor-not-allowed' : 'bg-primary-600 text-white hover:bg-primary-700'}`,
                                        "aria-label": isUploading ? 'Uploading images' : 'Upload selected images',
                                        title: isUploading ? 'Uploading images...' : 'Upload selected images',
                                        children: isUploading ? /*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
                                            children: /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                                                role: "status",
                                                "aria-live": "polite",
                                                children: "Uploading..."
                                            })
                                        }) : 'Upload'
                                    }),
                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                                        type: "button",
                                        onClick: clearAll,
                                        className: "text-sm text-red-600 hover:text-red-700",
                                        disabled: isUploading,
                                        "aria-label": "Clear all selected images",
                                        title: "Remove all selected images",
                                        children: "Clear All"
                                    })
                                ]
                            })
                        ]
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                        className: "grid grid-cols-2 sm:grid-cols-3 gap-3",
                        children: selectedFiles.map((file, index)=>/*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                className: "relative group",
                                children: [
                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                        className: "aspect-square rounded-lg overflow-hidden bg-gray-100",
                                        children: previews[index] ? /*#__PURE__*/ (0, _jsxruntime.jsx)("img", {
                                            src: previews[index],
                                            alt: `Preview ${index + 1}`,
                                            className: "w-full h-full object-cover"
                                        }) : /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                            className: "w-full h-full flex items-center justify-center",
                                            children: [
                                                /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                    className: "animate-spin rounded-full h-6 w-6 border-b-2 border-primary-500",
                                                    role: "status",
                                                    "aria-label": "Loading image preview"
                                                }),
                                                /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                                                    className: "sr-only",
                                                    children: "Loading image preview..."
                                                })
                                            ]
                                        })
                                    }),
                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                                        type: "button",
                                        onClick: ()=>removeFile(index),
                                        className: "absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",
                                        title: "Remove image",
                                        "aria-label": `Remove image ${index + 1}`,
                                        children: /*#__PURE__*/ (0, _jsxruntime.jsx)("svg", {
                                            className: "w-3 h-3",
                                            fill: "currentColor",
                                            viewBox: "0 0 20 20",
                                            children: /*#__PURE__*/ (0, _jsxruntime.jsx)("path", {
                                                fillRule: "evenodd",
                                                d: "M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",
                                                clipRule: "evenodd"
                                            })
                                        })
                                    }),
                                    index === 0 && /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                        className: "absolute bottom-1 left-1 bg-primary-500 text-white text-xs px-1 py-0.5 rounded",
                                        children: "Primary"
                                    }),
                                    index !== 0 && /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                                        type: "button",
                                        onClick: ()=>{
                                            // Move this image to the front
                                            const newFiles = [
                                                ...selectedFiles
                                            ];
                                            const newPreviews = [
                                                ...previews
                                            ];
                                            const selectedFile = newFiles[index];
                                            const selectedPreview = newPreviews[index];
                                            // Remove from current position
                                            newFiles.splice(index, 1);
                                            newPreviews.splice(index, 1);
                                            // Add to front
                                            newFiles.unshift(selectedFile);
                                            newPreviews.unshift(selectedPreview);
                                            setSelectedFiles(newFiles);
                                            setPreviews(newPreviews);
                                            onImagesChange(newFiles);
                                        },
                                        className: "absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs px-1 py-0.5 rounded opacity-0 group-hover:opacity-100 transition-opacity",
                                        title: "Set as primary image",
                                        "aria-label": `Set image ${index + 1} as primary`,
                                        children: "Set Primary"
                                    }),
                                    showUploadProgress && uploadProgress[`${file.name}-${index}`] !== undefined && /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                        className: "absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",
                                        children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                            className: "text-white text-center",
                                            children: [
                                                /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                    className: "w-8 h-8 border-2 border-white border-t-transparent rounded-full animate-spin mx-auto mb-1"
                                                }),
                                                /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                                    className: "text-xs",
                                                    children: [
                                                        uploadProgress[`${file.name}-${index}`],
                                                        "%"
                                                    ]
                                                })
                                            ]
                                        })
                                    }),
                                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                        className: "mt-1 text-xs text-gray-500 truncate",
                                        children: [
                                            /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                className: "truncate",
                                                title: file.name,
                                                children: file.name
                                            }),
                                            /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                children: formatFileSize(file.size)
                                            })
                                        ]
                                    })
                                ]
                            }, index))
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                        className: "text-xs text-gray-500 bg-gray-50 rounded p-2",
                        children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("p", {
                            children: [
                                /*#__PURE__*/ (0, _jsxruntime.jsx)("strong", {
                                    children: "Tip:"
                                }),
                                " The first image will be used as the primary photo for your plant card."
                            ]
                        })
                    })
                ]
            })
        ]
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdGVmYW5iZWtrZXIvcHJvamVjdHMvZmFuY3ktcGxhbnRpZXMvc3JjL2NvbXBvbmVudHMvc2hhcmVkL0ltYWdlVXBsb2FkLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGNsaWVudCc7XG5cbmltcG9ydCB7IHVzZVN0YXRlLCB1c2VDYWxsYmFjaywgdXNlUmVmIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgdXNlRHJvcHpvbmUgfSBmcm9tICdyZWFjdC1kcm9wem9uZSc7XG5cbmludGVyZmFjZSBJbWFnZVVwbG9hZFByb3BzIHtcbiAgb25JbWFnZXNDaGFuZ2U6IChmaWxlczogRmlsZVtdKSA9PiB2b2lkO1xuICBvblVwbG9hZD86IChmaWxlczogRmlsZVtdKSA9PiBQcm9taXNlPHN0cmluZ1tdPjsgLy8gUmV0dXJucyBVUkxzIG9mIHVwbG9hZGVkIGltYWdlc1xuICBtYXhJbWFnZXM/OiBudW1iZXI7XG4gIG1heFNpemVQZXJJbWFnZT86IG51bWJlcjsgLy8gaW4gYnl0ZXNcbiAgYWNjZXB0ZWRUeXBlcz86IHN0cmluZ1tdO1xuICBjbGFzc05hbWU/OiBzdHJpbmc7XG4gIHNob3dVcGxvYWRQcm9ncmVzcz86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIEltYWdlVXBsb2FkKHtcbiAgb25JbWFnZXNDaGFuZ2UsXG4gIG9uVXBsb2FkLFxuICBtYXhJbWFnZXMgPSA2LFxuICBtYXhTaXplUGVySW1hZ2UgPSA1ICogMTAyNCAqIDEwMjQsIC8vIDVNQiBkZWZhdWx0XG4gIGFjY2VwdGVkVHlwZXMgPSBbJ2ltYWdlL2pwZWcnLCAnaW1hZ2UvcG5nJywgJ2ltYWdlL3dlYnAnXSxcbiAgY2xhc3NOYW1lID0gJycsXG4gIHNob3dVcGxvYWRQcm9ncmVzcyA9IGZhbHNlLFxufTogSW1hZ2VVcGxvYWRQcm9wcykge1xuICBjb25zdCBbc2VsZWN0ZWRGaWxlcywgc2V0U2VsZWN0ZWRGaWxlc10gPSB1c2VTdGF0ZTxGaWxlW10+KFtdKTtcbiAgY29uc3QgW3ByZXZpZXdzLCBzZXRQcmV2aWV3c10gPSB1c2VTdGF0ZTxzdHJpbmdbXT4oW10pO1xuICBjb25zdCBbZXJyb3JzLCBzZXRFcnJvcnNdID0gdXNlU3RhdGU8c3RyaW5nW10+KFtdKTtcbiAgY29uc3QgW3VwbG9hZFByb2dyZXNzLCBzZXRVcGxvYWRQcm9ncmVzc10gPSB1c2VTdGF0ZTx7IFtrZXk6IHN0cmluZ106IG51bWJlciB9Pih7fSk7XG4gIGNvbnN0IFtpc1VwbG9hZGluZywgc2V0SXNVcGxvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBmaWxlSW5wdXRSZWYgPSB1c2VSZWY8SFRNTElucHV0RWxlbWVudD4obnVsbCk7XG5cbiAgLy8gTWFudWFsIGNsaWNrIGhhbmRsZXIgZm9yIGJldHRlciByZWxpYWJpbGl0eVxuICBjb25zdCBoYW5kbGVDbGljayA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBpZiAoZmlsZUlucHV0UmVmLmN1cnJlbnQgJiYgc2VsZWN0ZWRGaWxlcy5sZW5ndGggPCBtYXhJbWFnZXMpIHtcbiAgICAgIGZpbGVJbnB1dFJlZi5jdXJyZW50LmNsaWNrKCk7XG4gICAgfVxuICB9LCBbc2VsZWN0ZWRGaWxlcy5sZW5ndGgsIG1heEltYWdlc10pO1xuXG4gIC8vIEhhbmRsZSBmaWxlIHNlbGVjdGlvblxuICBjb25zdCBoYW5kbGVGaWxlcyA9IHVzZUNhbGxiYWNrKChmaWxlczogRmlsZVtdKSA9PiB7XG4gICAgY29uc3QgbmV3RXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IHZhbGlkRmlsZXM6IEZpbGVbXSA9IFtdO1xuICAgIGNvbnN0IG5ld1ByZXZpZXdzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgLy8gQ2hlY2sgaWYgYWRkaW5nIHRoZXNlIGZpbGVzIHdvdWxkIGV4Y2VlZCB0aGUgbGltaXRcbiAgICBpZiAoc2VsZWN0ZWRGaWxlcy5sZW5ndGggKyBmaWxlcy5sZW5ndGggPiBtYXhJbWFnZXMpIHtcbiAgICAgIG5ld0Vycm9ycy5wdXNoKGBNYXhpbXVtICR7bWF4SW1hZ2VzfSBpbWFnZXMgYWxsb3dlZGApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGZpbGVzLmZvckVhY2goKGZpbGUpID0+IHtcbiAgICAgIC8vIENoZWNrIGZpbGUgdHlwZVxuICAgICAgaWYgKCFhY2NlcHRlZFR5cGVzLmluY2x1ZGVzKGZpbGUudHlwZSkpIHtcbiAgICAgICAgbmV3RXJyb3JzLnB1c2goYCR7ZmlsZS5uYW1lfTogSW52YWxpZCBmaWxlIHR5cGUuIFBsZWFzZSB1c2UgSlBFRywgUE5HLCBvciBXZWJQLmApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGZpbGUgc2l6ZVxuICAgICAgaWYgKGZpbGUuc2l6ZSA+IG1heFNpemVQZXJJbWFnZSkge1xuICAgICAgICBjb25zdCBtYXhTaXplTUIgPSBNYXRoLnJvdW5kKG1heFNpemVQZXJJbWFnZSAvICgxMDI0ICogMTAyNCkpO1xuICAgICAgICBuZXdFcnJvcnMucHVzaChgJHtmaWxlLm5hbWV9OiBGaWxlIHRvbyBsYXJnZS4gTWF4aW11bSBzaXplIGlzICR7bWF4U2l6ZU1CfU1CLmApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGZvciBkdXBsaWNhdGVzXG4gICAgICBpZiAoc2VsZWN0ZWRGaWxlcy5zb21lKGV4aXN0aW5nID0+IGV4aXN0aW5nLm5hbWUgPT09IGZpbGUubmFtZSAmJiBleGlzdGluZy5zaXplID09PSBmaWxlLnNpemUpKSB7XG4gICAgICAgIG5ld0Vycm9ycy5wdXNoKGAke2ZpbGUubmFtZX06IEZpbGUgYWxyZWFkeSBzZWxlY3RlZC5gKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YWxpZEZpbGVzLnB1c2goZmlsZSk7XG4gICAgICBcbiAgICAgIC8vIENyZWF0ZSBwcmV2aWV3XG4gICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgcmVhZGVyLm9ubG9hZCA9IChlKSA9PiB7XG4gICAgICAgIGlmIChlLnRhcmdldD8ucmVzdWx0KSB7XG4gICAgICAgICAgbmV3UHJldmlld3MucHVzaChlLnRhcmdldC5yZXN1bHQgYXMgc3RyaW5nKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBVcGRhdGUgcHJldmlld3Mgd2hlbiBhbGwgZmlsZXMgYXJlIHByb2Nlc3NlZFxuICAgICAgICAgIGlmIChuZXdQcmV2aWV3cy5sZW5ndGggPT09IHZhbGlkRmlsZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBzZXRQcmV2aWV3cyhwcmV2ID0+IFsuLi5wcmV2LCAuLi5uZXdQcmV2aWV3c10pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHJlYWRlci5vbmVycm9yID0gKCkgPT4ge1xuICAgICAgICBuZXdFcnJvcnMucHVzaChgJHtmaWxlLm5hbWV9OiBGYWlsZWQgdG8gcmVhZCBmaWxlLmApO1xuICAgICAgICBzZXRFcnJvcnMocHJldiA9PiBbLi4ucHJldiwgLi4ubmV3RXJyb3JzXSk7XG4gICAgICB9O1xuICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7XG4gICAgfSk7XG5cbiAgICBpZiAodmFsaWRGaWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCB1cGRhdGVkRmlsZXMgPSBbLi4uc2VsZWN0ZWRGaWxlcywgLi4udmFsaWRGaWxlc107XG4gICAgICBzZXRTZWxlY3RlZEZpbGVzKHVwZGF0ZWRGaWxlcyk7XG4gICAgICBvbkltYWdlc0NoYW5nZSh1cGRhdGVkRmlsZXMpO1xuICAgIH1cblxuICAgIHNldEVycm9ycyhuZXdFcnJvcnMpO1xuICB9LCBbc2VsZWN0ZWRGaWxlcywgbWF4SW1hZ2VzLCBtYXhTaXplUGVySW1hZ2UsIGFjY2VwdGVkVHlwZXMsIG9uSW1hZ2VzQ2hhbmdlXSk7XG5cbiAgLy8gRHJvcHpvbmUgY29uZmlndXJhdGlvblxuICBjb25zdCB7IGdldFJvb3RQcm9wcywgZ2V0SW5wdXRQcm9wcywgaXNEcmFnQWN0aXZlIH0gPSB1c2VEcm9wem9uZSh7XG4gICAgb25Ecm9wOiBoYW5kbGVGaWxlcyxcbiAgICBhY2NlcHQ6IGFjY2VwdGVkVHlwZXMucmVkdWNlKChhY2MsIHR5cGUpID0+ICh7IC4uLmFjYywgW3R5cGVdOiBbXSB9KSwge30pLFxuICAgIG1heEZpbGVzOiBtYXhJbWFnZXMgLSBzZWxlY3RlZEZpbGVzLmxlbmd0aCxcbiAgICBkaXNhYmxlZDogc2VsZWN0ZWRGaWxlcy5sZW5ndGggPj0gbWF4SW1hZ2VzLFxuICB9KTtcblxuICAvLyBSZW1vdmUgZmlsZVxuICBjb25zdCByZW1vdmVGaWxlID0gKGluZGV4OiBudW1iZXIpID0+IHtcbiAgICBjb25zdCBuZXdGaWxlcyA9IHNlbGVjdGVkRmlsZXMuZmlsdGVyKChfLCBpKSA9PiBpICE9PSBpbmRleCk7XG4gICAgY29uc3QgbmV3UHJldmlld3MgPSBwcmV2aWV3cy5maWx0ZXIoKF8sIGkpID0+IGkgIT09IGluZGV4KTtcbiAgICBcbiAgICBzZXRTZWxlY3RlZEZpbGVzKG5ld0ZpbGVzKTtcbiAgICBzZXRQcmV2aWV3cyhuZXdQcmV2aWV3cyk7XG4gICAgb25JbWFnZXNDaGFuZ2UobmV3RmlsZXMpO1xuICAgIHNldEVycm9ycyhbXSk7XG4gIH07XG5cbiAgLy8gVXBsb2FkIGZpbGVzXG4gIGNvbnN0IHVwbG9hZEZpbGVzID0gYXN5bmMgKCkgPT4ge1xuICAgIGlmICghb25VcGxvYWQgfHwgc2VsZWN0ZWRGaWxlcy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgIHNldElzVXBsb2FkaW5nKHRydWUpO1xuICAgIHNldEVycm9ycyhbXSk7XG5cbiAgICB0cnkge1xuICAgICAgLy8gU2ltdWxhdGUgdXBsb2FkIHByb2dyZXNzIGZvciBlYWNoIGZpbGVcbiAgICAgIHNlbGVjdGVkRmlsZXMuZm9yRWFjaCgoZmlsZSwgaW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgZmlsZUtleSA9IGAke2ZpbGUubmFtZX0tJHtpbmRleH1gO1xuICAgICAgICBzZXRVcGxvYWRQcm9ncmVzcyhwcmV2ID0+ICh7IC4uLnByZXYsIFtmaWxlS2V5XTogMCB9KSk7XG4gICAgICAgIFxuICAgICAgICAvLyBTaW11bGF0ZSBwcm9ncmVzc1xuICAgICAgICBjb25zdCBpbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICBzZXRVcGxvYWRQcm9ncmVzcyhwcmV2ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRQcm9ncmVzcyA9IHByZXZbZmlsZUtleV0gfHwgMDtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UHJvZ3Jlc3MgPj0gMTAwKSB7XG4gICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICAgICAgICAgICAgICByZXR1cm4gcHJldjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7IC4uLnByZXYsIFtmaWxlS2V5XTogTWF0aC5taW4oY3VycmVudFByb2dyZXNzICsgMTAsIDEwMCkgfTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSwgMTAwKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB1cGxvYWRlZFVybHMgPSBhd2FpdCBvblVwbG9hZChzZWxlY3RlZEZpbGVzKTtcbiAgICAgIFxuICAgICAgLy8gQ2xlYXIgcHJvZ3Jlc3MgYWZ0ZXIgc3VjY2Vzc2Z1bCB1cGxvYWRcbiAgICAgIHNldFVwbG9hZFByb2dyZXNzKHt9KTtcbiAgICAgIFxuICAgICAgLy8gT3B0aW9uYWxseSBjbGVhciBmaWxlcyBhZnRlciB1cGxvYWRcbiAgICAgIC8vIHNldFNlbGVjdGVkRmlsZXMoW10pO1xuICAgICAgLy8gc2V0UHJldmlld3MoW10pO1xuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHNldEVycm9ycyhbJ1VwbG9hZCBmYWlsZWQuIFBsZWFzZSB0cnkgYWdhaW4uJ10pO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRJc1VwbG9hZGluZyhmYWxzZSk7XG4gICAgfVxuICB9O1xuXG4gIC8vIENsZWFyIGFsbCBmaWxlc1xuICBjb25zdCBjbGVhckFsbCA9ICgpID0+IHtcbiAgICBzZXRTZWxlY3RlZEZpbGVzKFtdKTtcbiAgICBzZXRQcmV2aWV3cyhbXSk7XG4gICAgb25JbWFnZXNDaGFuZ2UoW10pO1xuICAgIHNldEVycm9ycyhbXSk7XG4gICAgc2V0VXBsb2FkUHJvZ3Jlc3Moe30pO1xuICAgIGlmIChmaWxlSW5wdXRSZWYuY3VycmVudCkge1xuICAgICAgZmlsZUlucHV0UmVmLmN1cnJlbnQudmFsdWUgPSAnJztcbiAgICB9XG4gIH07XG5cbiAgLy8gRm9ybWF0IGZpbGUgc2l6ZVxuICBjb25zdCBmb3JtYXRGaWxlU2l6ZSA9IChieXRlczogbnVtYmVyKTogc3RyaW5nID0+IHtcbiAgICBpZiAoYnl0ZXMgPT09IDApIHJldHVybiAnMCBCeXRlcyc7XG4gICAgY29uc3QgayA9IDEwMjQ7XG4gICAgY29uc3Qgc2l6ZXMgPSBbJ0J5dGVzJywgJ0tCJywgJ01CJywgJ0dCJ107XG4gICAgY29uc3QgaSA9IE1hdGguZmxvb3IoTWF0aC5sb2coYnl0ZXMpIC8gTWF0aC5sb2coaykpO1xuICAgIHJldHVybiBwYXJzZUZsb2F0KChieXRlcyAvIE1hdGgucG93KGssIGkpKS50b0ZpeGVkKDIpKSArICcgJyArIHNpemVzW2ldO1xuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9e2BzcGFjZS15LTQgJHtjbGFzc05hbWV9YH0+XG4gICAgICB7LyogVXBsb2FkIEFyZWEgKi99XG4gICAgICB7c2VsZWN0ZWRGaWxlcy5sZW5ndGggPCBtYXhJbWFnZXMgJiYgKFxuICAgICAgICA8ZGl2XG4gICAgICAgICAgey4uLmdldFJvb3RQcm9wcygpfVxuICAgICAgICAgIGNsYXNzTmFtZT17YGJvcmRlci0yIGJvcmRlci1kYXNoZWQgcm91bmRlZC1sZyBwLTYgdGV4dC1jZW50ZXIgY3Vyc29yLXBvaW50ZXIgdHJhbnNpdGlvbi1jb2xvcnMgJHtcbiAgICAgICAgICAgIGlzRHJhZ0FjdGl2ZVxuICAgICAgICAgICAgICA/ICdib3JkZXItcHJpbWFyeS00MDAgYmctcHJpbWFyeS01MCdcbiAgICAgICAgICAgICAgOiAnYm9yZGVyLWdyYXktMzAwIGhvdmVyOmJvcmRlci1ncmF5LTQwMCBob3ZlcjpiZy1ncmF5LTUwJ1xuICAgICAgICAgIH1gfVxuICAgICAgICA+XG4gICAgICAgICAgPGlucHV0IHsuLi5nZXRJbnB1dFByb3BzKCl9IHJlZj17ZmlsZUlucHV0UmVmfSAvPlxuICAgICAgICAgIFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0yXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtNHhsXCI+8J+TtzwvZGl2PlxuICAgICAgICAgICAgXG4gICAgICAgICAgICB7aXNEcmFnQWN0aXZlID8gKFxuICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXByaW1hcnktNjAwIGZvbnQtbWVkaXVtXCI+RHJvcCBpbWFnZXMgaGVyZS4uLjwvcD5cbiAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1ncmF5LTYwMFwiPlxuICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlQ2xpY2t9XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZvbnQtbWVkaXVtIHRleHQtcHJpbWFyeS02MDAgaG92ZXI6dGV4dC1wcmltYXJ5LTcwMCB1bmRlcmxpbmUgZm9jdXM6b3V0bGluZS1ub25lIGZvY3VzOnJpbmctMiBmb2N1czpyaW5nLXByaW1hcnktNTAwIGZvY3VzOnJpbmctb2Zmc2V0LTIgcm91bmRlZFwiXG4gICAgICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJDbGljayB0byBzZWxlY3QgaW1hZ2VzIGZvciB1cGxvYWRcIlxuICAgICAgICAgICAgICAgICAgICB0aXRsZT1cIlNlbGVjdCBpbWFnZXMgdG8gdXBsb2FkXCJcbiAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgQ2xpY2sgdG8gdXBsb2FkXG4gICAgICAgICAgICAgICAgICA8L2J1dHRvbj57JyAnfVxuICAgICAgICAgICAgICAgICAgb3IgZHJhZyBhbmQgZHJvcFxuICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtZ3JheS01MDBcIj5cbiAgICAgICAgICAgICAgICAgIEpQRUcsIFBORywgb3IgV2ViUCB1cCB0byB7TWF0aC5yb3VuZChtYXhTaXplUGVySW1hZ2UgLyAoMTAyNCAqIDEwMjQpKX1NQiBlYWNoXG4gICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQteHMgdGV4dC1ncmF5LTQwMFwiPlxuICAgICAgICAgICAgICAgICAge3NlbGVjdGVkRmlsZXMubGVuZ3RofSBvZiB7bWF4SW1hZ2VzfSBpbWFnZXMgc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICA8L3A+XG4gICAgICAgICAgICAgIDwvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICApfVxuXG4gICAgICB7LyogRXJyb3IgTWVzc2FnZXMgKi99XG4gICAgICB7ZXJyb3JzLmxlbmd0aCA+IDAgJiYgKFxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJnLXJlZC01MCBib3JkZXIgYm9yZGVyLXJlZC0yMDAgcm91bmRlZC1sZyBwLTNcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtc3RhcnRcIj5cbiAgICAgICAgICAgIDxzdmcgY2xhc3NOYW1lPVwidy01IGgtNSB0ZXh0LXJlZC00MDAgbXQtMC41IG1yLTIgZmxleC1zaHJpbmstMFwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIiB2aWV3Qm94PVwiMCAwIDIwIDIwXCI+XG4gICAgICAgICAgICAgIDxwYXRoIGZpbGxSdWxlPVwiZXZlbm9kZFwiIGQ9XCJNMTggMTBhOCA4IDAgMTEtMTYgMCA4IDggMCAwMTE2IDB6bS03IDRhMSAxIDAgMTEtMiAwIDEgMSAwIDAxMiAwem0tMS05YTEgMSAwIDAwLTEgMXY0YTEgMSAwIDEwMiAwVjZhMSAxIDAgMDAtMS0xelwiIGNsaXBSdWxlPVwiZXZlbm9kZFwiIC8+XG4gICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xXCI+XG4gICAgICAgICAgICAgIDxoNCBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtcmVkLTgwMCBtYi0xXCI+VXBsb2FkIEVycm9yczwvaDQ+XG4gICAgICAgICAgICAgIDx1bCBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtcmVkLTcwMCBzcGFjZS15LTFcIj5cbiAgICAgICAgICAgICAgICB7ZXJyb3JzLm1hcCgoZXJyb3IsIGluZGV4KSA9PiAoXG4gICAgICAgICAgICAgICAgICA8bGkga2V5PXtpbmRleH0+4oCiIHtlcnJvcn08L2xpPlxuICAgICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgICA8L3VsPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgKX1cblxuICAgICAgey8qIFNlbGVjdGVkIEltYWdlcyBQcmV2aWV3ICovfVxuICAgICAge3NlbGVjdGVkRmlsZXMubGVuZ3RoID4gMCAmJiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0zXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW5cIj5cbiAgICAgICAgICAgIDxoNCBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtZ3JheS03MDBcIj5cbiAgICAgICAgICAgICAgU2VsZWN0ZWQgSW1hZ2VzICh7c2VsZWN0ZWRGaWxlcy5sZW5ndGh9KVxuICAgICAgICAgICAgPC9oND5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgc3BhY2UteC0yXCI+XG4gICAgICAgICAgICAgIHtzaG93VXBsb2FkUHJvZ3Jlc3MgJiYgb25VcGxvYWQgJiYgc2VsZWN0ZWRGaWxlcy5sZW5ndGggPiAwICYmIChcbiAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3VwbG9hZEZpbGVzfVxuICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2lzVXBsb2FkaW5nfVxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgcHgtMyBweS0xIHRleHQtc20gcm91bmRlZCAke1xuICAgICAgICAgICAgICAgICAgICBpc1VwbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgID8gJ2JnLWdyYXktMzAwIHRleHQtZ3JheS01MDAgY3Vyc29yLW5vdC1hbGxvd2VkJ1xuICAgICAgICAgICAgICAgICAgICAgIDogJ2JnLXByaW1hcnktNjAwIHRleHQtd2hpdGUgaG92ZXI6YmctcHJpbWFyeS03MDAnXG4gICAgICAgICAgICAgICAgICB9YH1cbiAgICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9e2lzVXBsb2FkaW5nID8gJ1VwbG9hZGluZyBpbWFnZXMnIDogJ1VwbG9hZCBzZWxlY3RlZCBpbWFnZXMnfVxuICAgICAgICAgICAgICAgICAgdGl0bGU9e2lzVXBsb2FkaW5nID8gJ1VwbG9hZGluZyBpbWFnZXMuLi4nIDogJ1VwbG9hZCBzZWxlY3RlZCBpbWFnZXMnfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIHtpc1VwbG9hZGluZyA/IChcbiAgICAgICAgICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAgICAgICAgICA8c3BhbiByb2xlPVwic3RhdHVzXCIgYXJpYS1saXZlPVwicG9saXRlXCI+VXBsb2FkaW5nLi4uPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8Lz5cbiAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICdVcGxvYWQnXG4gICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgICAgICAgICAgb25DbGljaz17Y2xlYXJBbGx9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LXJlZC02MDAgaG92ZXI6dGV4dC1yZWQtNzAwXCJcbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17aXNVcGxvYWRpbmd9XG4gICAgICAgICAgICAgICAgYXJpYS1sYWJlbD1cIkNsZWFyIGFsbCBzZWxlY3RlZCBpbWFnZXNcIlxuICAgICAgICAgICAgICAgIHRpdGxlPVwiUmVtb3ZlIGFsbCBzZWxlY3RlZCBpbWFnZXNcIlxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgQ2xlYXIgQWxsXG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJncmlkIGdyaWQtY29scy0yIHNtOmdyaWQtY29scy0zIGdhcC0zXCI+XG4gICAgICAgICAgICB7c2VsZWN0ZWRGaWxlcy5tYXAoKGZpbGUsIGluZGV4KSA9PiAoXG4gICAgICAgICAgICAgIDxkaXYga2V5PXtpbmRleH0gY2xhc3NOYW1lPVwicmVsYXRpdmUgZ3JvdXBcIj5cbiAgICAgICAgICAgICAgICB7LyogSW1hZ2UgUHJldmlldyAqL31cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFzcGVjdC1zcXVhcmUgcm91bmRlZC1sZyBvdmVyZmxvdy1oaWRkZW4gYmctZ3JheS0xMDBcIj5cbiAgICAgICAgICAgICAgICAgIHtwcmV2aWV3c1tpbmRleF0gPyAoXG4gICAgICAgICAgICAgICAgICAgIDxpbWdcbiAgICAgICAgICAgICAgICAgICAgICBzcmM9e3ByZXZpZXdzW2luZGV4XX1cbiAgICAgICAgICAgICAgICAgICAgICBhbHQ9e2BQcmV2aWV3ICR7aW5kZXggKyAxfWB9XG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsIGgtZnVsbCBvYmplY3QtY292ZXJcIlxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LWZ1bGwgaC1mdWxsIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImFuaW1hdGUtc3BpbiByb3VuZGVkLWZ1bGwgaC02IHctNiBib3JkZXItYi0yIGJvcmRlci1wcmltYXJ5LTUwMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICByb2xlPVwic3RhdHVzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJMb2FkaW5nIGltYWdlIHByZXZpZXdcIlxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwic3Itb25seVwiPkxvYWRpbmcgaW1hZ2UgcHJldmlldy4uLjwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHsvKiBSZW1vdmUgQnV0dG9uICovfVxuICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gcmVtb3ZlRmlsZShpbmRleCl9XG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJhYnNvbHV0ZSB0b3AtMSByaWdodC0xIHAtMSBiZy1yZWQtNTAwIHRleHQtd2hpdGUgcm91bmRlZC1mdWxsIG9wYWNpdHktMCBncm91cC1ob3ZlcjpvcGFjaXR5LTEwMCB0cmFuc2l0aW9uLW9wYWNpdHlcIlxuICAgICAgICAgICAgICAgICAgdGl0bGU9XCJSZW1vdmUgaW1hZ2VcIlxuICAgICAgICAgICAgICAgICAgYXJpYS1sYWJlbD17YFJlbW92ZSBpbWFnZSAke2luZGV4ICsgMX1gfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIDxzdmcgY2xhc3NOYW1lPVwidy0zIGgtM1wiIGZpbGw9XCJjdXJyZW50Q29sb3JcIiB2aWV3Qm94PVwiMCAwIDIwIDIwXCI+XG4gICAgICAgICAgICAgICAgICAgIDxwYXRoIGZpbGxSdWxlPVwiZXZlbm9kZFwiIGQ9XCJNNC4yOTMgNC4yOTNhMSAxIDAgMDExLjQxNCAwTDEwIDguNTg2bDQuMjkzLTQuMjkzYTEgMSAwIDExMS40MTQgMS40MTRMMTEuNDE0IDEwbDQuMjkzIDQuMjkzYTEgMSAwIDAxLTEuNDE0IDEuNDE0TDEwIDExLjQxNGwtNC4yOTMgNC4yOTNhMSAxIDAgMDEtMS40MTQtMS40MTRMOC41ODYgMTAgNC4yOTMgNS43MDdhMSAxIDAgMDEwLTEuNDE0elwiIGNsaXBSdWxlPVwiZXZlbm9kZFwiIC8+XG4gICAgICAgICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB7LyogUHJpbWFyeSBCYWRnZSAqL31cbiAgICAgICAgICAgICAgICB7aW5kZXggPT09IDAgJiYgKFxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhYnNvbHV0ZSBib3R0b20tMSBsZWZ0LTEgYmctcHJpbWFyeS01MDAgdGV4dC13aGl0ZSB0ZXh0LXhzIHB4LTEgcHktMC41IHJvdW5kZWRcIj5cbiAgICAgICAgICAgICAgICAgICAgUHJpbWFyeVxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB7LyogU2V0IGFzIFByaW1hcnkgQnV0dG9uIChmb3Igbm9uLXByaW1hcnkgaW1hZ2VzKSAqL31cbiAgICAgICAgICAgICAgICB7aW5kZXggIT09IDAgJiYgKFxuICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgIC8vIE1vdmUgdGhpcyBpbWFnZSB0byB0aGUgZnJvbnRcbiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdGaWxlcyA9IFsuLi5zZWxlY3RlZEZpbGVzXTtcbiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdQcmV2aWV3cyA9IFsuLi5wcmV2aWV3c107XG4gICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRGaWxlID0gbmV3RmlsZXNbaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkUHJldmlldyA9IG5ld1ByZXZpZXdzW2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgZnJvbSBjdXJyZW50IHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgbmV3RmlsZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICBuZXdQcmV2aWV3cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0byBmcm9udFxuICAgICAgICAgICAgICAgICAgICAgIG5ld0ZpbGVzLnVuc2hpZnQoc2VsZWN0ZWRGaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICBuZXdQcmV2aWV3cy51bnNoaWZ0KHNlbGVjdGVkUHJldmlldyk7XG4gICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgc2V0U2VsZWN0ZWRGaWxlcyhuZXdGaWxlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgc2V0UHJldmlld3MobmV3UHJldmlld3MpO1xuICAgICAgICAgICAgICAgICAgICAgIG9uSW1hZ2VzQ2hhbmdlKG5ld0ZpbGVzKTtcbiAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYWJzb2x1dGUgYm90dG9tLTEgbGVmdC0xIGJnLWJsYWNrIGJnLW9wYWNpdHktNTAgdGV4dC13aGl0ZSB0ZXh0LXhzIHB4LTEgcHktMC41IHJvdW5kZWQgb3BhY2l0eS0wIGdyb3VwLWhvdmVyOm9wYWNpdHktMTAwIHRyYW5zaXRpb24tb3BhY2l0eVwiXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiU2V0IGFzIHByaW1hcnkgaW1hZ2VcIlxuICAgICAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPXtgU2V0IGltYWdlICR7aW5kZXggKyAxfSBhcyBwcmltYXJ5YH1cbiAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgU2V0IFByaW1hcnlcbiAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgey8qIFVwbG9hZCBQcm9ncmVzcyAqL31cbiAgICAgICAgICAgICAgICB7c2hvd1VwbG9hZFByb2dyZXNzICYmIHVwbG9hZFByb2dyZXNzW2Ake2ZpbGUubmFtZX0tJHtpbmRleH1gXSAhPT0gdW5kZWZpbmVkICYmIChcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWJzb2x1dGUgaW5zZXQtMCBiZy1ibGFjayBiZy1vcGFjaXR5LTUwIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC13aGl0ZSB0ZXh0LWNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy04IGgtOCBib3JkZXItMiBib3JkZXItd2hpdGUgYm9yZGVyLXQtdHJhbnNwYXJlbnQgcm91bmRlZC1mdWxsIGFuaW1hdGUtc3BpbiBteC1hdXRvIG1iLTFcIiAvPlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC14c1wiPnt1cGxvYWRQcm9ncmVzc1tgJHtmaWxlLm5hbWV9LSR7aW5kZXh9YF19JTwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICl9XG5cbiAgICAgICAgICAgICAgICB7LyogRmlsZSBJbmZvICovfVxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXQtMSB0ZXh0LXhzIHRleHQtZ3JheS01MDAgdHJ1bmNhdGVcIj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidHJ1bmNhdGVcIiB0aXRsZT17ZmlsZS5uYW1lfT57ZmlsZS5uYW1lfTwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdj57Zm9ybWF0RmlsZVNpemUoZmlsZS5zaXplKX08L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICBcbiAgICAgICAgICB7LyogVXBsb2FkIFRpcHMgKi99XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LXhzIHRleHQtZ3JheS01MDAgYmctZ3JheS01MCByb3VuZGVkIHAtMlwiPlxuICAgICAgICAgICAgPHA+PHN0cm9uZz5UaXA6PC9zdHJvbmc+IFRoZSBmaXJzdCBpbWFnZSB3aWxsIGJlIHVzZWQgYXMgdGhlIHByaW1hcnkgcGhvdG8gZm9yIHlvdXIgcGxhbnQgY2FyZC48L3A+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgKX1cbiAgICA8L2Rpdj5cbiAgKTtcbn0iXSwibmFtZXMiOlsiSW1hZ2VVcGxvYWQiLCJvbkltYWdlc0NoYW5nZSIsIm9uVXBsb2FkIiwibWF4SW1hZ2VzIiwibWF4U2l6ZVBlckltYWdlIiwiYWNjZXB0ZWRUeXBlcyIsImNsYXNzTmFtZSIsInNob3dVcGxvYWRQcm9ncmVzcyIsInNlbGVjdGVkRmlsZXMiLCJzZXRTZWxlY3RlZEZpbGVzIiwidXNlU3RhdGUiLCJwcmV2aWV3cyIsInNldFByZXZpZXdzIiwiZXJyb3JzIiwic2V0RXJyb3JzIiwidXBsb2FkUHJvZ3Jlc3MiLCJzZXRVcGxvYWRQcm9ncmVzcyIsImlzVXBsb2FkaW5nIiwic2V0SXNVcGxvYWRpbmciLCJmaWxlSW5wdXRSZWYiLCJ1c2VSZWYiLCJoYW5kbGVDbGljayIsInVzZUNhbGxiYWNrIiwiY3VycmVudCIsImxlbmd0aCIsImNsaWNrIiwiaGFuZGxlRmlsZXMiLCJmaWxlcyIsIm5ld0Vycm9ycyIsInZhbGlkRmlsZXMiLCJuZXdQcmV2aWV3cyIsInB1c2giLCJmb3JFYWNoIiwiZmlsZSIsImluY2x1ZGVzIiwidHlwZSIsIm5hbWUiLCJzaXplIiwibWF4U2l6ZU1CIiwiTWF0aCIsInJvdW5kIiwic29tZSIsImV4aXN0aW5nIiwicmVhZGVyIiwiRmlsZVJlYWRlciIsIm9ubG9hZCIsImUiLCJ0YXJnZXQiLCJyZXN1bHQiLCJwcmV2Iiwib25lcnJvciIsInJlYWRBc0RhdGFVUkwiLCJ1cGRhdGVkRmlsZXMiLCJnZXRSb290UHJvcHMiLCJnZXRJbnB1dFByb3BzIiwiaXNEcmFnQWN0aXZlIiwidXNlRHJvcHpvbmUiLCJvbkRyb3AiLCJhY2NlcHQiLCJyZWR1Y2UiLCJhY2MiLCJtYXhGaWxlcyIsImRpc2FibGVkIiwicmVtb3ZlRmlsZSIsImluZGV4IiwibmV3RmlsZXMiLCJmaWx0ZXIiLCJfIiwiaSIsInVwbG9hZEZpbGVzIiwiZmlsZUtleSIsImludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJjdXJyZW50UHJvZ3Jlc3MiLCJjbGVhckludGVydmFsIiwibWluIiwidXBsb2FkZWRVcmxzIiwiZXJyb3IiLCJjbGVhckFsbCIsInZhbHVlIiwiZm9ybWF0RmlsZVNpemUiLCJieXRlcyIsImsiLCJzaXplcyIsImZsb29yIiwibG9nIiwicGFyc2VGbG9hdCIsInBvdyIsInRvRml4ZWQiLCJkaXYiLCJpbnB1dCIsInJlZiIsInAiLCJidXR0b24iLCJvbkNsaWNrIiwiYXJpYS1sYWJlbCIsInRpdGxlIiwic3ZnIiwiZmlsbCIsInZpZXdCb3giLCJwYXRoIiwiZmlsbFJ1bGUiLCJkIiwiY2xpcFJ1bGUiLCJoNCIsInVsIiwibWFwIiwibGkiLCJzcGFuIiwicm9sZSIsImFyaWEtbGl2ZSIsImltZyIsInNyYyIsImFsdCIsInNlbGVjdGVkRmlsZSIsInNlbGVjdGVkUHJldmlldyIsInNwbGljZSIsInVuc2hpZnQiLCJ1bmRlZmluZWQiLCJzdHJvbmciXSwibWFwcGluZ3MiOiJBQUFBOzs7OzsrQkFlQTs7O2VBQXdCQTs7Ozt1QkFic0I7K0JBQ2xCO0FBWWIsU0FBU0EsWUFBWSxFQUNsQ0MsY0FBYyxFQUNkQyxRQUFRLEVBQ1JDLFlBQVksQ0FBQyxFQUNiQyxrQkFBa0IsSUFBSSxPQUFPLElBQUksRUFDakNDLGdCQUFnQjtJQUFDO0lBQWM7SUFBYTtDQUFhLEVBQ3pEQyxZQUFZLEVBQUUsRUFDZEMscUJBQXFCLEtBQUssRUFDVDtJQUNqQixNQUFNLENBQUNDLGVBQWVDLGlCQUFpQixHQUFHQyxJQUFBQSxlQUFRLEVBQVMsRUFBRTtJQUM3RCxNQUFNLENBQUNDLFVB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