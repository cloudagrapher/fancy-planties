24bf67043c86759473e6cd207a16951b
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get EmailVerificationCleanupService () {
        return EmailVerificationCleanupService;
    },
    get emailVerificationCleanupService () {
        return emailVerificationCleanupService;
    }
});
require("server-only");
const _emailverificationcodeservice = require("./email-verification-code-service");
const _emailverificationratelimiter = require("./email-verification-rate-limiter");
class EmailVerificationCleanupService {
    /**
   * Run cleanup of expired verification codes and rate limit data
   */ async runCleanup() {
        if (this.isRunning) {
            throw new Error('Cleanup is already running');
        }
        this.isRunning = true;
        const startTime = Date.now();
        try {
            console.log('[CLEANUP] Starting email verification cleanup...');
            // Clean up expired verification codes
            const expiredCodes = await _emailverificationcodeservice.emailVerificationCodeService.cleanupExpiredCodes();
            console.log(`[CLEANUP] Removed ${expiredCodes} expired verification codes`);
            // Clean up rate limit data
            const rateLimitStatsBefore = _emailverificationratelimiter.emailVerificationRateLimiter.getStats();
            _emailverificationratelimiter.emailVerificationRateLimiter.cleanup();
            const rateLimitStatsAfter = _emailverificationratelimiter.emailVerificationRateLimiter.getStats();
            const rateLimitDataCleaned = rateLimitStatsBefore.verificationAttempts - rateLimitStatsAfter.verificationAttempts + (rateLimitStatsBefore.resendRequests - rateLimitStatsAfter.resendRequests) + (rateLimitStatsBefore.emailVerificationActivity - rateLimitStatsAfter.emailVerificationActivity) + (rateLimitStatsBefore.resendCooldowns - rateLimitStatsAfter.resendCooldowns);
            console.log(`[CLEANUP] Cleaned up ${rateLimitDataCleaned} rate limit entries`);
            const stats = {
                expiredCodes,
                rateLimitData: rateLimitDataCleaned,
                timestamp: startTime
            };
            // Store cleanup stats (keep last 24 entries)
            this.cleanupStats.push(stats);
            if (this.cleanupStats.length > 24) {
                this.cleanupStats.shift();
            }
            this.lastCleanup = startTime;
            const duration = Date.now() - startTime;
            console.log(`[CLEANUP] Email verification cleanup completed in ${duration}ms`);
            return stats;
        } catch (error) {
            console.error('[CLEANUP] Email verification cleanup failed:', error);
            throw error;
        } finally{
            this.isRunning = false;
        }
    }
    /**
   * Schedule automatic cleanup to run periodically
   */ scheduleCleanup(intervalMs = 60 * 60 * 1000) {
        console.log(`[CLEANUP] Scheduling email verification cleanup every ${intervalMs / 1000} seconds`);
        const runScheduledCleanup = async ()=>{
            try {
                await this.runCleanup();
            } catch (error) {
                console.error('[CLEANUP] Scheduled cleanup failed:', error);
            }
        };
        // Run initial cleanup after a short delay
        setTimeout(runScheduledCleanup, 5000); // 5 seconds
        // Then run periodically
        setInterval(runScheduledCleanup, intervalMs);
    }
    /**
   * Run startup cleanup to clean any leftover data
   */ async runStartupCleanup() {
        console.log('[CLEANUP] Running startup cleanup...');
        try {
            const stats = await this.runCleanup();
            console.log('[CLEANUP] Startup cleanup completed successfully');
            return stats;
        } catch (error) {
            console.error('[CLEANUP] Startup cleanup failed:', error);
            throw error;
        }
    }
    /**
   * Get cleanup statistics
   */ getCleanupStats() {
        const totalExpiredCodes = this.cleanupStats.reduce((sum, stat)=>sum + stat.expiredCodes, 0);
        const totalRateLimitData = this.cleanupStats.reduce((sum, stat)=>sum + stat.rateLimitData, 0);
        return {
            lastCleanup: this.lastCleanup,
            isRunning: this.isRunning,
            recentStats: [
                ...this.cleanupStats
            ],
            totalExpiredCodes,
            totalRateLimitData
        };
    }
    /**
   * Get current system status
   */ async getSystemStatus() {
        const codeStats = await _emailverificationcodeservice.emailVerificationCodeService.getCodeStats();
        const rateLimitStats = _emailverificationratelimiter.emailVerificationRateLimiter.getStats();
        const cleanupStats = this.getCleanupStats();
        // Estimate next cleanup time (assuming hourly cleanup)
        const nextCleanupDue = cleanupStats.lastCleanup + 60 * 60 * 1000;
        return {
            verificationCodes: codeStats,
            rateLimits: rateLimitStats,
            cleanup: {
                lastCleanup: cleanupStats.lastCleanup,
                isRunning: cleanupStats.isRunning,
                nextCleanupDue
            }
        };
    }
    /**
   * Force cleanup if needed (for manual triggers)
   */ async forceCleanup() {
        if (this.isRunning) {
            throw new Error('Cleanup is already running. Please wait for it to complete.');
        }
        console.log('[CLEANUP] Force cleanup requested');
        return await this.runCleanup();
    }
    constructor(){
        this.isRunning = false;
        this.lastCleanup = 0;
        this.cleanupStats = [];
    }
}
const emailVerificationCleanupService = new EmailVerificationCleanupService();
// Auto-schedule cleanup when this module is imported
if (process.env.NODE_ENV === 'production') {
    // In production, start cleanup automatically
    emailVerificationCleanupService.scheduleCleanup();
} else {
    // In development, run less frequently to avoid noise
    emailVerificationCleanupService.scheduleCleanup(2 * 60 * 60 * 1000); // 2 hours
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zdGVmYW5iZWtrZXIvcHJvamVjdHMvZmFuY3ktcGxhbnRpZXMvc3JjL2xpYi9zZXJ2aWNlcy9lbWFpbC12ZXJpZmljYXRpb24tY2xlYW51cC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJ3NlcnZlci1vbmx5JztcbmltcG9ydCB7IGVtYWlsVmVyaWZpY2F0aW9uQ29kZVNlcnZpY2UgfSBmcm9tICcuL2VtYWlsLXZlcmlmaWNhdGlvbi1jb2RlLXNlcnZpY2UnO1xuaW1wb3J0IHsgZW1haWxWZXJpZmljYXRpb25SYXRlTGltaXRlciB9IGZyb20gJy4vZW1haWwtdmVyaWZpY2F0aW9uLXJhdGUtbGltaXRlcic7XG5pbXBvcnQgeyBlbWFpbFNlcnZpY2VNb25pdG9yIH0gZnJvbSAnLi9lbWFpbC1zZXJ2aWNlLW1vbml0b3InO1xuXG5leHBvcnQgaW50ZXJmYWNlIENsZWFudXBTdGF0cyB7XG4gIGV4cGlyZWRDb2RlczogbnVtYmVyO1xuICByYXRlTGltaXREYXRhOiBudW1iZXI7XG4gIHRpbWVzdGFtcDogbnVtYmVyO1xuICBlbWFpbFNlcnZpY2VIZWFsdGg/OiB7XG4gICAgc3RhdHVzOiAnaGVhbHRoeScgfCAnd2FybmluZycgfCAnY3JpdGljYWwnO1xuICAgIHF1b3RhVXNhZ2U6IG51bWJlcjtcbiAgICBzdWNjZXNzUmF0ZTogbnVtYmVyO1xuICAgIGlzc3Vlczogc3RyaW5nW107XG4gIH07XG59XG5cbmV4cG9ydCBjbGFzcyBFbWFpbFZlcmlmaWNhdGlvbkNsZWFudXBTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBpc1J1bm5pbmcgPSBmYWxzZTtcbiAgcHJpdmF0ZSBsYXN0Q2xlYW51cCA9IDA7XG4gIHByaXZhdGUgY2xlYW51cFN0YXRzOiBDbGVhbnVwU3RhdHNbXSA9IFtdO1xuICBcbiAgLyoqXG4gICAqIFJ1biBjbGVhbnVwIG9mIGV4cGlyZWQgdmVyaWZpY2F0aW9uIGNvZGVzIGFuZCByYXRlIGxpbWl0IGRhdGFcbiAgICovXG4gIGFzeW5jIHJ1bkNsZWFudXAoKTogUHJvbWlzZTxDbGVhbnVwU3RhdHM+IHtcbiAgICBpZiAodGhpcy5pc1J1bm5pbmcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2xlYW51cCBpcyBhbHJlYWR5IHJ1bm5pbmcnKTtcbiAgICB9XG4gICAgXG4gICAgdGhpcy5pc1J1bm5pbmcgPSB0cnVlO1xuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCdbQ0xFQU5VUF0gU3RhcnRpbmcgZW1haWwgdmVyaWZpY2F0aW9uIGNsZWFudXAuLi4nKTtcbiAgICAgIFxuICAgICAgLy8gQ2xlYW4gdXAgZXhwaXJlZCB2ZXJpZmljYXRpb24gY29kZXNcbiAgICAgIGNvbnN0IGV4cGlyZWRDb2RlcyA9IGF3YWl0IGVtYWlsVmVyaWZpY2F0aW9uQ29kZVNlcnZpY2UuY2xlYW51cEV4cGlyZWRDb2RlcygpO1xuICAgICAgY29uc29sZS5sb2coYFtDTEVBTlVQXSBSZW1vdmVkICR7ZXhwaXJlZENvZGVzfSBleHBpcmVkIHZlcmlmaWNhdGlvbiBjb2Rlc2ApO1xuICAgICAgXG4gICAgICAvLyBDbGVhbiB1cCByYXRlIGxpbWl0IGRhdGFcbiAgICAgIGNvbnN0IHJhdGVMaW1pdFN0YXRzQmVmb3JlID0gZW1haWxWZXJpZmljYXRpb25SYXRlTGltaXRlci5nZXRTdGF0cygpO1xuICAgICAgZW1haWxWZXJpZmljYXRpb25SYXRlTGltaXRlci5jbGVhbnVwKCk7XG4gICAgICBjb25zdCByYXRlTGltaXRTdGF0c0FmdGVyID0gZW1haWxWZXJpZmljYXRpb25SYXRlTGltaXRlci5nZXRTdGF0cygpO1xuICAgICAgXG4gICAgICBjb25zdCByYXRlTGltaXREYXRhQ2xlYW5lZCA9IFxuICAgICAgICAocmF0ZUxpbWl0U3RhdHNCZWZvcmUudmVyaWZpY2F0aW9uQXR0ZW1wdHMgLSByYXRlTGltaXRTdGF0c0FmdGVyLnZlcmlmaWNhdGlvbkF0dGVtcHRzKSArXG4gICAgICAgIChyYXRlTGltaXRTdGF0c0JlZm9yZS5yZXNlbmRSZXF1ZXN0cyAtIHJhdGVMaW1pdFN0YXRzQWZ0ZXIucmVzZW5kUmVxdWVzdHMpICtcbiAgICAgICAgKHJhdGVMaW1pdFN0YXRzQmVmb3JlLmVtYWlsVmVyaWZpY2F0aW9uQWN0aXZpdHkgLSByYXRlTGltaXRTdGF0c0FmdGVyLmVtYWlsVmVyaWZpY2F0aW9uQWN0aXZpdHkpICtcbiAgICAgICAgKHJhdGVMaW1pdFN0YXRzQmVmb3JlLnJlc2VuZENvb2xkb3ducyAtIHJhdGVMaW1pdFN0YXRzQWZ0ZXIucmVzZW5kQ29vbGRvd25zKTtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coYFtDTEVBTlVQXSBDbGVhbmVkIHVwICR7cmF0ZUxpbWl0RGF0YUNsZWFuZWR9IHJhdGUgbGltaXQgZW50cmllc2ApO1xuICAgICAgXG4gICAgICBjb25zdCBzdGF0czogQ2xlYW51cFN0YXRzID0ge1xuICAgICAgICBleHBpcmVkQ29kZXMsXG4gICAgICAgIHJhdGVMaW1pdERhdGE6IHJhdGVMaW1pdERhdGFDbGVhbmVkLFxuICAgICAgICB0aW1lc3RhbXA6IHN0YXJ0VGltZSxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIFN0b3JlIGNsZWFudXAgc3RhdHMgKGtlZXAgbGFzdCAyNCBlbnRyaWVzKVxuICAgICAgdGhpcy5jbGVhbnVwU3RhdHMucHVzaChzdGF0cyk7XG4gICAgICBpZiAodGhpcy5jbGVhbnVwU3RhdHMubGVuZ3RoID4gMjQpIHtcbiAgICAgICAgdGhpcy5jbGVhbnVwU3RhdHMuc2hpZnQoKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgdGhpcy5sYXN0Q2xlYW51cCA9IHN0YXJ0VGltZTtcbiAgICAgIFxuICAgICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgY29uc29sZS5sb2coYFtDTEVBTlVQXSBFbWFpbCB2ZXJpZmljYXRpb24gY2xlYW51cCBjb21wbGV0ZWQgaW4gJHtkdXJhdGlvbn1tc2ApO1xuICAgICAgXG4gICAgICByZXR1cm4gc3RhdHM7XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0NMRUFOVVBdIEVtYWlsIHZlcmlmaWNhdGlvbiBjbGVhbnVwIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5pc1J1bm5pbmcgPSBmYWxzZTtcbiAgICB9XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBTY2hlZHVsZSBhdXRvbWF0aWMgY2xlYW51cCB0byBydW4gcGVyaW9kaWNhbGx5XG4gICAqL1xuICBzY2hlZHVsZUNsZWFudXAoaW50ZXJ2YWxNczogbnVtYmVyID0gNjAgKiA2MCAqIDEwMDApOiB2b2lkIHsgLy8gRGVmYXVsdDogMSBob3VyXG4gICAgY29uc29sZS5sb2coYFtDTEVBTlVQXSBTY2hlZHVsaW5nIGVtYWlsIHZlcmlmaWNhdGlvbiBjbGVhbnVwIGV2ZXJ5ICR7aW50ZXJ2YWxNcyAvIDEwMDB9IHNlY29uZHNgKTtcbiAgICBcbiAgICBjb25zdCBydW5TY2hlZHVsZWRDbGVhbnVwID0gYXN5bmMgKCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdGhpcy5ydW5DbGVhbnVwKCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbQ0xFQU5VUF0gU2NoZWR1bGVkIGNsZWFudXAgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIC8vIFJ1biBpbml0aWFsIGNsZWFudXAgYWZ0ZXIgYSBzaG9ydCBkZWxheVxuICAgIHNldFRpbWVvdXQocnVuU2NoZWR1bGVkQ2xlYW51cCwgNTAwMCk7IC8vIDUgc2Vjb25kc1xuICAgIFxuICAgIC8vIFRoZW4gcnVuIHBlcmlvZGljYWxseVxuICAgIHNldEludGVydmFsKHJ1blNjaGVkdWxlZENsZWFudXAsIGludGVydmFsTXMpO1xuICB9XG4gIFxuICAvKipcbiAgICogUnVuIHN0YXJ0dXAgY2xlYW51cCB0byBjbGVhbiBhbnkgbGVmdG92ZXIgZGF0YVxuICAgKi9cbiAgYXN5bmMgcnVuU3RhcnR1cENsZWFudXAoKTogUHJvbWlzZTxDbGVhbnVwU3RhdHM+IHtcbiAgICBjb25zb2xlLmxvZygnW0NMRUFOVVBdIFJ1bm5pbmcgc3RhcnR1cCBjbGVhbnVwLi4uJyk7XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgdGhpcy5ydW5DbGVhbnVwKCk7XG4gICAgICBjb25zb2xlLmxvZygnW0NMRUFOVVBdIFN0YXJ0dXAgY2xlYW51cCBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgICByZXR1cm4gc3RhdHM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tDTEVBTlVQXSBTdGFydHVwIGNsZWFudXAgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuICBcbiAgLyoqXG4gICAqIEdldCBjbGVhbnVwIHN0YXRpc3RpY3NcbiAgICovXG4gIGdldENsZWFudXBTdGF0cygpOiB7XG4gICAgbGFzdENsZWFudXA6IG51bWJlcjtcbiAgICBpc1J1bm5pbmc6IGJvb2xlYW47XG4gICAgcmVjZW50U3RhdHM6IENsZWFudXBTdGF0c1tdO1xuICAgIHRvdGFsRXhwaXJlZENvZGVzOiBudW1iZXI7XG4gICAgdG90YWxSYXRlTGltaXREYXRhOiBudW1iZXI7XG4gIH0ge1xuICAgIGNvbnN0IHRvdGFsRXhwaXJlZENvZGVzID0gdGhpcy5jbGVhbnVwU3RhdHMucmVkdWNlKChzdW0sIHN0YXQpID0+IHN1bSArIHN0YXQuZXhwaXJlZENvZGVzLCAwKTtcbiAgICBjb25zdCB0b3RhbFJhdGVMaW1pdERhdGEgPSB0aGlzLmNsZWFudXBTdGF0cy5yZWR1Y2UoKHN1bSwgc3RhdCkgPT4gc3VtICsgc3RhdC5yYXRlTGltaXREYXRhLCAwKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgbGFzdENsZWFudXA6IHRoaXMubGFzdENsZWFudXAsXG4gICAgICBpc1J1bm5pbmc6IHRoaXMuaXNSdW5uaW5nLFxuICAgICAgcmVjZW50U3RhdHM6IFsuLi50aGlzLmNsZWFudXBTdGF0c10sXG4gICAgICB0b3RhbEV4cGlyZWRDb2RlcyxcbiAgICAgIHRvdGFsUmF0ZUxpbWl0RGF0YSxcbiAgICB9O1xuICB9XG4gIFxuICAvKipcbiAgICogR2V0IGN1cnJlbnQgc3lzdGVtIHN0YXR1c1xuICAgKi9cbiAgYXN5bmMgZ2V0U3lzdGVtU3RhdHVzKCk6IFByb21pc2U8e1xuICAgIHZlcmlmaWNhdGlvbkNvZGVzOiB7XG4gICAgICB0b3RhbEFjdGl2ZTogbnVtYmVyO1xuICAgICAgZXhwaXJlZENvdW50OiBudW1iZXI7XG4gICAgICBoaWdoQXR0ZW1wdENvdW50OiBudW1iZXI7XG4gICAgfTtcbiAgICByYXRlTGltaXRzOiB7XG4gICAgICB2ZXJpZmljYXRpb25BdHRlbXB0czogbnVtYmVyO1xuICAgICAgcmVzZW5kUmVxdWVzdHM6IG51bWJlcjtcbiAgICAgIGVtYWlsVmVyaWZpY2F0aW9uQWN0aXZpdHk6IG51bWJlcjtcbiAgICAgIHJlc2VuZENvb2xkb3duczogbnVtYmVyO1xuICAgICAgc2VjdXJpdHlFdmVudHM6IG51bWJlcjtcbiAgICB9O1xuICAgIGNsZWFudXA6IHtcbiAgICAgIGxhc3RDbGVhbnVwOiBudW1iZXI7XG4gICAgICBpc1J1bm5pbmc6IGJvb2xlYW47XG4gICAgICBuZXh0Q2xlYW51cER1ZTogbnVtYmVyO1xuICAgIH07XG4gIH0+IHtcbiAgICBjb25zdCBjb2RlU3RhdHMgPSBhd2FpdCBlbWFpbFZlcmlmaWNhdGlvbkNvZGVTZXJ2aWNlLmdldENvZGVTdGF0cygpO1xuICAgIGNvbnN0IHJhdGVMaW1pdFN0YXRzID0gZW1haWxWZXJpZmljYXRpb25SYXRlTGltaXRlci5nZXRTdGF0cygpO1xuICAgIGNvbnN0IGNsZWFudXBTdGF0cyA9IHRoaXMuZ2V0Q2xlYW51cFN0YXRzKCk7XG4gICAgXG4gICAgLy8gRXN0aW1hdGUgbmV4dCBjbGVhbnVwIHRpbWUgKGFzc3VtaW5nIGhvdXJseSBjbGVhbnVwKVxuICAgIGNvbnN0IG5leHRDbGVhbnVwRHVlID0gY2xlYW51cFN0YXRzLmxhc3RDbGVhbnVwICsgKDYwICogNjAgKiAxMDAwKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgdmVyaWZpY2F0aW9uQ29kZXM6IGNvZGVTdGF0cyxcbiAgICAgIHJhdGVMaW1pdHM6IHJhdGVMaW1pdFN0YXRzLFxuICAgICAgY2xlYW51cDoge1xuICAgICAgICBsYXN0Q2xlYW51cDogY2xlYW51cFN0YXRzLmxhc3RDbGVhbnVwLFxuICAgICAgICBpc1J1bm5pbmc6IGNsZWFudXBTdGF0cy5pc1J1bm5pbmcsXG4gICAgICAgIG5leHRDbGVhbnVwRHVlLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG4gIFxuICAvKipcbiAgICogRm9yY2UgY2xlYW51cCBpZiBuZWVkZWQgKGZvciBtYW51YWwgdHJpZ2dlcnMpXG4gICAqL1xuICBhc3luYyBmb3JjZUNsZWFudXAoKTogUHJvbWlzZTxDbGVhbnVwU3RhdHM+IHtcbiAgICBpZiAodGhpcy5pc1J1bm5pbmcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2xlYW51cCBpcyBhbHJlYWR5IHJ1bm5pbmcuIFBsZWFzZSB3YWl0IGZvciBpdCB0byBjb21wbGV0ZS4nKTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coJ1tDTEVBTlVQXSBGb3JjZSBjbGVhbnVwIHJlcXVlc3RlZCcpO1xuICAgIHJldHVybiBhd2FpdCB0aGlzLnJ1bkNsZWFudXAoKTtcbiAgfVxufVxuXG4vLyBFeHBvcnQgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgZW1haWxWZXJpZmljYXRpb25DbGVhbnVwU2VydmljZSA9IG5ldyBFbWFpbFZlcmlmaWNhdGlvbkNsZWFudXBTZXJ2aWNlKCk7XG5cbi8vIEF1dG8tc2NoZWR1bGUgY2xlYW51cCB3aGVuIHRoaXMgbW9kdWxlIGlzIGltcG9ydGVkXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJykge1xuICAvLyBJbiBwcm9kdWN0aW9uLCBzdGFydCBjbGVhbnVwIGF1dG9tYXRpY2FsbHlcbiAgZW1haWxWZXJpZmljYXRpb25DbGVhbnVwU2VydmljZS5zY2hlZHVsZUNsZWFudXAoKTtcbn0gZWxzZSB7XG4gIC8vIEluIGRldmVsb3BtZW50LCBydW4gbGVzcyBmcmVxdWVudGx5IHRvIGF2b2lkIG5vaXNlXG4gIGVtYWlsVmVyaWZpY2F0aW9uQ2xlYW51cFNlcnZpY2Uuc2NoZWR1bGVDbGVhbnVwKDIgKiA2MCAqIDYwICogMTAwMCk7IC8vIDIgaG91cnNcbn0iXSwibmFtZXMiOlsiRW1haWxWZXJpZmljYXRpb25DbGVhbnVwU2VydmljZSIsImVtYWlsVmVyaWZpY2F0aW9uQ2xlYW51cFNlcnZpY2UiLCJydW5DbGVhbnVwIiwiaXNSdW5uaW5nIiwiRXJyb3IiLCJzdGFydFRpbWUiLCJEYXRlIiwibm93IiwiY29uc29sZSIsImxvZyIsImV4cGlyZWRDb2RlcyIsImVtYWlsVmVyaWZpY2F0aW9uQ29kZVNlcnZpY2UiLCJjbGVhbnVwRXhwaXJlZENvZGVzIiwicmF0ZUxpbWl0U3RhdHNCZWZvcmUiLCJlbWFpbFZlcmlmaWNhdGlvblJhdGVMaW1pdGVyIiwiZ2V0U3RhdHMiLCJjbGVhbnVwIiwicmF0ZUxpbWl0U3RhdHNBZnRlciIsInJhdGVMaW1pdERhdGFDbGVhbmVkIiwidmVyaWZpY2F0aW9uQXR0ZW1wdHMiLCJyZXNlbmRSZXF1ZXN0cyIsImVtYWlsVmVyaWZpY2F0aW9uQWN0aXZpdHkiLCJyZXNlbmRDb29sZG93bnMiLCJzdGF0cyIsInJhdGVMaW1pdERhdGEiLCJ0aW1lc3RhbXAiLCJjbGVhbnVwU3RhdHMiLCJwdXNoIiwibGVuZ3RoIiwic2hpZnQiLCJsYXN0Q2xlYW51cCIsImR1cmF0aW9uIiwiZXJyb3IiLCJzY2hlZHVsZUNsZWFudXAiLCJpbnRlcnZhbE1zIiwicnVuU2NoZWR1bGVkQ2xlYW51cCIsInNldFRpbWVvdXQiLCJzZXRJbnRlcnZhbCIsInJ1blN0YXJ0dXBDbGVhbnVwIiwiZ2V0Q2xlYW51cFN0YXRzIiwidG90YWxFeHBpcmVkQ29kZXMiLCJyZWR1Y2UiLCJzdW0iLCJzdGF0IiwidG90YWxSYXRlTGltaXREYXRhIiwicmVjZW50U3RhdHMiLCJnZXRTeXN0ZW1TdGF0dXMiLCJjb2RlU3RhdHMiLCJnZXRDb2RlU3RhdHMiLCJyYXRlTGltaXRTdGF0cyIsIm5leHRDbGVhbnVwRHVlIiwidmVyaWZpY2F0aW9uQ29kZXMiLCJyYXRlTGltaXRzIiwiZm9yY2VDbGVhbnVwIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztRQWlCYUE7ZUFBQUE7O1FBZ0xBQztlQUFBQTs7O1FBak1OOzhDQUNzQzs4Q0FDQTtBQWV0QyxNQUFNRDtJQUtYOztHQUVDLEdBQ0QsTUFBTUUsYUFBb0M7UUFDeEMsSUFBSSxJQUFJLENBQUNDLFNBQVMsRUFBRTtZQUNsQixNQUFNLElBQUlDLE1BQU07UUFDbEI7UUFFQSxJQUFJLENBQUNELFNBQVMsR0FBRztRQUNqQixNQUFNRSxZQUFZQyxLQUFLQyxHQUFHO1FBRTFCLElBQUk7WUFDRkMsUUFBUUMsR0FBRyxDQUFDO1lBRVosc0NBQXNDO1lBQ3RDLE1BQU1DLGVBQWUsTUFBTUMsMERBQTRCLENBQUNDLG1CQUFtQjtZQUMzRUosUUFBUUMsR0FBRyxDQUFDLENBQUMsa0JBQWtCLEVBQUVDLGFBQWEsMkJBQTJCLENBQUM7WUFFMUUsMkJBQTJCO1lBQzNCLE1BQU1HLHVCQUF1QkMsMERBQTRCLENBQUNDLFFBQVE7WUFDbEVELDBEQUE0QixDQUFDRSxPQUFPO1lBQ3BDLE1BQU1DLHNCQUFzQkgsMERBQTRCLENBQUNDLFFBQVE7WUFFakUsTUFBTUcsdUJBQ0osQUFBQ0wscUJBQXFCTSxvQkFBb0IsR0FBR0Ysb0JBQW9CRSxvQkFBb0IsR0FDcEZOLENBQUFBLHFCQUFxQk8sY0FBYyxHQUFHSCxvQkFBb0JHLGNBQWMs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