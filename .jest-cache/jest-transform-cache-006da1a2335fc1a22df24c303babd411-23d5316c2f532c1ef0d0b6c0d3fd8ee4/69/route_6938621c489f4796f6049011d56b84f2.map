{"version":3,"names":["DELETE","cov_ilprq14fb","f","s","GET","request","user","_server1","validateRequest","b","_server","NextResponse","json","error","status","searchParams","URL","url","limit","parseInt","get","history","_advancedsearch","advancedSearchService","getSearchHistory","id","success","data","console","clearSearchHistory","message"],"sources":["/Users/stefanbekker/projects/fancy-planties/src/app/api/search/history/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { validateRequest } from '@/lib/auth/server';\nimport { advancedSearchService } from '@/lib/services/advanced-search';\n\n// GET /api/search/history - Get user's search history\nexport async function GET(request: NextRequest) {\n  try {\n    const { user } = await validateRequest();\n    if (!user) {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\n    }\n\n    const { searchParams } = new URL(request.url);\n    const limit = parseInt(searchParams.get('limit') || '10', 10);\n\n    // Get search history\n    const history = await advancedSearchService.getSearchHistory(user.id, limit);\n\n    return NextResponse.json({\n      success: true,\n      data: { history },\n    });\n\n  } catch (error) {\n    console.error('Get search history error:', error);\n    \n    return NextResponse.json(\n      { error: 'Failed to get search history' },\n      { status: 500 }\n    );\n  }\n}\n\n// DELETE /api/search/history - Clear user's search history\nexport async function DELETE(request: NextRequest) {\n  try {\n    const { user } = await validateRequest();\n    if (!user) {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\n    }\n\n    // Clear search history\n    await advancedSearchService.clearSearchHistory(user.id);\n\n    return NextResponse.json({\n      success: true,\n      message: 'Search history cleared',\n    });\n\n  } catch (error) {\n    console.error('Clear search history error:', error);\n    \n    return NextResponse.json(\n      { error: 'Failed to clear search history' },\n      { status: 500 }\n    );\n  }\n}"],"mappings":"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","ignoreList":[]}